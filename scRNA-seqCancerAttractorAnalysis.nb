(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    336352,       7672]
NotebookOptionsPosition[    324103,       7458]
NotebookOutlinePosition[    325140,       7492]
CellTagsIndexPosition[    325097,       7489]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearSystemCache", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Quit", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.913113943997529*^9, 3.9131139484492445`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"741d47af-faba-4e4e-9f26-f811c9fc034a"],

Cell[CellGroupData[{

Cell["- Workspace Setup", "Title",
 CellChangeTimes->{{3.8892877145101814`*^9, 3.8892877520896883`*^9}, 
   3.913112123926033*^9, 3.913621777175322*^9, {3.924955654077606*^9, 
   3.924955656869204*^9}},ExpressionUUID->"2e9c9d70-cd70-40ae-862b-\
09a1324357b8"],

Cell[BoxData[{
 RowBox[{"Directory", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Directory", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.8892898055356617`*^9, 3.8892898096007395`*^9}, 
   3.889473041142294*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"6e91dcb6-2790-4f6b-b909-bd1cb18d439b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plottingFunctions", "=", 
   RowBox[{"{", 
    RowBox[{
    "Plot", ",", "ListPlot", ",", "ListLinePlot", ",", "ParametricPlot", ",", 
     "PolarPlot", ",", "LogPlot", ",", "LogLinearPlot", ",", "LogLogPlot", 
     ",", "BarChart", ",", "PieChart", ",", "Histogram", ",", "Plot3D", ",", 
     "ListPlot3D", ",", "ParametricPlot3D", ",", "ListSurfacePlot3D", ",", 
     "ListContourPlot3D", ",", "ContourPlot3D", ",", "BarChart3D", ",", 
     "Histogram3D", ",", "BoxWhiskerChart", " ", ",", " ", "StreamPlot", ",", 
     " ", "ContourPlot"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LabelStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"Bold", ",", 
           RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "12"}], 
          "]"}]}], ",", 
        RowBox[{"TicksStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "10"}], 
          "]"}]}]}], "}"}]}], "]"}], "&"}], "/@", "plottingFunctions"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tickFunc", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Charting`ScaledTicks", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Identity", ",", "Identity"}], "}"}], ",", 
       RowBox[{"TicksLength", "->", 
        RowBox[{"{", 
         RowBox[{".04", ",", ".02"}], "}"}]}]}], "]"}], "[", "##", "]"}], 
    "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.912320249204403*^9, 3.9123203312965975`*^9}, {
  3.9123203635618763`*^9, 3.9123203640775642`*^9}, {3.912320593887369*^9, 
  3.912320639278047*^9}, {3.912320671270449*^9, 3.912320673508833*^9}, {
  3.912321031962166*^9, 3.9123210384997654`*^9}, {3.9123211110277214`*^9, 
  3.9123211140005364`*^9}, {3.9123213096091676`*^9, 3.9123213120524473`*^9}, {
  3.9123218700103216`*^9, 3.9123218745052814`*^9}, {3.9123222625109167`*^9, 
  3.912322265209421*^9}, {3.912322357203227*^9, 3.912322364045324*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"842cbce7-ad79-4213-9219-e830536f9f53"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
- Input GRN files, definition of marker genes, and confidence level:\
\>", "Title",
 CellChangeTimes->{{3.9127744939218636`*^9, 3.91277450243097*^9}, 
   3.9131121254260893`*^9, 3.9136217805075483`*^9, {3.9249491565764637`*^9, 
   3.9249492022913523`*^9}, {3.9249492363642745`*^9, 
   3.9249492595994864`*^9}, {3.9249556586530886`*^9, 
   3.9249556587819605`*^9}},ExpressionUUID->"9c9f84d0-2aa9-45c3-9f59-\
35b5194676c9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gamatrix", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<\\\\inputs\\\\act_BT_ALL_seurat.xlsx\>\""}], ",", 
       "\"\<Data\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gbmatrix", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
        "\"\<\\\\inputs\\\\sup_BT_ALL_seurat.xlsx\>\""}], ",", 
       "\"\<Data\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"names", "=", 
    RowBox[{"gamatrix", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"1", ";;"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ngenes", "=", 
     RowBox[{"Length", "[", "names", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"postotal", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"names", ",", "#"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{
       "\"\<CD44\>\"", ",", "\"\<EGFR\>\"", ",", "\"\<IDH1\>\"", ",", 
        "\"\<NEFL\>\""}], "}"}]}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<CD44\>\"", ",", "\"\<EGFR\>\"", ",", "\"\<IDH1\>\"", ",", 
      "\"\<IDH2\>\"", ",", "\"\<PGK1\>\"", ",", "\"\<OLIG2\>\"", ",", 
      "\"\<NFIB\>\"", ",", "\"\<STAT3\>\"", ",", "\"\<SP3\>\""}], "}"}], " ", 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"combinations", " ", "=", " ", 
    RowBox[{"Subsets", "[", 
     RowBox[{"postotal", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"confidenceLevelDefaultValue", "=", "0.95"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"confidenceLevelDefaultValue", "=", "0.68"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"a", ",", " ", "sa", ",", " ", 
     RowBox[{
     "b", " ", "e", " ", "sb", " ", "are", " ", "Global", " ", "symbolic", 
      " ", 
      RowBox[{"variables", ".", " ", "Avoid"}], " ", "using", " ", "them", 
      " ", "as", " ", "new", " ", "variable", " ", 
      RowBox[{"name", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SeedRandom", "[", "1234", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9127745050587053`*^9, 3.9127745249650917`*^9}, {
  3.912774569945533*^9, 3.9127745774987526`*^9}, {3.912853303276948*^9, 
  3.9128533267947855`*^9}, {3.913121714070915*^9, 3.9131217144829617`*^9}, {
  3.913137440393753*^9, 3.913137448106321*^9}, {3.913223234105648*^9, 
  3.913223237933677*^9}, {3.913291636903202*^9, 3.9132916406131687`*^9}, {
  3.9132946570761905`*^9, 3.9132946629358387`*^9}, {3.913564800937859*^9, 
  3.913564801617362*^9}, {3.9135656862408423`*^9, 3.913565687832162*^9}, {
  3.913616035617523*^9, 3.913616048609668*^9}, {3.913618391363519*^9, 
  3.9136184180155187`*^9}, {3.924956276867651*^9, 
  3.9249563141067624`*^9}},ExpressionUUID->"b94f167d-aab5-4325-afa0-\
1ea47acc7489"]
}, Closed]],

Cell[CellGroupData[{

Cell["- Defining Functions for Analysis:", "Title",
 CellChangeTimes->{{3.9122281715423937`*^9, 3.9122282598009386`*^9}, {
   3.9122283847862544`*^9, 3.9122283848918076`*^9}, {3.912228569513807*^9, 
   3.9122285751733475`*^9}, {3.91223176334604*^9, 3.9122317972925534`*^9}, {
   3.9122716299734344`*^9, 3.9122717365117116`*^9}, {3.9122718362552385`*^9, 
   3.9122718536050777`*^9}, {3.9123410766129136`*^9, 
   3.9123412431584206`*^9}, {3.912768387705806*^9, 3.912768407765542*^9}, {
   3.912768917886154*^9, 3.9127689233157587`*^9}, {3.91279208893838*^9, 
   3.912792100838392*^9}, 3.9131121297542343`*^9, 3.913621783344319*^9, 
   3.913645939347333*^9, {3.924949281071561*^9, 3.924949283486678*^9}, 
   3.9249549056345716`*^9, {3.924955660557287*^9, 
   3.9249556606534505`*^9}},ExpressionUUID->"5fd7da52-6e4e-4541-9f7f-\
e6f5f6235619"],

Cell[CellGroupData[{

Cell["\<\
Code to import data, perform clustering, and compute centroids:\
\>", "Chapter",
 CellChangeTimes->{{3.912696735090163*^9, 3.9126967402976975`*^9}, {
  3.9127686423757286`*^9, 3.912768663565779*^9}, {3.924955085144431*^9, 
  3.924955096573043*^9}},ExpressionUUID->"232fe3fe-9ce3-405c-845e-\
ca809a4b34a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"importData", "[", 
     RowBox[{"fileName_", ":", " ", "\"\<datapoints_seurat_BT_ALL\>\""}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "datapoints0", ",", " ", "datapoints1", ",", "datapoints", ",", 
        "fileDirectory"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fileDirectory", "=", "\"\<\\\\inputs\\\\\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datapoints0", " ", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], "<>", "fileDirectory", "<>",
            "fileName", "<>", "\"\<.xlsx\>\""}], ",", "\"\<Data\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"datapoints1", " ", "=", " ", 
        RowBox[{"datapoints0", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"2", ";;"}]}], "]"}], "]"}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datapoints", " ", "=", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"datapoints1", ",", 
           RowBox[{"UnequalTo", "[", 
            RowBox[{"Table", "[", 
             RowBox[{"0.", ",", "ngenes"}], "]"}], "]"}]}], "]"}], "/.", " ", 
         
         RowBox[{"{", 
          RowBox[{"0.", "\[Rule]", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "datapoints", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"computeClustersNbC", "[", 
     RowBox[{
     "datapoints_", ",", " ", "distanceFunction_", ",", " ", "postotal_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dataclustnumber", ",", " ", "fourtuple", ",", " ", "components", ",", 
        " ", "dataclust"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dataclustnumber", "=", 
        RowBox[{"FindClusters", "[", 
         RowBox[{
          RowBox[{"datapoints", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "postotal"}], "]"}], "]"}], ",", 
          RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
          RowBox[{"CriterionFunction", "->", "\"\<StandardDeviation\>\""}], 
          ",", 
          RowBox[{"DistanceFunction", "->", "distanceFunction"}], ",", 
          RowBox[{"Method", "->", "\"\<NeighborhoodContraction\>\""}]}], 
         "]"}]}], ";", "        ", "\[IndentingNewLine]", 
       RowBox[{"fourtuple", "=", 
        RowBox[{"datapoints", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "postotal"}], "]"}], "]"}]}], ";", "         ", 
       "\[IndentingNewLine]", 
       RowBox[{"components", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"dataclustnumber", ",", 
             RowBox[{"fourtuple", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "datapoints", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"dataclust", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"First", ",", 
          RowBox[{"GatherBy", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"datapoints", ",", "components"}], "}"}], "]"}], ",", 
            "Last"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "dataclust", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"computeClustersKmeans", "[", 
     RowBox[{
     "datapoints_", ",", " ", "datanclusters_", ",", " ", "distanceFunction_",
       ",", " ", "postotal_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"components", ",", "dataclust"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"components", "=", 
        RowBox[{"ClusteringComponents", "[", 
         RowBox[{
          RowBox[{"datapoints", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "postotal"}], "]"}], "]"}], ",", 
          "datanclusters", ",", "1", ",", 
          RowBox[{"PerformanceGoal", "->", "\"\<Quality\>\""}], ",", 
          RowBox[{"CriterionFunction", "->", "\"\<StandardDeviation\>\""}], 
          ",", 
          RowBox[{"DistanceFunction", "->", "distanceFunction"}], ",", 
          RowBox[{"Method", "->", "\"\<KMeans\>\""}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataclust", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"First", ",", 
          RowBox[{"GatherBy", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"datapoints", ",", "components"}], "}"}], "]"}], ",", 
            "Last"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "dataclust", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "to", " ", "perform", " ", "common", " ", 
    "calculations"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"commonCalculations", "[", "dataclust_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "databasinsmode", ",", "databasinscenters", ",", "databasinssigmas", ",",
       "dataweights", ",", "dataweightsperc"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"databasinsmode", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Commonest", "[", 
         RowBox[{
          RowBox[{"dataclust", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "dataclust", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"databasinscenters", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"dataclust", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "dataclust", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"databasinssigmas", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"StandardDeviation", "[", 
          RowBox[{"dataclust", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "1", ",", 
           RowBox[{"Length", "[", "dataclust", "]"}]}], "}"}]}], "]"}], "+", 
       RowBox[{"1", "/", "100"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dataweights", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"dataclust", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"Length", "[", "dataclust", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dataweightsperc", "=", 
      RowBox[{"dataweights", "/", 
       RowBox[{"Total", "[", "dataweights", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "databasinsmode", ",", "databasinscenters", ",", "databasinssigmas", 
       ",", "dataweights", ",", "dataweightsperc"}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9122406990549693`*^9, 3.912240701189312*^9}, 
   3.912240738774769*^9, {3.9122408513888817`*^9, 3.912240851960067*^9}, {
   3.9122410146687636`*^9, 3.9122410203716273`*^9}, {3.912241153534314*^9, 
   3.912241184123456*^9}, {3.9122412502052402`*^9, 3.9122412523831635`*^9}, {
   3.91224128476209*^9, 3.9122412869736643`*^9}, 3.9122413546382217`*^9, {
   3.9122413906450057`*^9, 3.9122413917261314`*^9}, {3.9123250082451963`*^9, 
   3.9123250084449205`*^9}, {3.9123251858479977`*^9, 3.912325241023873*^9}, {
   3.912327435481582*^9, 3.9123274553309746`*^9}, {3.912327489966718*^9, 
   3.9123274901457753`*^9}, {3.912327622557397*^9, 3.9123276250469537`*^9}, 
   3.91232783769607*^9, 3.912328276830479*^9, {3.9127740892305937`*^9, 
   3.912774095077392*^9}, {3.9127741344486585`*^9, 3.912774200593811*^9}, {
   3.912774264413907*^9, 3.912774347676343*^9}, 3.9127744182963924`*^9, {
   3.912774563197118*^9, 3.9127745682399025`*^9}, {3.91277460452264*^9, 
   3.9127746653585405`*^9}, {3.9127747623399377`*^9, 3.912774826590166*^9}, {
   3.9127748945439415`*^9, 3.912774951107952*^9}, {3.9127749985762033`*^9, 
   3.9127752065761633`*^9}, {3.9127752435877624`*^9, 3.9127753254522705`*^9}, 
   3.9127753948528614`*^9, {3.912775449742958*^9, 3.912775469323328*^9}, {
   3.91277550896344*^9, 3.9127755297322397`*^9}, {3.9127755635255847`*^9, 
   3.912775596052641*^9}, {3.9127756617100196`*^9, 3.912775665440063*^9}, {
   3.9127758101001625`*^9, 3.912775812720228*^9}, {3.9127759368434258`*^9, 
   3.912775953360194*^9}, {3.912785021427435*^9, 3.912785022715536*^9}, {
   3.912785103082936*^9, 3.912785105786396*^9}, {3.912790759662325*^9, 
   3.912790762269913*^9}, {3.912792167642962*^9, 3.912792191607888*^9}, 
   3.912792228708179*^9, {3.912801722660426*^9, 3.912801775667207*^9}, {
   3.9128018083705125`*^9, 3.9128018139907255`*^9}, {3.912802225351203*^9, 
   3.912802226280504*^9}, {3.9128023624808426`*^9, 3.912802362862898*^9}, {
   3.913559613941905*^9, 3.913559614344695*^9}, {3.913560894038391*^9, 
   3.9135609008130755`*^9}, {3.913616102132699*^9, 3.9136161496612997`*^9}, {
   3.913616196643334*^9, 3.913616198346794*^9}, {3.9136162522953815`*^9, 
   3.9136163136271205`*^9}, {3.913616345792448*^9, 3.9136163682179728`*^9}, {
   3.9136163993431015`*^9, 3.9136164398294725`*^9}, {3.9136165193054495`*^9, 
   3.913616688396783*^9}, {3.913616787595247*^9, 3.913616807303487*^9}, {
   3.91361689486971*^9, 3.913616947451063*^9}, {3.913617009305505*^9, 
   3.913617029615614*^9}, {3.9136170682713904`*^9, 3.9136170743645563`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"86f91b6d-bdd4-4987-9180-f3107a990681"]
}, Closed]],

Cell[CellGroupData[{

Cell["Code to reorder clusters:", "Chapter",
 CellChangeTimes->{{3.912778328840788*^9, 3.912778334970849*^9}, {
  3.9249551041473145`*^9, 
  3.9249551055912824`*^9}},ExpressionUUID->"f1a6225e-dd51-4d85-8a31-\
f2f3ea0233b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "    ", 
                    "Fun\[CCedilla]\[OTilde]es"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"auxiliares", "  ", "--"}], "--"}], "--"}], "--"}], "--"}],
        "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"distanceFunc", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "diff", "}"}], ",", 
      RowBox[{
       RowBox[{"diff", "=", 
        RowBox[{"x", "-", "y"}]}], ";", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Total", "[", 
         RowBox[{"diff", "^", "2"}], "]"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mahalanobisDistance", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"diff", ",", "invCov", ",", "covMatrix"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diff", "=", 
        RowBox[{"x", "-", "y"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"covMatrix", "=", 
        RowBox[{"Covariance", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"invCov", "=", 
        RowBox[{"Inverse", "[", "covMatrix", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"diff", ".", "invCov", ".", "diff"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computeCentroids", "[", "clusters_List", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"Mean", ",", "clusters"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"orderingBy", "[", 
     RowBox[{"lista_", ",", "ref_", ",", "func_"}], "]"}], ":=", 
    RowBox[{"Ordering", "[", 
     RowBox[{"N", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"func", "[", 
          RowBox[{"#", ",", "ref"}], "]"}], "&"}], ",", "lista"}], "]"}], 
      "]"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"n\[ATilde]o", " ", "uso"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{"distBy", "[", 
     RowBox[{"lista_", ",", "ref_", ",", "func_"}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"func", "[", 
         RowBox[{"#", ",", "ref"}], "]"}], "&"}], ",", "lista"}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"listWithMinValue", "[", "lista_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "minIndex", "}"}], ",", 
       RowBox[{
        RowBox[{"minIndex", "=", 
         RowBox[{"First", "[", 
          RowBox[{"Ordering", "[", 
           RowBox[{
            RowBox[{"lista", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
          "]"}]}], ";", 
        RowBox[{"lista", "[", 
         RowBox[{"[", "minIndex", "]"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fillMissedValues", "[", " ", 
      RowBox[{"lista_", ",", " ", "refNclusters_"}], "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "testCentroidIndices", ",", " ", "extraCentroids", ",", 
         "orderedIndices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"testCentroidIndices", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "lista", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"extraCentroids", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"testCentroidIndices", ",", 
           RowBox[{"Flatten", "[", "lista", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"orderedIndices", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"lista", ",", 
           RowBox[{"Select", "[", 
            RowBox[{"extraCentroids", ",", 
             RowBox[{
              RowBox[{"#", "<=", "refNclusters"}], "&"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "orderedIndices", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mapDistances", "[", 
     RowBox[{"refCentroids_List", ",", "simCentroids_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "debug", ",", "distList", ",", "mappedList", ",", 
        "numberOfRefCentroids", ",", "numberOfTestCentroids", ",", 
        "\[IndentingNewLine]", "listaAgregada", ",", "tamanhoListaAgregada", 
        ",", "armazenaIndReordenados", ",", "salvaIndices", ",", "salvaDists",
         ",", "\[IndentingNewLine]", "testandoSorting", ",", "indiceDe", ",", 
        "indicePara", ",", "indiceDist"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"debug", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"numberOfRefCentroids", "=", 
        RowBox[{"Length", "[", "refCentroids", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numberOfTestCentroids", "=", 
        RowBox[{"Length", "[", "simCentroids", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"distList", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"distBy", "[", 
           RowBox[{"simCentroids", ",", "#", ",", "distanceFunc"}], "]"}], 
          "&"}], "/@", "refCentroids"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", "distList", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mappedList", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"MinimalBy", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#1", ",", "i", ",", "#2"}], "}"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"distList", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", "simCentroids", "]"}], "]"}]}], 
                 "}"}]}], "]"}], ",", "First"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "numberOfRefCentroids"}], "}"}]}], "]"}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", "mappedList", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"listaAgregada", "=", 
        RowBox[{"GatherBy", "[", 
         RowBox[{"mappedList", ",", "Last"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tamanhoListaAgregada", "=", 
        RowBox[{"Length", "[", "listaAgregada", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"armazenaIndReordenados", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "numberOfRefCentroids"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"salvaIndices", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"salvaDists", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "numberOfRefCentroids"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"testandoSorting", "=", 
           RowBox[{"listWithMinValue", "[", 
            RowBox[{"listaAgregada", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indiceDe", "=", 
           RowBox[{"testandoSorting", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"indicePara", "=", 
           RowBox[{"testandoSorting", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"indiceDist", "=", 
           RowBox[{"testandoSorting", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"indiceDe", ",", "salvaIndices"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"indiceDist", "<", 
               RowBox[{"salvaDists", "[", 
                RowBox[{"[", "indicePara", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"armazenaIndReordenados", "[", 
                 RowBox[{"[", "indicePara", "]"}], "]"}], "=", "indiceDe"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"salvaDists", "[", 
                 RowBox[{"[", "indicePara", "]"}], "]"}], "=", "indiceDist"}],
                ";"}], ",", 
              RowBox[{
               RowBox[{"armazenaIndReordenados", "[", 
                RowBox[{"[", "indicePara", "]"}], "]"}], "=", 
               RowBox[{"armazenaIndReordenados", "[", 
                RowBox[{"[", "indicePara", "]"}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"salvaIndices", ",", "indiceDe"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"armazenaIndReordenados", "[", 
               RowBox[{"[", "indicePara", "]"}], "]"}], "=", "indiceDe"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"salvaDists", "[", 
               RowBox[{"[", "indicePara", "]"}], "]"}], "=", "indiceDist"}], 
             ";"}]}], "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "tamanhoListaAgregada"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"armazenaIndReordenados", "=", 
        RowBox[{"fillMissedValues", "[", 
         RowBox[{"armazenaIndReordenados", ",", "numberOfTestCentroids"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "armazenaIndReordenados", "]"}], ";"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "Fun\[CCedilla]\[ATilde]o"}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}], " ", "para", " ", "mapear", " ", "dist\[AHat]ncias", " ", "a", 
      " ", "pares", " ", "de", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"centr\[OAcute]ides", "--"}], "--"}], "--"}], "--"}], 
         "--"}], "--"}], "--"}]}], "-", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reorderAndInsertNew", "[", 
     RowBox[{"listaOriginal_", ",", "novaOrdem_", ",", "novoElemento_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "novaLista", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"novaLista", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"novaOrdem", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ",", "novoElemento", ",", 
            RowBox[{"listaOriginal", "[", 
             RowBox[{"[", 
              RowBox[{"novaOrdem", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "novaOrdem", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "novaLista"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"orderedDataCluster", "[", 
      RowBox[{
      "dadosParaReordenar_", ",", "dadosDeReferencia_", ",", 
       "dimensoesParaDistancia_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "debug", ",", "centroidesDeReferencia", ",", 
         "centroidesparaReordenar", ",", "numeroDeClustersNaReferencia", ",", 
         "numeroDeClustersParaReordenar", ",", "orderedIndices", ",", 
         "\[IndentingNewLine]", "testCentroidIndices", ",", "extraCentroids", 
         ",", "\[IndentingNewLine]", "novoElemento", ",", "dataclustnew"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"debug", "=", "False"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"centroidesDeReferencia", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "dimensoesParaDistancia", "]"}], "]"}], "&"}], ",", 
           
           RowBox[{"computeCentroids", "[", "dadosDeReferencia", "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"centroidesparaReordenar", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "dimensoesParaDistancia", "]"}], "]"}], "&"}], ",", 
           
           RowBox[{"computeCentroids", "[", "dadosParaReordenar", "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"numeroDeClustersNaReferencia", "=", 
         RowBox[{"Length", "[", "dadosDeReferencia", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"numeroDeClustersParaReordenar", "=", 
         RowBox[{"Length", "[", "dadosParaReordenar", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"orderedIndices", "=", 
         RowBox[{"mapDistances", "[", 
          RowBox[{"centroidesDeReferencia", ",", "centroidesparaReordenar"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"tinha", " ", "comentado"}], ",", " ", 
          RowBox[{
          "mas", " ", "parece", " ", "que", " ", "precisa", " ", "mesmo"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
          "numeroDeClustersParaReordenar", ">", 
           "numeroDeClustersNaReferencia"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"testCentroidIndices", "=", 
            RowBox[{"Range", "[", "numeroDeClustersParaReordenar", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"extraCentroids", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{"testCentroidIndices", ",", "orderedIndices"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"orderedIndices", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"orderedIndices", ",", "extraCentroids"}], "]"}], 
             "]"}]}]}], ",", 
          RowBox[{"orderedIndices", "=", "orderedIndices"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", 
          RowBox[{"Print", "[", "orderedIndices", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"novoElemento", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dataclustnew", "=", 
         RowBox[{"reorderAndInsertNew", "[", 
          RowBox[{
          "dadosParaReordenar", ",", "orderedIndices", ",", "novoElemento"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "dataclustnew", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findClustersLetters", "[", 
      RowBox[{
      "simClusteredData_", ",", "methodNBCdataclustTotal_", ",", 
       "postotal_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "debug", ",", "orderedSimCluster", ",", "totalNumberOfClusters", ",", 
         "nonNullOrderedClusters", ",", "filledClustersLetters"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"debug", "=", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"orderedSimCluster", "=", 
         RowBox[{"orderedDataCluster", "[", 
          RowBox[{
          "simClusteredData", ",", "methodNBCdataclustTotal", ",", 
           "postotal"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"totalNumberOfClusters", " ", "=", " ", 
         RowBox[{"Length", "[", "orderedSimCluster", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nonNullOrderedClusters", "=", 
         RowBox[{"positionsAndFilledClusters", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"Dimensions", ",", "orderedSimCluster"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"debug", ",", 
          RowBox[{"Print", "[", "nonNullOrderedClusters", "]"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"filledClustersLetters", "=", 
         RowBox[{
          RowBox[{"letters", "[", "totalNumberOfClusters", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"nonNullOrderedClusters", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "filledClustersLetters"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9127783372667694`*^9, 3.9127783519859223`*^9}, {
   3.9127786553160696`*^9, 3.9127786556207256`*^9}, {3.9127786989609437`*^9, 
   3.912778705340872*^9}, {3.9127787457210474`*^9, 3.9127789705907817`*^9}, {
   3.912779005640844*^9, 3.9127790299024563`*^9}, {3.912779108965847*^9, 
   3.9127792679123125`*^9}, {3.9127793281159153`*^9, 
   3.9127793946010237`*^9}, {3.912779480305956*^9, 3.9127795790761237`*^9}, {
   3.9127796909351535`*^9, 3.9127797024759493`*^9}, {3.9127797581361504`*^9, 
   3.912779765448414*^9}, {3.9127803662836294`*^9, 3.912780369302171*^9}, {
   3.912780463749002*^9, 3.9127804691916356`*^9}, 3.912780600877356*^9, {
   3.9127807612315063`*^9, 3.912780777601729*^9}, {3.9127808267913017`*^9, 
   3.912780827331502*^9}, {3.912781020576387*^9, 3.9127810495016065`*^9}, {
   3.9127811069264774`*^9, 3.912781121076649*^9}, {3.912781184486699*^9, 
   3.9127812076439342`*^9}, 3.912781313692743*^9, 3.912781612246831*^9, {
   3.912781661856645*^9, 3.912781762355425*^9}, {3.912784781412526*^9, 
   3.9127848192962923`*^9}, {3.9127848590726357`*^9, 
   3.9127848799825306`*^9}, {3.912787237698251*^9, 3.9127872445130925`*^9}, {
   3.9127881565546722`*^9, 3.912788169987851*^9}, {3.9127895694703507`*^9, 
   3.912789580036413*^9}, {3.9127926658981376`*^9, 3.912792666028616*^9}, {
   3.912793128613571*^9, 3.912793174448476*^9}, {3.912794331418994*^9, 
   3.912794367638891*^9}, {3.9127959460489855`*^9, 3.9127959800493183`*^9}, {
   3.912801883548174*^9, 3.912801889720566*^9}, 3.9128024878662715`*^9, {
   3.912876654075034*^9, 3.9128766615449533`*^9}, 3.9128768835500855`*^9, {
   3.912876987465176*^9, 3.91287702759015*^9}, {3.9128782502534037`*^9, 
   3.91287827903032*^9}, {3.912928025119305*^9, 3.9129280634028597`*^9}, {
   3.9129281469817266`*^9, 3.912928156028734*^9}, {3.9129282484555902`*^9, 
   3.912928263013224*^9}, {3.913304675571413*^9, 3.9133046794077916`*^9}, {
   3.913577086260502*^9, 3.9135770868787556`*^9}, {3.9135772074885674`*^9, 
   3.913577236767291*^9}, {3.9136173034268*^9, 3.9136173094462295`*^9}, {
   3.9136176475752025`*^9, 3.9136176483087635`*^9}, {3.9249506875897465`*^9, 
   3.924950689138484*^9}, {3.924952538777383*^9, 
   3.924952555358102*^9}},ExpressionUUID->"bafd36b5-4ba8-4d26-8d18-\
3225da2388b5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Code for dispersion plots, ellipsoids, etc.:", "Chapter",
 CellChangeTimes->{{3.9127688143159957`*^9, 3.912768835255871*^9}, {
  3.9127760857804785`*^9, 3.9127760940702133`*^9}, {3.9249551343003364`*^9, 
  3.9249551379554596`*^9}},ExpressionUUID->"3981df79-b8a0-4a5d-bef7-\
89c4f56cdf65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"numberToCapitalLetter", "[", "n_Integer", "]"}], ":=", 
   RowBox[{"ToUpperCase", "[", 
    RowBox[{"FromCharacterCode", "[", 
     RowBox[{"n", "+", 
      RowBox[{"ToCharacterCode", "[", "\"\<A\>\"", "]"}], "-", "1"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"letters", "[", "cnumber_", "]"}], ":=", 
    RowBox[{"CharacterRange", "[", 
     RowBox[{"\"\<A\>\"", ",", 
      RowBox[{"numberToCapitalLetter", "[", "cnumber", "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotScatterData", "[", 
     RowBox[{"dataclust_", ",", " ", "postotal_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"combinations", ",", "datacorr", ",", "datacorrexp"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"combinations", " ", "=", " ", 
        RowBox[{"Subsets", "[", 
         RowBox[{"postotal", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"datacorr", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"dataclust", "[", 
                 RowBox[{"[", 
                  RowBox[{"nbasin", ",", "dataPoints", ",", 
                   RowBox[{"combinations", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], 
                ",", 
                RowBox[{"dataclust", "[", 
                 RowBox[{"[", 
                  RowBox[{"nbasin", ",", "dataPoints", ",", 
                   RowBox[{"combinations", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "combinations", "]"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"dataPoints", ",", "1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"dataclust", "[", 
                RowBox[{"[", "nbasin", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"nbasin", ",", "1", ",", 
            RowBox[{"Length", "[", "dataclust", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"datacorrexp", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"datacorr", "[", 
                RowBox[{"[", 
                 RowBox[{"nbasins", ",", ";;", ",", "landnumber"}], "]"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nbasins", ",", "1", ",", 
                 RowBox[{"Length", "[", "dataclust", "]"}]}], "}"}]}], "]"}], 
             ",", 
             RowBox[{"ImageSize", "->", "300"}], ",", 
             RowBox[{"PlotStyle", "->", 
              RowBox[{"PointSize", "[", "Tiny", "]"}]}], ",", 
             RowBox[{"PlotMarkers", "->", "Automatic"}], ",", 
             RowBox[{"PlotLegends", "->", 
              RowBox[{"letters", "[", 
               RowBox[{"Length", "[", "dataclust", "]"}], "]"}]}], ",", 
             RowBox[{"LabelStyle", "->", 
              RowBox[{"Directive", "[", 
               RowBox[{"\"\<Times\>\"", ",", "12"}], "]"}]}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"names", "[", 
                 RowBox[{"[", 
                  RowBox[{"combinations", "[", 
                   RowBox[{"[", 
                    RowBox[{"landnumber", ",", "1"}], "]"}], "]"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"names", "[", 
                 RowBox[{"[", 
                  RowBox[{"combinations", "[", 
                   RowBox[{"[", 
                    RowBox[{"landnumber", ",", "2"}], "]"}], "]"}], "]"}], 
                 "]"}]}], "}"}]}]}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"landnumber", ",", "1", ",", 
            RowBox[{"Length", "[", "combinations", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "datacorrexp", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getCovarianceAndMean", "[", "data_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mean", "=", 
         RowBox[{"Mean", "[", "data", "]"}]}], ",", 
        RowBox[{"cov", "=", 
         RowBox[{"Covariance", "[", "data", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"cov", ",", "mean"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotPointsAndElipsoid", "[", 
    RowBox[{
    "pointsData_", ",", "elipsoidData_", ",", "indices_", ",", 
     "selectConfidenceLevel_", ",", " ", 
     RowBox[{"selectLetters_", ":", "False"}], ",", 
     RowBox[{"listOfLetters_", ":", "All"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "clustersToPlotPoints", ",", "dimNames", ",", "dimToPlot", ",", 
       "covAndMeans", ",", "sigmaFactor", ",", "lettersToPlot", ",", 
       "datacorrexp3D", ",", "maxClusters", ",", "\[IndentingNewLine]", "df", 
       ",", " ", "confidenceLevel", ",", " ", "criticalValue"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"maxClusters", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Length", "[", "elipsoidData", "]"}], ",", " ", 
         RowBox[{"Length", "[", "pointsData", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"clustersToPlotPoints", "=", "maxClusters"}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Length", "[", "elipsoidData", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"dimNames", "=", 
       RowBox[{"names", "[", 
        RowBox[{"[", 
         RowBox[{"indices", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dimToPlot", "=", 
       RowBox[{"indices", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"covAndMeans", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCovarianceAndMean", "[", 
          RowBox[{"elipsoidData", "[", 
           RowBox[{"[", 
            RowBox[{"nCluster", ",", "All", ",", "dimToPlot"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"nCluster", ",", 
           RowBox[{"Length", "[", "elipsoidData", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"df", "=", 
       RowBox[{"Length", "[", "dimToPlot", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"confidenceLevel", "=", "selectConfidenceLevel"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"criticalValue", "=", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"ChiSquareDistribution", "[", "df", "]"}], ",", 
         "confidenceLevel"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigmaFactor", "=", "criticalValue"}], " ", 
      RowBox[{"(*", 
       RowBox[{"7.815", ";", "  ", 
        RowBox[{"2", " ", "sigmas"}]}], "*)"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lettersToPlot", "=", 
       RowBox[{"If", "[", 
        RowBox[{"selectLetters", ",", "listOfLetters", ",", 
         RowBox[{"letters", "[", "maxClusters", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"datacorrexp3D", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"pointsData", "[", 
              RowBox[{"[", 
               RowBox[{"nCluster", ",", "All", ",", "dimToPlot"}], "]"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"nCluster", ",", "clustersToPlotPoints"}], "}"}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.015", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.015", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.018", "]"}], ",", 
              RowBox[{"PointSize", "[", "0.018", "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotLegends", "->", "lettersToPlot"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LabelStyle", "->", 
            RowBox[{"Directive", "[", 
             RowBox[{"\"\<Times\>\"", ",", "12"}], "]"}]}], ",", 
           RowBox[{"AxesLabel", "->", "dimNames"}], ",", 
           RowBox[{"Boxed", "->", "True"}], ",", 
           RowBox[{"BoxStyle", "->", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black", 
              ",", "12"}], "]"}]}], ",", 
           RowBox[{"LabelStyle", "->", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black", 
              ",", "12"}], "]"}]}], ",", 
           RowBox[{"PlotTheme", "->", "\"\<Detailed\>\""}], ",", " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ImagePadding", "->", "50"}], ",", " ", 
             RowBox[{"ImageSize", "->", 
              RowBox[{"Scaled", "[", "0.6", "]"}]}], ","}], "*)"}], 
           RowBox[{"ImageSize", "->", "500"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.5"}], ",", "10"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.5"}], ",", "10"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.5"}], ",", "10"}], "}"}]}], "}"}]}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Adicionar", " ", "elipsoides"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Graphics3D", "[", 
          RowBox[{"{", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Opacity", "[", "0.4", "]"}], ",", 
               RowBox[{
                RowBox[{"ColorData", "[", "97", "]"}], "[", "nCluster", "]"}],
                ",", 
               RowBox[{"Ellipsoid", "[", 
                RowBox[{
                 RowBox[{"covAndMeans", "[", 
                  RowBox[{"[", 
                   RowBox[{"nCluster", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"sigmaFactor", "*", 
                  RowBox[{"covAndMeans", "[", 
                   RowBox[{"[", 
                    RowBox[{"nCluster", ",", "1"}], "]"}], "]"}]}]}], "]"}]}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"nCluster", ",", 
               RowBox[{"Length", "[", "elipsoidData", "]"}]}], "}"}]}], "]"}],
            "}"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "datacorrexp3D", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.912329515535962*^9, 3.912329545957687*^9}, {
   3.9123295860649624`*^9, 3.9123296833946624`*^9}, {3.9123305456813583`*^9, 
   3.912330545902836*^9}, {3.912330579753025*^9, 3.912330611449188*^9}, {
   3.9123306760861406`*^9, 3.912330693767769*^9}, {3.9123307275269547`*^9, 
   3.9123307431078167`*^9}, {3.912337138584699*^9, 3.9123371394273663`*^9}, {
   3.9127760974741397`*^9, 3.9127761677404556`*^9}, {3.9127762026304436`*^9, 
   3.912776289790077*^9}, {3.912777749805461*^9, 3.91277783718067*^9}, {
   3.9127778850207915`*^9, 3.9127779143907366`*^9}, {3.9127819195615907`*^9, 
   3.9127819302716217`*^9}, {3.9127822605871024`*^9, 3.912782284372208*^9}, {
   3.9127823346468973`*^9, 3.912782345652898*^9}, {3.9127824050269985`*^9, 
   3.9127824091319575`*^9}, {3.9127897325088797`*^9, 
   3.9127897709537687`*^9}, {3.912794419648548*^9, 3.9127944458789754`*^9}, {
   3.912794528048745*^9, 3.912794554289049*^9}, 3.912798128859649*^9, {
   3.9127981892294903`*^9, 3.9127981942996893`*^9}, {3.9127982999697385`*^9, 
   3.9127983224979177`*^9}, {3.912798914939846*^9, 3.9127989497699437`*^9}, {
   3.912799031160189*^9, 3.9127990377797346`*^9}, {3.912799095940277*^9, 
   3.9127990983601084`*^9}, {3.9128020324843044`*^9, 3.912802063312312*^9}, {
   3.9128027765745993`*^9, 3.9128027769711285`*^9}, {3.9128029390410776`*^9, 
   3.9128029497009754`*^9}, 3.912845497597743*^9, {3.9128496717442284`*^9, 
   3.9128497280640154`*^9}, {3.912849806444168*^9, 3.912849907914172*^9}, {
   3.9128499701943135`*^9, 3.912849981429096*^9}, {3.9128500992640634`*^9, 
   3.9128501160444574`*^9}, {3.9128501464044237`*^9, 
   3.9128501476244955`*^9}, {3.912850284524254*^9, 3.9128502859140425`*^9}, {
   3.9131218883596764`*^9, 3.9131219169431295`*^9}, {3.913140050239983*^9, 
   3.913140065662001*^9}, {3.9131419531010923`*^9, 3.9131419686592717`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"bce298ad-04da-4ed1-b0ac-1123819b9f29"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Code to verify the percentage of points inside reference or other ellipsoids:\
\
\>", "Chapter",
 CellChangeTimes->{{3.912768869176214*^9, 3.9127688855462284`*^9}, {
   3.912782790851989*^9, 3.9127828106024127`*^9}, 
   3.924955153307164*^9},ExpressionUUID->"b03912fc-88db-4ec3-a4b5-\
0244aa2ee19a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"percentOfPointsInsideElipsoids", "[", 
     RowBox[{
     "pointsData_", ",", "elipsoidData_", ",", "indices_", ",", " ", 
      "selectConfidenceLevel_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"debug", "=", "False"}], ",", "rank", ",", " ", "dimToPlot", 
        ",", "covAndMeans", ",", "sigmaFactor", ",", "numberOfPointsToPlot", 
        ",", "pointsWithin2Sigmas", ",", "invCov", ",", "mean", ",", 
        "percentWithin2Sigmas", ",", "\[IndentingNewLine]", "df", ",", " ", 
        "confidenceLevel", ",", " ", "criticalValue"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dimToPlot", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "indices", "]"}], " ", "==", " ", 
           RowBox[{"ToString", "[", "0", "]"}]}], ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "ngenes"}], "}"}]}], "]"}], ",", 
          RowBox[{"indices", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"rule", "=", 
          RowBox[{"0", ":>", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0.01", ",", " ", "0.3"}], "}"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"covAndMeans", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"getCovarianceAndMean", "[", 
             RowBox[{
              RowBox[{"elipsoidData", "[", 
               RowBox[{"[", 
                RowBox[{"nCluster", ",", "All", ",", "dimToPlot"}], "]"}], 
               "]"}], "/.", " ", "rule"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nCluster", ",", 
              RowBox[{"Length", "[", "elipsoidData", "]"}]}], "}"}]}], 
           "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"covAndMeans", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"getCovarianceAndMean", "[", 
           RowBox[{"elipsoidData", "[", 
            RowBox[{"[", 
             RowBox[{"nCluster", ",", "All", ",", "dimToPlot"}], "]"}], "]"}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"nCluster", ",", 
            RowBox[{"Length", "[", "elipsoidData", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"df", "=", 
        RowBox[{"Length", "[", "dimToPlot", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"confidenceLevel", "=", "selectConfidenceLevel"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"criticalValue", "=", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"ChiSquareDistribution", "[", "df", "]"}], ",", 
          "confidenceLevel"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmaFactor", "=", "criticalValue"}], " ", 
       RowBox[{"(*", 
        RowBox[{"7.815", ";", "  ", 
         RowBox[{"2", " ", "sigmas"}]}], "*)"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", " ", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<df: \>\"", ",", " ", "df", ",", " ", 
           "\"\<; criticalValue: \>\"", ",", " ", "criticalValue"}], " ", 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"numberOfPointsToPlot", "=", 
        RowBox[{"Length", "[", "elipsoidData", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"percentWithin2Sigmas", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"rank", "=", 
            RowBox[{"MatrixRank", "[", 
             RowBox[{"covAndMeans", "[", 
              RowBox[{"[", 
               RowBox[{"nCluster", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"debug", ",", " ", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Cluster: \>\"", ",", " ", "nCluster", ",", " ", 
               "\"\<; rank: \>\"", ",", " ", "rank"}], " ", "]"}]}], "]"}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"invCov", "=", 
            RowBox[{"Inverse", "[", 
             RowBox[{"covAndMeans", "[", 
              RowBox[{"[", 
               RowBox[{"nCluster", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mean", "=", 
            RowBox[{"covAndMeans", "[", 
             RowBox[{"[", 
              RowBox[{"nCluster", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"pointsData", "[", 
                RowBox[{"[", "nCluster", "]"}], "]"}], "]"}], "!=", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"N", "[", 
              RowBox[{"100", "*", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{
                  RowBox[{"pointsData", "[", 
                   RowBox[{"[", 
                    RowBox[{"nCluster", ",", "All", ",", "dimToPlot"}], "]"}],
                    "]"}], ",", 
                  RowBox[{"point_", "/;", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"point", "-", "mean"}], ")"}], ".", "invCov", ".", 
                    RowBox[{"(", 
                    RowBox[{"point", "-", "mean"}], ")"}]}], "<=", " ", 
                    "sigmaFactor"}]}]}], "]"}], "/", 
                RowBox[{"Length", "[", 
                 RowBox[{"pointsData", "[", 
                  RowBox[{"[", "nCluster", "]"}], "]"}], "]"}]}]}], "]"}], 
             "\[IndentingNewLine]", ",", "0"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"nCluster", ",", "numberOfPointsToPlot"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"100", "*", 
          RowBox[{"pointsWithin2Sigmas", "/", 
           RowBox[{"(", 
            RowBox[{"Length", "/@", "pointsData"}], ")"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\"\<Cluster \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"letters", "[", "numberOfPointsToPlot", "]"}], "[", 
            RowBox[{"[", "nCluster", "]"}], "]"}], "]"}], "<>", "\"\<: \>\"", 
          "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"percentWithin2Sigmas", "[", 
            RowBox[{"[", "nCluster", "]"}], "]"}], "]"}], "<>", "\"\<%\>\""}],
          ",", 
         RowBox[{"{", 
          RowBox[{"nCluster", ",", "numberOfPointsToPlot"}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"percentOfUnclusteredPointsInsideElipsoids", "[", 
     RowBox[{
     "pointsData_", ",", "elipsoidData_", ",", "indices_", ",", " ", 
      "selectConfidenceLevel_", ",", 
      RowBox[{"percent_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dimToPlot", ",", "covAndMeans", ",", "sigmaFactor", ",", 
        "numberOfPointsToPlot", ",", "pointsWithin2Sigmas", ",", "invCov", 
        ",", "mean", ",", "percentWithin2Sigmas", ",", "\[IndentingNewLine]", 
        "df", ",", " ", "confidenceLevel", ",", " ", "criticalValue"}], "}"}],
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dimToPlot", "=", 
        RowBox[{"indices", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"covAndMeans", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"getCovarianceAndMean", "[", 
           RowBox[{"elipsoidData", "[", 
            RowBox[{"[", 
             RowBox[{"nCluster", ",", "All", ",", "dimToPlot"}], "]"}], "]"}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"nCluster", ",", 
            RowBox[{"Length", "[", "elipsoidData", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"df", "=", 
        RowBox[{"Length", "[", "dimToPlot", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"confidenceLevel", "=", "selectConfidenceLevel"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"criticalValue", "=", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"ChiSquareDistribution", "[", "df", "]"}], ",", 
          "confidenceLevel"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmaFactor", "=", "criticalValue"}], " ", 
       RowBox[{"(*", 
        RowBox[{"7.815", ";", "  ", 
         RowBox[{"2", " ", "sigmas"}]}], "*)"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"numberOfPointsToPlot", "=", 
        RowBox[{"Length", "[", "elipsoidData", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"percentWithin2Sigmas", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"invCov", "=", 
            RowBox[{"Inverse", "[", 
             RowBox[{"covAndMeans", "[", 
              RowBox[{"[", 
               RowBox[{"nCluster", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mean", "=", 
            RowBox[{"covAndMeans", "[", 
             RowBox[{"[", 
              RowBox[{"nCluster", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"percent", ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{"100", "*", 
                 RowBox[{
                  RowBox[{"Count", "[", 
                   RowBox[{
                    RowBox[{"pointsData", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "dimToPlot"}], "]"}], "]"}], ",", 
                    RowBox[{"point_", "/;", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"point", "-", "mean"}], ")"}], ".", "invCov", ".", 
                    RowBox[{"(", 
                    RowBox[{"point", "-", "mean"}], ")"}]}], "<=", " ", 
                    "sigmaFactor"}]}]}], "]"}], "/", 
                  RowBox[{"Length", "[", "pointsData", "]"}]}]}], "]"}], ",", 
               
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"Count", "[", 
                  RowBox[{
                   RowBox[{"pointsData", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "dimToPlot"}], "]"}], "]"}], ",", 
                   RowBox[{"point_", "/;", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"point", "-", "mean"}], ")"}], ".", "invCov", ".", 
                    RowBox[{"(", 
                    RowBox[{"point", "-", "mean"}], ")"}]}], "<=", " ", 
                    "sigmaFactor"}]}]}], "]"}], "]"}], "<>", "\"\</\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Length", "[", "pointsData", "]"}], "]"}]}]}], "}"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"N", "[", 
              RowBox[{"Count", "[", 
               RowBox[{
                RowBox[{"pointsData", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "dimToPlot"}], "]"}], "]"}], ",", 
                RowBox[{"point_", "/;", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"point", "-", "mean"}], ")"}], ".", "invCov", ".", 
                   RowBox[{"(", 
                    RowBox[{"point", "-", "mean"}], ")"}]}], "<=", " ", 
                  "sigmaFactor"}]}]}], "]"}], 
              RowBox[{"(*", 
               RowBox[{"/", 
                RowBox[{"Length", "[", "pointsData", "]"}]}], "*)"}], "]"}]}],
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"nCluster", ",", "numberOfPointsToPlot"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\"\<Cluster \>\"", "<>", 
           RowBox[{"letters", "[", 
            RowBox[{"[", "nCluster", "]"}], "]"}], "<>", "\"\<: \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"percentWithin2Sigmas", "[", 
             RowBox[{"[", "nCluster", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"nCluster", ",", "numberOfPointsToPlot"}], "}"}]}], "]"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"percentWithin2Sigmas", "[", 
             RowBox[{"[", "nCluster", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nCluster", ",", "numberOfPointsToPlot"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "pointsData", "]"}], "}"}]}], "]"}], "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"percent", ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"\"\<Cluster \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"letters", "[", "numberOfPointsToPlot", "]"}], "[", 
              RowBox[{"[", "nCluster", "]"}], "]"}], "]"}], "<>", 
            "\"\<: \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"percentWithin2Sigmas", "[", 
               RowBox[{"[", "nCluster", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<% and: \>\"", 
            "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"percentWithin2Sigmas", "[", 
               RowBox[{"[", "nCluster", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"nCluster", ",", "numberOfPointsToPlot"}], "}"}]}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"percentWithin2Sigmas", "[", 
            RowBox[{"[", "nCluster", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"nCluster", ",", "numberOfPointsToPlot"}], "}"}]}], 
          "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"\"\<Valores para \>\"", "<>", "#", "<>", "\"\<->\>\""}], 
         ",", 
         RowBox[{"percentOfUnclusteredPointsInsideElipsoids", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"ToExpression", "[", "#", "]"}], ",", "1"}], "]"}], ",", 
           "methodNBCdataclustTotal", ",", " ", "postotal", ",", 
           "confidenceLevelDefaultValue", ",", "True"}], "]"}]}], "]"}], 
       "&"}], ",", " ", "listaDeDatasets"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"totalForPorb", " ", "=", " ", "2489"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sucesses", "=", 
     RowBox[{"Round", "[", 
      RowBox[{"2489", "*", "0.15"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"sucesses", "=", "15"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"estProb", "=", "0.17"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"binomialProbability", "[", 
      RowBox[{"n_", ",", "k_", ",", "p_"}], "]"}], ":=", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{"n", ",", "k"}], "]"}], " ", 
       RowBox[{"p", "^", "k"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"n", "-", "k"}], ")"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"binomialProbability", "[", 
     RowBox[{"totalForPorb", ",", "sucesses", ",", "estProb"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"1", "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"BinomialDistribution", "[", 
        RowBox[{"totalForPorb", ",", "estProb"}], "]"}], ",", 
       RowBox[{"sucesses", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"Probability", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "sucesses"}], ",", 
      RowBox[{"x", "\[Distributed]", 
       RowBox[{"BinomialDistribution", "[", 
        RowBox[{"totalForPorb", ",", "estProb"}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Expectation", "[", 
     RowBox[{"x", ",", 
      RowBox[{"x", "\[Distributed]", 
       RowBox[{"BinomialDistribution", "[", 
        RowBox[{"totalForPorb", ",", "estProb"}], "]"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sucess", "[", "n_", "]"}], ":=", 
     RowBox[{"BinomialDistribution", "[", 
      RowBox[{"n", ",", "estProb"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"DiscretePlot", "[", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{
        RowBox[{"sucess", "[", "totalForPorb", "]"}], ",", "k"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "totalForPorb"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Probability", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sucesses", "-", "4"}], "\[LessEqual]", "x", "\[LessEqual]", 
       RowBox[{"sucesses", "+", "4"}]}], ",", 
      RowBox[{"x", "\[Distributed]", 
       RowBox[{"sucess", "[", "totalForPorb", "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9123356696247244`*^9, 3.9123356721637897`*^9}, {
   3.9123357295109296`*^9, 3.9123357728540754`*^9}, {3.912335877358178*^9, 
   3.9123358888103204`*^9}, 3.9123359561638174`*^9, {3.9123360041594276`*^9, 
   3.9123360288606105`*^9}, {3.912336067074849*^9, 3.912336067933071*^9}, {
   3.9123361956449194`*^9, 3.912336284667987*^9}, {3.912336320383004*^9, 
   3.9123363781174254`*^9}, {3.912336429973114*^9, 3.912336433553167*^9}, {
   3.912336510066925*^9, 3.9123366039535384`*^9}, {3.912336765948769*^9, 
   3.9123367985216646`*^9}, 3.912399255540989*^9, {3.912782730621997*^9, 
   3.912782749892198*^9}, {3.912782835322181*^9, 3.9127828702818985`*^9}, {
   3.912782914281986*^9, 3.912782938327098*^9}, {3.912782996941887*^9, 
   3.912782997592041*^9}, {3.9127830491382875`*^9, 3.9127830515719233`*^9}, {
   3.912783109052371*^9, 3.9127832627521334`*^9}, {3.912783311002386*^9, 
   3.9127833112838035`*^9}, 3.912783743982216*^9, {3.9127837777025337`*^9, 
   3.9127837921025543`*^9}, {3.912783995857538*^9, 3.912783997112729*^9}, {
   3.9127840415324373`*^9, 3.912784057787468*^9}, {3.9127840918873324`*^9, 
   3.9127840998525214`*^9}, {3.912784147892597*^9, 3.912784161042423*^9}, {
   3.9127843503836937`*^9, 3.9127843576025457`*^9}, 3.9127847490278487`*^9, {
   3.9127897790431533`*^9, 3.9127897970720463`*^9}, {3.912790139917739*^9, 
   3.9127901696202946`*^9}, {3.912790274540991*^9, 3.9127902781759977`*^9}, {
   3.9127903913658476`*^9, 3.9127904045580673`*^9}, {3.9127904381393857`*^9, 
   3.9127904406254263`*^9}, 3.912790493630531*^9, {3.9127905928402863`*^9, 
   3.912790595803953*^9}, {3.9127906941363063`*^9, 3.912790699068483*^9}, {
   3.9127908375335536`*^9, 3.912790956442341*^9}, {3.9127910080583687`*^9, 
   3.912791025343566*^9}, {3.912791214623633*^9, 3.9127912362226467`*^9}, {
   3.9127912874735928`*^9, 3.9127912994365606`*^9}, {3.9127945902187777`*^9, 
   3.912794597059119*^9}, {3.912803068141057*^9, 3.9128030854563446`*^9}, {
   3.912804053361372*^9, 3.9128040631247654`*^9}, {3.9128046612016745`*^9, 
   3.912804677231776*^9}, {3.9128050608067408`*^9, 3.912805078291572*^9}, {
   3.9128398166930394`*^9, 3.9128398198268824`*^9}, 3.912840020740366*^9, {
   3.912843397292367*^9, 3.912843404001494*^9}, {3.912859408760149*^9, 
   3.9128594175201735`*^9}, {3.912859563540204*^9, 3.9128595659902887`*^9}, {
   3.912859597550362*^9, 3.912859629880251*^9}, {3.9128596919464536`*^9, 
   3.912859730140458*^9}, {3.9128597918999977`*^9, 3.912859823130201*^9}, {
   3.9128600055003133`*^9, 3.912860026040403*^9}, {3.9128600990753384`*^9, 
   3.912860217297078*^9}, {3.912860251380422*^9, 3.912860253150217*^9}, {
   3.9128607501852293`*^9, 3.912860793590185*^9}, 3.912861578345038*^9, {
   3.9131214213439856`*^9, 3.913121533741287*^9}, {3.9131216232862234`*^9, 
   3.913121672006708*^9}, {3.913121732764473*^9, 3.9131217760453367`*^9}, {
   3.9131411520765486`*^9, 3.9131411581771255`*^9}, {3.9132318424648523`*^9, 
   3.9132318569878793`*^9}, {3.9132318896298566`*^9, 
   3.9132318924336925`*^9}, {3.9132319668719187`*^9, 3.913232087280201*^9}, {
   3.913232135127781*^9, 3.9132321526684732`*^9}, {3.9132322617100267`*^9, 
   3.913232271458657*^9}, {3.9132324589226065`*^9, 3.913232459844531*^9}, {
   3.913232604729063*^9, 3.9132326258955183`*^9}, {3.9132331981309347`*^9, 
   3.913233204895631*^9}, {3.9132333151259575`*^9, 3.9132333185848503`*^9}, 
   3.9132333710062866`*^9, {3.913233469474933*^9, 3.913233505075985*^9}, {
   3.913233714672501*^9, 3.913233778254772*^9}, {3.9132338230286713`*^9, 
   3.9132338649177313`*^9}, {3.9132342410623875`*^9, 3.913234241445651*^9}, {
   3.91323438901248*^9, 3.9132344010372205`*^9}, {3.9132344487366405`*^9, 
   3.9132344688091507`*^9}, {3.913234509463295*^9, 3.9132345307491255`*^9}, {
   3.913234580129298*^9, 3.913234601344535*^9}, {3.913302872594082*^9, 
   3.9133028991598377`*^9}, {3.9242734746008353`*^9, 
   3.9242734752727413`*^9}, {3.9242735354215794`*^9, 3.924273536687172*^9}, 
   3.9242736817194433`*^9, {3.9242737256757245`*^9, 3.924273726441352*^9}, {
   3.92427760464017*^9, 3.9242776059492197`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"6d284da6-0d3c-4fb6-8bc3-eba903ec1a24"]
}, Closed]],

Cell[CellGroupData[{

Cell["Code to generate Gaussian clusters:", "Chapter",
 CellChangeTimes->{{3.9127689970557017`*^9, 3.9127690092658997`*^9}, {
  3.913107954194006*^9, 3.9131079585349617`*^9}, {3.913109043993473*^9, 
  3.913109045925007*^9}, {3.9249551624581165`*^9, 
  3.924955165761873*^9}},ExpressionUUID->"0b0fef12-336f-44f2-9a6d-\
c73f0ad488ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateSample", "[", 
     RowBox[{"means_", ",", " ", "std_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomVariate", "[", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{
         RowBox[{"means", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"std", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "ngenes"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateGaussianNoCrossCorrelated", "[", 
    RowBox[{
    "dataBasinsCenters_", ",", " ", "dataBasinsSigmas_", ",", " ", 
     "dataweights_", " ", ",", " ", 
     RowBox[{"clustered_", ":", " ", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"debug", "=", "False"}], ",", " ", "Simclusters", ",", 
       "nSamplesCluster", ",", "newSimData"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Gerar", " ", "os", " ", "clusters", " ", "com", " ", "o", " ", 
       "n\[UAcute]mero", " ", "de", " ", "amostras", " ", "proporcional"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Simclusters", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"nSamplesCluster", "=", 
           RowBox[{"10", "*", 
            RowBox[{"dataweights", "[", 
             RowBox[{"[", "nClusters", "]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"generateSample", "[", 
             RowBox[{
              RowBox[{"dataBasinsCenters", "[", 
               RowBox[{"[", "nClusters", "]"}], "]"}], ",", 
              RowBox[{"dataBasinsSigmas", "[", 
               RowBox[{"[", "nClusters", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", "nSamplesCluster", "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"nClusters", ",", 
           RowBox[{"Length", "[", "dataweights", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "#", "]"}], "&"}], ",", 
           "Simclusters"}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"newSimData", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Simclusters", ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Dimensions", "[", "newSimData", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"clustered", ",", " ", 
        RowBox[{"Return", "[", "Simclusters", "]"}], ",", " ", 
        RowBox[{"Return", "[", "newSimData", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"covAndMeans", "//", "MatrixForm"}], ",", 
     RowBox[{"covAndMeansSampled", "//", "MatrixForm"}]}], "}"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9123344623855953`*^9, 3.9123344631671014`*^9}, {
   3.912334496985509*^9, 3.9123344971678114`*^9}, {3.912337091713544*^9, 
   3.9123370981109543`*^9}, {3.9123372659819393`*^9, 3.912337272588538*^9}, {
   3.9127852618929844`*^9, 3.9127852626727786`*^9}, {3.912785331864147*^9, 
   3.9127853410646276`*^9}, {3.912785435072877*^9, 3.912785526249359*^9}, {
   3.912785570942336*^9, 3.912785592366076*^9}, {3.9127856231928635`*^9, 
   3.9127856323827877`*^9}, {3.9127858267631826`*^9, 3.912786011952734*^9}, {
   3.9127860690531025`*^9, 3.9127861269979887`*^9}, {3.9127861618231726`*^9, 
   3.9127861662855515`*^9}, 3.9127863254480534`*^9, {3.9127946210442314`*^9, 
   3.912794628618677*^9}, {3.9131081087242627`*^9, 3.9131081102905025`*^9}, {
   3.91310814320254*^9, 3.9131081477637005`*^9}, {3.913109040631538*^9, 
   3.9131090410378*^9}, {3.913562522430978*^9, 3.9135625551440487`*^9}, 
   3.9135656684112396`*^9, {3.9242739290058966`*^9, 3.924273929740282*^9}, {
   3.924274080930291*^9, 3.924274082039697*^9}, {3.9242776189529257`*^9, 
   3.9242776197635803`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"3ec0a3a1-f5c2-4f21-9cda-f0897ca2c43d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Code to load data and compute statistics:", "Chapter",
 CellChangeTimes->{{3.9127824811825547`*^9, 3.9127824862281547`*^9}, {
   3.912786300733096*^9, 3.912786312823225*^9}, {3.9128034044212837`*^9, 
   3.9128034136712656`*^9}, 
   3.924955176349354*^9},ExpressionUUID->"f106c97f-a3be-4127-90de-\
4ae6e11e4301"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", " ", "Definir"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
     " ", "dataset", " ", "de", " ", "refer\[EHat]ncia", " ", "e", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"reordenar", " ", "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}], "--"}], "--"}]}], "-", 
    RowBox[{"-", 
     RowBox[{"-", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sortingReferenceData", "[", "referenceDataClusters_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dataClustersCentroids", ",", " ", "novosIndices"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dataClustersCentroids", " ", "=", " ", 
         RowBox[{"computeCentroids", "[", "referenceDataClusters", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"novosIndices", " ", "=", " ", 
         RowBox[{"Ordering", "[", "dataClustersCentroids", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "novosIndices", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"referenceDataClusters", "[", 
          RowBox[{"[", "novosIndices", "]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"refereceDataclustTotal", "=", 
     RowBox[{"sortingReferenceData", "[", 
      RowBox[{"computeClustersNbC", "[", 
       RowBox[{
        RowBox[{"importData", "[", "]"}], ",", "EuclideanDistance", ",", 
        "postotal"}], "]"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loadAllData", "[", 
      RowBox[{"distanceFunction_", ",", " ", "postotal_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Para", " ", "os", " ", "dados", " ", "totais"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"methodNBCdataclustTotal", "=", 
         RowBox[{"computeClustersNbC", "[", 
          RowBox[{
           RowBox[{"importData", "[", "]"}], ",", "distanceFunction", ",", 
           "postotal"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Aqui", " ", "embaixo", " ", "eu", " ", "estou", " ", "tentando", 
          " ", "ordenar", " ", "os", " ", "dados", " ", "refer\[EHat]ncia", 
          " ", "para", " ", "ficar", " ", "equivalente", " ", "com", " ", 
          "diferentes", " ", "distanceFunction"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"methodNBCdataclustTotal", "=", 
         RowBox[{"orderedDataCluster", "[", 
          RowBox[{
          "methodNBCdataclustTotal", ",", "refereceDataclustTotal", ",", 
           "postotal"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "methodNBCdatabasinsmodeTotal", ",", 
           "methodNBCdatabasinscentersTotal", ",", 
           "methodNBCdatabasinssigmasTotal", ",", "methodNBCdataweightsTotal",
            ",", "methodNBCdataweightspercTotal"}], "}"}], "=", 
         RowBox[{
         "commonCalculations", "[", "methodNBCdataclustTotal", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Paciente", " ", "datapoints_seurat", "_BT", "_S6"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"methodNBCdataclustBTS6", "=", 
         RowBox[{"computeClustersNbC", "[", 
          RowBox[{
           RowBox[{
           "importData", "[", "\"\<datapoints_seurat_BT_S6\>\"", "]"}], ",", 
           "distanceFunction", ",", "postotal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "methodNBCdatabasinsmodeBTS6", ",", 
           "methodNBCdatabasinscentersBTS6", ",", 
           "methodNBCdatabasinssigmasBTS6", ",", "methodNBCdataweightsBTS6", 
           ",", "methodNBCdataweightspercBTS6"}], "}"}], "=", 
         RowBox[{"commonCalculations", "[", "methodNBCdataclustBTS6", "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Paciente", " ", "datapoints_seurat", "_BT", "_S4"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"methodNBCdataclustBTS4", "=", 
         RowBox[{"computeClustersNbC", "[", 
          RowBox[{
           RowBox[{
           "importData", "[", "\"\<datapoints_seurat_BT_S4\>\"", "]"}], ",", 
           "distanceFunction", ",", "postotal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "methodNBCdatabasinsmodeBTS4", ",", 
           "methodNBCdatabasinscentersBTS4", ",", 
           "methodNBCdatabasinssigmasBTS4", ",", "methodNBCdataweightsBTS4", 
           ",", "methodNBCdataweightspercBTS4"}], "}"}], "=", 
         RowBox[{"commonCalculations", "[", "methodNBCdataclustBTS4", "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Paciente", " ", "datapoints_seurat", "_BT", "_S1"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"methodNBCdataclustBTS1", "=", 
         RowBox[{"computeClustersNbC", "[", 
          RowBox[{
           RowBox[{
           "importData", "[", "\"\<datapoints_seurat_BT_S1\>\"", "]"}], ",", 
           "distanceFunction", ",", "postotal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "methodNBCdatabasinsmodeBTS1", ",", 
           "methodNBCdatabasinscentersBTS1", ",", 
           "methodNBCdatabasinssigmasBTS1", ",", "methodNBCdataweightsBTS1", 
           ",", "methodNBCdataweightspercBTS1"}], "}"}], "=", 
         RowBox[{"commonCalculations", "[", "methodNBCdataclustBTS1", "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Paciente", " ", "datapoints_seurat", "_BT", "_S2"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"methodNBCdataclustBTS2", "=", 
         RowBox[{"computeClustersNbC", "[", 
          RowBox[{
           RowBox[{
           "importData", "[", "\"\<datapoints_seurat_BT_S2\>\"", "]"}], ",", 
           "distanceFunction", ",", "postotal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "methodNBCdatabasinsmodeBTS2", ",", 
           "methodNBCdatabasinscentersBTS2", ",", 
           "methodNBCdatabasinssigmasBTS2", ",", "methodNBCdataweightsBTS2", 
           ",", "methodNBCdataweightspercBTS2"}], "}"}], "=", 
         RowBox[{"commonCalculations", "[", "methodNBCdataclustBTS2", "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"datapoints_seurat", " ", "_Regular"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"methodNBCdataclustAllRegularCells", "=", 
         RowBox[{"computeClustersNbC", "[", 
          RowBox[{
           RowBox[{
           "importData", "[", "\"\<datapoints_seurat_Regular\>\"", "]"}], ",",
            "distanceFunction", ",", "postotal"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "methodNBCdatabasinsmodeAllRegularCells", ",", 
           "methodNBCdatabasinscentersAllRegularCells", ",", 
           "methodNBCdatabasinssigmasAllRegularCells", ",", 
           "methodNBCdataweightsAllRegularCells", ",", 
           "methodNBCdataweightspercAllRegularCells"}], "}"}], "=", 
         RowBox[{
         "commonCalculations", "[", "methodNBCdataclustAllRegularCells", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"random", " ", "generated", " ", "data"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"methodNBCsimRandomGaussclust", "=", 
         RowBox[{"computeClustersNbC", "[", 
          RowBox[{
           RowBox[{"generateGaussianNoCrossCorrelated", "[", 
            RowBox[{
            "methodNBCdatabasinscentersTotal", ",", 
             "methodNBCdatabasinssigmasTotal", ",", 
             "methodNBCdataweightsTotal"}], "]"}], ",", "distanceFunction", 
           ",", "postotal"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "methodNBCsimRandomGaussbasinsmode", ",", 
           "methodNBCsimRandomGaussbasinscenters", ",", 
           "methodNBCsimRandomGaussbasinssigmas", ",", 
           "methodNBCsimRandomGaussweights", ",", 
           "methodNBCsimRandomGaussweightsperc"}], "}"}], "=", 
         RowBox[{
         "commonCalculations", "[", "methodNBCsimRandomGaussclust", "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"clustersAndMarkersStatistics", "[", 
     RowBox[{
     "methodNBCdatabasinscentersTotal_", ",", 
      "methodNBCdatabasinssigmasTotal_", ",", "postotal_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numberOfClusters", ",", "markerGenes", ",", "meansAndStds"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfClusters", " ", "=", " ", 
        RowBox[{"Length", "[", "methodNBCdatabasinscentersTotal", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"markerGenes", "=", 
        RowBox[{"postotal", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"meansAndStds", "=", 
        RowBox[{"Dataset", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<Cluster\>\"", "->", " ", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<Gene\>\"", "->", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<Xbar\>\"", "->", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                 RowBox[{"\"\<sigma\>\"", "->", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}]}], "|>"}], "&"}], ",", 
              RowBox[{"Thread", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"letters", "[", "numberOfClusters", "]"}], "[", 
                    RowBox[{"[", "nCluster", "]"}], "]"}], ",", "3"}], "]"}], 
                 ",", 
                 RowBox[{"names", "[", 
                  RowBox[{"[", "markerGenes", "]"}], "]"}], ",", 
                 RowBox[{"methodNBCdatabasinscentersTotal", "[", 
                  RowBox[{"[", 
                   RowBox[{"nCluster", ",", "markerGenes"}], "]"}], "]"}], 
                 ",", " ", 
                 RowBox[{"methodNBCdatabasinssigmasTotal", "[", 
                  RowBox[{"[", 
                   RowBox[{"nCluster", ",", "markerGenes"}], "]"}], "]"}]}], 
                "}"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nCluster", ",", "numberOfClusters"}], "}"}]}], "]"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<meansAndStds0.xlsx\>\"", ",", " ", "meansAndStds"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.912783335296069*^9, 3.9127833719422064`*^9}, {
   3.9127835065424356`*^9, 3.9127835138961835`*^9}, {3.9127835984721117`*^9, 
   3.9127835987723117`*^9}, {3.9127836659724617`*^9, 
   3.9127836729454265`*^9}, {3.9127845754889927`*^9, 
   3.9127846029029236`*^9}, {3.912784648278675*^9, 3.912784672292717*^9}, {
   3.91278493169737*^9, 3.9127849457874603`*^9}, {3.9127851425076675`*^9, 
   3.912785144277856*^9}, {3.912785198952566*^9, 3.9127851997526164`*^9}, {
   3.912786513703086*^9, 3.912786534933819*^9}, 3.912791442387992*^9, {
   3.912791673647772*^9, 3.912791674028061*^9}, {3.9127922715783887`*^9, 
   3.912792289287984*^9}, {3.9127923495184193`*^9, 3.91279247624835*^9}, {
   3.912792618848091*^9, 3.912792640188173*^9}, {3.9127958172690883`*^9, 
   3.9127958813392925`*^9}, 3.912796843784504*^9, {3.9128022424259806`*^9, 
   3.9128022908311462`*^9}, {3.9135608439476385`*^9, 3.913560844367266*^9}, {
   3.913618036136553*^9, 3.9136180640281854`*^9}, {3.9136181132336073`*^9, 
   3.9136181315886574`*^9}, {3.913618166624883*^9, 3.9136182822858033`*^9}, {
   3.9171829721154404`*^9, 3.91718297304739*^9}, {3.917183033756753*^9, 
   3.917183048264974*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"50007df6-40c0-45e1-b7b4-a0eb4822d9af"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Code to assess the impact of using different distance metrics:\
\>", "Chapter",
 CellChangeTimes->{{3.9136199640655737`*^9, 3.913619976277776*^9}, 
   3.9249551908222723`*^9},ExpressionUUID->"ab60a066-36b1-42e4-91d1-\
4311dcb254a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"datasetForVerificationOfDifferences", "[", 
     RowBox[{"refereceDataclustTotal_", ",", "postotal_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "refff", ",", "euccc", ",", "manhhh", ",", "diiff0", ",", "difff1", 
        ",", "datasetForDifferences"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"refff", " ", "=", " ", 
        RowBox[{"computeCentroids", "[", "refereceDataclustTotal", "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"euccc", " ", "=", " ", 
        RowBox[{"computeClustersNbC", "[", 
         RowBox[{
          RowBox[{"importData", "[", "]"}], ",", "EuclideanDistance", ",", 
          "postotal"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"euccc", " ", "=", " ", 
        RowBox[{"orderedDataCluster", "[", 
         RowBox[{
         "euccc", " ", ",", "refereceDataclustTotal", ",", "postotal"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"euccc", " ", "=", " ", 
        RowBox[{
        "computeCentroids", "[", "methodNBCdataclustTotalEuc", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"manhhh", " ", "=", " ", 
        RowBox[{"computeClustersNbC", "[", 
         RowBox[{
          RowBox[{"importData", "[", "]"}], ",", "ManhattanDistance", ",", 
          "postotal"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"manhhh", " ", "=", " ", 
        RowBox[{"orderedDataCluster", "[", 
         RowBox[{
         "manhhh", " ", ",", "refereceDataclustTotal", ",", "postotal"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"manhhh", " ", "=", " ", 
        RowBox[{"computeCentroids", "[", "manhhh", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"diiff0", " ", "=", " ", 
        RowBox[{"refff", " ", "-", " ", "euccc"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"difff1", " ", "=", " ", 
        RowBox[{"euccc", " ", "-", " ", "manhhh"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"datasetForDifferences", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Cluster\>\"", "->", 
             RowBox[{"numberToCapitalLetter", "[", "i", "]"}]}], ",", 
            RowBox[{"\"\<Max\>\"", "->", 
             RowBox[{"Max", "[", 
              RowBox[{"difff1", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"\"\<|Min|\>\"", "->", 
             RowBox[{"Abs", "[", 
              RowBox[{"Min", "[", 
               RowBox[{"difff1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"\"\<|Mean|\>\"", "->", 
             RowBox[{"Abs", "[", 
              RowBox[{"Mean", "[", 
               RowBox[{"difff1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], "|>"}], ",",
           " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "difff1", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"datasetForDifferences", " ", "=", " ", 
        RowBox[{"Dataset", "[", "datasetForDifferences", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
        "\"\<datasetForDifferences.xlsx\>\"", ",", "datasetForDifferences"}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"datasetForVerificationOfDifferences", "[", 
    RowBox[{"refereceDataclustTotal", ",", "postotal"}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9136185195099487`*^9, 3.9136185278009996`*^9}, {
   3.9136186327668076`*^9, 3.9136187186824455`*^9}, {3.913618804352599*^9, 
   3.9136188191275873`*^9}, {3.9136190318562326`*^9, 3.913619112169156*^9}, {
   3.9136191468378787`*^9, 3.913619464610092*^9}, {3.9136195215188737`*^9, 
   3.9136195807824087`*^9}, {3.913619667220482*^9, 3.9136198074411535`*^9}, {
   3.9136198882856474`*^9, 3.913619888603609*^9}, 3.913619952317484*^9, {
   3.9136200188006897`*^9, 3.913620021073135*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"461517f9-14bd-4d6f-a01e-9912cfe0e328"]
}, Closed]],

Cell[CellGroupData[{

Cell["Code to select cluster statistics and estimate parameters:", "Chapter",
 CellChangeTimes->{{3.912850461304228*^9, 3.9128504680393643`*^9}, {
   3.91285213963839*^9, 3.912852147646529*^9}, {3.9128524148746085`*^9, 
   3.912852425947854*^9}, {3.912873760838052*^9, 3.9128737609678507`*^9}, {
   3.9131365491556354`*^9, 3.9131365612929645`*^9}, 3.917086772249905*^9, 
   3.92495520264187*^9},ExpressionUUID->"e1711504-8305-4760-8513-\
929ab11da781"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"selectedClustersStatistics", "[", 
     RowBox[{"newVariablesFromSelectedCLusters_", ",", "selectingClusters_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temporaryList", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "temporaryList", " ", "=", " ", "newVariablesFromSelectedCLusters"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"temporaryList", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "selectingClusters", "]"}], "]"}], "&"}], ",", 
          "temporaryList"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "temporaryList", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calcMs0Matrix", "[", 
     RowBox[{
     "kState_", ",", "state_", ",", "numClusters_", ",", "numGenes_"}], "]"}],
     ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"kState", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"state", "[", 
        RowBox[{"[", 
         RowBox[{"cms", ",", "i"}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"cms", ",", "1", ",", "numClusters"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calcActivationMatrix", "[", 
     RowBox[{
     "state_", ",", "nestValues_", ",", "s_", ",", " ", "activationMatrix_", 
      ",", "numClusters_", ",", "numGenes_", ",", "onesMatrix_", ",", 
      "identityMatrix_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "activation", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"activation", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"state", "[", 
                RowBox[{"[", 
                 RowBox[{"cAM", ",", "j"}], "]"}], "]"}], "^", "nestValues"}],
               "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"s", "^", "nestValues"}], "+", 
                RowBox[{
                 RowBox[{"state", "[", 
                  RowBox[{"[", 
                   RowBox[{"cAM", ",", "j"}], "]"}], "]"}], "^", 
                 "nestValues"}], "+", "io"}], ")"}]}], ")"}], "*", 
            RowBox[{"activationMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{"+", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"i", "==", "23"}], "&&", 
                RowBox[{"j", "==", "1"}]}], ",", 
               RowBox[{"0.9", "*", 
                RowBox[{"state", "[", 
                 RowBox[{"[", 
                  RowBox[{"cAM", ",", "i"}], "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"i", "==", "14"}], "&&", 
                RowBox[{"j", "==", "1"}]}], ",", " ", 
               RowBox[{"0.76", "*", 
                RowBox[{"state", "[", 
                 RowBox[{"[", 
                  RowBox[{"cAM", ",", "i"}], "]"}], "]"}]}], ",", "True", ",",
                " ", "0"}], "]"}]}], "*)"}], ",", 
           RowBox[{"{", 
            RowBox[{"cAM", ",", "1", ",", "numClusters"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "numGenes"}], "}"}]}], "]"}], " ", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "\[Rule]", " ", "1"}], ",", " ", 
           RowBox[{"sa", "\[Rule]", " ", "1"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"activation", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"activation", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", "onesMatrix"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "numClusters"}], "}"}]}], "]"}], " ", 
         "/.", 
         RowBox[{"{", 
          RowBox[{"io", "\[Rule]", " ", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"activation", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"activation", "[", 
           RowBox[{"[", 
            RowBox[{"ca", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ca", ",", "1", ",", "numClusters"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"activation", "[", 
           RowBox[{"[", "caf", "]"}], "]"}], "*", "identityMatrix"}], ",", 
         RowBox[{"{", 
          RowBox[{"caf", ",", "1", ",", "numClusters"}], "}"}]}], "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calcInhibitionMatrix", "[", 
     RowBox[{
     "state_", ",", "nestValues_", ",", "s_", ",", "inhibitionMatrix_", ",", 
      "numClusters_", ",", "numGenes_", ",", "onesMatrix_", ",", 
      "identityMatrix_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "inhibition", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inhibition", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"s", "^", "nestValues"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"s", "^", "nestValues"}], "+", 
                RowBox[{
                 RowBox[{"state", "[", 
                  RowBox[{"[", 
                   RowBox[{"cNM", ",", "j"}], "]"}], "]"}], "^", 
                 "nestValues"}], "+", "io"}], ")"}]}], ")"}], "*", 
            RowBox[{"inhibitionMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"cNM", ",", "1", ",", "numClusters"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "numGenes"}], "}"}]}], "]"}], " ", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"b", "\[Rule]", " ", "1"}], ",", " ", 
           RowBox[{"sb", "\[Rule]", " ", "1"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"inhibition", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"inhibition", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ".", "onesMatrix"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "numClusters"}], "}"}]}], "]"}], " ", 
         "/.", 
         RowBox[{"{", 
          RowBox[{"io", "\[Rule]", " ", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"inhibition", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"inhibition", "[", 
           RowBox[{"[", 
            RowBox[{"cb", ",", "i"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"cb", ",", "1", ",", "numClusters"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"inhibition", "[", 
           RowBox[{"[", "cbf", "]"}], "]"}], "*", "identityMatrix"}], ",", 
         RowBox[{"{", 
          RowBox[{"cbf", ",", "1", ",", "numClusters"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "to", " ", "join", " ", "activation", " ", "and", " ", 
    "inhibition", " ", "matrices", " ", "horizontally"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mergeMatricesHorizontally", "[", 
     RowBox[{
     "activationMatrix_", ",", "inhibitionMatrix_", ",", "numClusters_"}], 
     "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"activationMatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"inhibitionMatrix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "numClusters"}], "}"}]}], "]"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "to", " ", "solve", " ", "the", " ", "linear", " ", 
    "programming", " ", "problem"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solveLinearProgramming", "[", 
     RowBox[{
     "cVector_", ",", "AMatrix_", ",", "bVector_", ",", "lowerBoundVector_"}],
      "]"}], ":=", 
    RowBox[{"LinearProgramming", "[", 
     RowBox[{
     "cVector", ",", "AMatrix", ",", "bVector", ",", "lowerBoundVector", ",", 
      "Reals", ",", 
      RowBox[{"Method", "->", "\"\<Simplex\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"parametersEstimation", "[", 
     RowBox[{
     "variablesList_", ",", " ", "parSinputs_", ",", "parNinputs_", ",", " ", 
      "parsLimits_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dataclust", ",", "databasinscenters", ",", "databasinssigmas", ",", 
        "dataweights", ",", "\[IndentingNewLine]", "minSvalues", ",", 
        "maxSfortest", ",", " ", "stepSvalues", ",", "minNvalues", ",", 
        "maxNfortest", ",", " ", "stepNvalues", ",", 
        "numberOfLoopRepetitions", ",", "infLim", ",", " ", "supLim", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"parlist", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"reslist", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"restlist", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"maxreslist", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"parauxlist", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "numGenes", ",", 
        "kstate", ",", "testdata", ",", "numClusters", ",", "state", ",", " ",
         "id", ",", " ", "ones", ",", " ", "amatrix", ",", "bmatrix", ",", 
        " ", "maResult", ",", " ", "mbResult", ",", "ms0Result", ",", " ", 
        "m00Result", ",", "m", ",", " ", "ms", ",", "\[IndentingNewLine]", 
        " ", "m0", ",", "n0", ",", "lb", ",", "AT", ",", "B", ",", "Aall", 
        ",", "ball", ",", "cVar", ",", "solv0Result", ",", " ", "drop"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "dataclust", ",", "databasinscenters", ",", "databasinssigmas", ",", 
          "dataweights"}], "}"}], "=", "variablesList"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"minSvalues", ",", "maxSfortest", ",", " ", "stepSvalues"}], 
         "}"}], "=", "parSinputs"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"minNvalues", ",", "maxNfortest", ",", " ", "stepNvalues"}], 
         "}"}], "=", "parNinputs"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"infLim", ",", " ", "supLim"}], "}"}], "=", "parsLimits"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"numberOfLoopRepetitions", " ", "=", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"minSvalues", ",", "maxSfortest", ",", "stepSvalues"}], 
           "]"}], "]"}], " ", "*", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"minNvalues", ",", "maxNfortest", ",", "stepNvalues"}], 
           "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"numGenes", " ", "=", " ", "ngenes"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kstate", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", "numGenes"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"testdata", "=", "databasinscenters"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numClusters", "=", 
        RowBox[{"Length", "[", "testdata", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"testdata", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numClusters"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"id", "=", 
        RowBox[{"IdentityMatrix", "[", "numGenes", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ones", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Compute", " ", "amatrix", " ", "and", " ", "bmatrix"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"amatrix", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Round", "[", 
            RowBox[{"gamatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"2", ";;"}], ",", 
               RowBox[{"1", ";;"}]}], "]"}], "]"}], "]"}], "]"}], "*", 
          RowBox[{"(", "a", ")"}]}], "+", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"gamatrix", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"2", ";;"}], ",", 
              RowBox[{"1", ";;"}]}], "]"}], "]"}], "]"}], "*", 
          RowBox[{"IdentityMatrix", "[", "numGenes", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"sa", "-", "a"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"bmatrix", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Round", "[", 
            RowBox[{"gbmatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"2", ";;"}], ",", 
               RowBox[{"1", ";;"}]}], "]"}], "]"}], "]"}], "]"}], "*", 
          RowBox[{"(", "b", ")"}]}], "+", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"gbmatrix", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"2", ";;"}], ",", 
              RowBox[{"1", ";;"}]}], "]"}], "]"}], "]"}], "*", 
          RowBox[{"IdentityMatrix", "[", "numGenes", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"sb", "-", "b"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ms0Result", "=", 
        RowBox[{"calcMs0Matrix", "[", 
         RowBox[{
         "kstate", ",", "state", ",", "numClusters", ",", "numGenes"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ms", "=", 
        RowBox[{"Join", "@@", "ms0Result"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"indexNumberOfLoopRepetitions", "=", "0"}], ";", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"indexNumberOfLoopRepetitions", "=", 
                RowBox[{"indexNumberOfLoopRepetitions", "+", "1"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Calculate", " ", "maResult"}], ",", "mbResult", ",",
                  "m00Result", ",", "ms0Result"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"maResult", "=", 
                RowBox[{"calcActivationMatrix", "[", 
                 RowBox[{
                 "state", ",", "nest", ",", "sest", ",", "amatrix", ",", 
                  "numClusters", ",", "numGenes", ",", "ones", ",", "id"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"mbResult", "=", 
                RowBox[{"calcInhibitionMatrix", "[", 
                 RowBox[{
                 "state", ",", "nest", ",", "sest", ",", "bmatrix", ",", 
                  "numClusters", ",", "numGenes", ",", "ones", ",", "id"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"m00Result", "=", 
                RowBox[{"mergeMatricesHorizontally", "[", 
                 RowBox[{"maResult", ",", "mbResult", ",", "numClusters"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"m", "=", 
                RowBox[{"Join", "@@", "m00Result"}]}], ";", "\n", 
               "                           ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m0", ",", "n0"}], "}"}], "=", 
                RowBox[{"Dimensions", "[", "m", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"lb", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"infLim", ",", "supLim"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m0", "+", "n0"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AT", "=", 
                RowBox[{"Transpose", "[", "m", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"B", "=", 
                RowBox[{"SparseArray", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i_", ",", "i_"}], "}"}], "->", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m0", ",", "m0"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Aall", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"B", ",", 
                    RowBox[{"-", "AT"}]}], "]"}], "]"}], ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"B", ",", "AT"}], "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"ball", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"-", "ms"}], ",", "ms"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"cVar", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{"1", ",", 
                    RowBox[{"{", "m0", "}"}]}], "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", "n0", "}"}]}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Solve", " ", "linear", " ", "programming", " ", "problem"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{"solv0Result", "=", 
                RowBox[{"solveLinearProgramming", "[", 
                 RowBox[{"cVar", ",", "Aall", ",", "ball", ",", "lb"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Drop", " ", "first", " ", 
                  RowBox[{"(", 
                   RowBox[{"nclusters", "*", "ngenes"}], ")"}]}], "+", 
                 RowBox[{
                 "1", " ", "elements", " ", "and", " ", "append", " ", 
                  "results", " ", "to", " ", "lists"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"drop", "=", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"numClusters", "*", "numGenes"}], ")"}], "+", 
                 "1"}]}], ";", "\[IndentingNewLine]", "\n", "\t      ", 
               RowBox[{"parlist", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"parlist", ",", 
                  RowBox[{"solv0Result", "[", 
                   RowBox[{"[", 
                    RowBox[{"drop", ";;"}], "]"}], "]"}]}], "]"}]}], ";", 
               "\n", "\t      ", 
               RowBox[{"reslist", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"reslist", ",", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"m", ".", 
                    RowBox[{"solv0Result", "[", 
                    RowBox[{"[", 
                    RowBox[{"drop", ";;"}], "]"}], "]"}]}], "-", "ms"}], 
                   "]"}]}], "]"}]}], ";", "\n", "\t      ", 
               RowBox[{"restlist", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"restlist", ",", 
                  RowBox[{"Total", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"m", ".", 
                    RowBox[{"solv0Result", "[", 
                    RowBox[{"[", 
                    RowBox[{"drop", ";;"}], "]"}], "]"}]}], "-", "ms"}], 
                    "]"}], "]"}]}], "]"}]}], ";", "\n", "               ", 
               RowBox[{"maxreslist", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"maxreslist", ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"m", ".", 
                    RowBox[{"solv0Result", "[", 
                    RowBox[{"[", 
                    RowBox[{"drop", ";;"}], "]"}], "]"}]}], "-", "ms"}], 
                    "]"}], "]"}]}], "]"}]}], ";", "\n", "\t      ", 
               RowBox[{"parauxlist", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"parauxlist", ",", 
                  RowBox[{"{", 
                   RowBox[{"nest", ",", "sest"}], "}"}]}], "]"}]}], ";"}], 
              "\[IndentingNewLine]", "\n", " ", ",", 
              RowBox[{"{", 
               RowBox[{
               "sest", ",", "minSvalues", ",", "maxSfortest", ",", 
                "stepSvalues"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "nest", ",", "minNvalues", ",", "maxNfortest", ",", 
              "stepNvalues"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"ProgressIndicator", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "indexNumberOfLoopRepetitions", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "numberOfLoopRepetitions"}], "}"}]}], "]"}]}], 
        "]"}], ";", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "parlist", ",", "reslist", ",", "restlist", ",", "maxreslist", ",", 
          "parauxlist"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\t"}]}], "Input",
 CellChangeTimes->{{3.912850469766491*^9, 3.9128504697944546`*^9}, {
  3.9128521499642572`*^9, 3.9128521637675247`*^9}, {3.9128523894943776`*^9, 
  3.912852393112093*^9}, {3.912852461888982*^9, 3.912852487485573*^9}, {
  3.9128525405093193`*^9, 3.9128525448795238`*^9}, {3.912852580760233*^9, 
  3.9128526195743637`*^9}, {3.9128526511040945`*^9, 3.912852970014471*^9}, {
  3.912853017014699*^9, 3.912853107604233*^9}, {3.9128531440195293`*^9, 
  3.9128531544793653`*^9}, {3.9128531873592577`*^9, 3.912853220178482*^9}, {
  3.9128534682383413`*^9, 3.912853468694418*^9}, {3.912854103034413*^9, 
  3.9128541032475505`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"a18e9766-4dff-40d6-a8bb-5019da88809b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Code to run simulations and redefine potential activation functions:\
\>", "Chapter",
 CellChangeTimes->{{3.9128541138477983`*^9, 3.912854120166196*^9}, {
   3.9128542452047567`*^9, 3.9128542453305345`*^9}, {3.9128543839347067`*^9, 
   3.912854389930151*^9}, 
   3.9249552128930435`*^9},ExpressionUUID->"2fd5e788-a3d7-4c1b-ad32-\
a7eb65471e90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NewActivationFunction", "[", 
      RowBox[{
      "state_", ",", "activationMatrix_", ",", "numGenes_", ",", 
       "nestValues_", ",", " ", "s_", ",", "firstParEst_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "activation", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"activation", "=", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"firstParEst", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"state", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "^", "nestValues"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "^", "nestValues"}], "+", 
                 RowBox[{
                  RowBox[{"state", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "^", "nestValues"}], "+", 
                 "io"}], ")"}]}], ")"}], "*", 
             RowBox[{"activationMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "\[IndentingNewLine]",
             ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "numGenes"}], "}"}]}], "]"}], "/.", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a", "->", "1"}], ",", 
            RowBox[{"sa", "->", "1"}], ",", 
            RowBox[{"io", "\[Rule]", " ", "0"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "activation"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NewInhibitionFunction", "[", 
      RowBox[{
      "state_", ",", "inhibitionMatrix_", ",", "numGenes_", ",", 
       "nestValues_", ",", " ", "s_", ",", "firstParEst_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "inhibition", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inhibition", "=", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"firstParEst", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "numGenes"}], "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "^", "nestValues"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "^", "nestValues"}], "+", 
                 RowBox[{
                  RowBox[{"state", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "^", "nestValues"}], "+", 
                 "io"}], ")"}]}], ")"}], "*", 
             RowBox[{"inhibitionMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "numGenes"}], "}"}]}], "]"}], "/.", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b", "->", "1"}], ",", 
            RowBox[{"sb", "->", "1"}], ",", 
            RowBox[{"io", "\[Rule]", " ", "0"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "inhibition"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"runSimulation", "[", 
     RowBox[{
     "auxParSetNumber_", ",", "firstParslist_", ",", "secondParsList_", ",", 
      "parauxlist_", ",", "selectedNoiseFactor_", ",", 
      "initialCoNditionValues_", ",", "maResultIn_", ",", " ", "mbResultIn_", 
      ",", 
      RowBox[{"exportPlots_", ":", "False"}], ",", " ", 
      RowBox[{"simDuration_", ":", "50"}], ",", " ", 
      RowBox[{"simStep_", ":", "0.1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"debug", " ", "=", " ", "False"}], ",", "numGenes", ",", " ", 
        "amatrix", ",", "bmatrix", ",", "kstate", ",", "ms", ",", 
        RowBox[{"(*", 
         RowBox[{"noiseMultiplicativeFactor", ",", " ", 
          RowBox[{"pq", " ", "isso", " ", "precisa", " ", "ser", " ", 
           RowBox[{"global", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
        "statelistForStochSim", ",", "derStateDynamicsModel", ",", 
        "diffElementsForStochModel", ",", "itoStochasticProcess", ",", 
        "deltaTimeStep", ",", "timeForStochSim", ",", "\[IndentingNewLine]", 
        "fisrtPars", ",", "secondPars", ",", "nest", ",", "s", ",", 
        "noisefactor", ",", "maResult", ",", "mbResult", ",", "m", ",", 
        "drivenForce", ",", "systemDynamicsDiffEqs", ",", 
        "\[IndentingNewLine]", "eqsToStochasticSim", ",", 
        "stochsSimulationresults", ",", "maxamostra", ",", "plots", ",", 
        "hist0", ",", "hist00", ",", "hist000", ",", "\[IndentingNewLine]", 
        "stochasticProc", ",", "stochRandomFunction", ",", "resultado", ",", 
        "resultado0", ",", "resultado00", ",", "exportplot"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<simDuration: \>\"", ",", " ", "simDuration", ",", " ", 
           "\"\<; simStep: \>\"", ",", " ", "simStep", ",", " ", 
           "\"\<; noisefactor: \>\"", ",", " ", "selectedNoiseFactor", ",", 
           " ", "\"\<; Method: \>\"", ",", " ", "\"\<Euler\>\""}], 
          RowBox[{"(*", "\"\<StochasticRungeKutta\>\"", "*)"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fisrtPars", " ", "=", " ", 
        RowBox[{"firstParslist", "[", 
         RowBox[{"[", "auxParSetNumber", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"secondPars", " ", "=", " ", 
        RowBox[{"secondParsList", "[", 
         RowBox[{"[", "auxParSetNumber", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nest", "=", 
        RowBox[{"parauxlist", "[", 
         RowBox[{"[", 
          RowBox[{"auxParSetNumber", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"parauxlist", "[", 
         RowBox[{"[", 
          RowBox[{"auxParSetNumber", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"noisefactor", "=", "selectedNoiseFactor"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"numGenes", " ", "=", " ", "ngenes"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<x\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<[t]\>\""}], "]"}],
           ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"amatrix", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Round", "[", 
            RowBox[{"gamatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"2", ";;"}], ",", 
               RowBox[{"1", ";;"}]}], "]"}], "]"}], "]"}], "]"}], "*", 
          RowBox[{"(", "a", ")"}]}], "+", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"gamatrix", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"2", ";;"}], ",", 
              RowBox[{"1", ";;"}]}], "]"}], "]"}], "]"}], "*", 
          RowBox[{"IdentityMatrix", "[", "numGenes", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"sa", "-", "a"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"bmatrix", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Round", "[", 
            RowBox[{"gbmatrix", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"2", ";;"}], ",", 
               RowBox[{"1", ";;"}]}], "]"}], "]"}], "]"}], "]"}], "*", 
          RowBox[{"(", "b", ")"}]}], "+", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"gbmatrix", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", 
              RowBox[{"2", ";;"}], ",", 
              RowBox[{"1", ";;"}]}], "]"}], "]"}], "]"}], "*", 
          RowBox[{"IdentityMatrix", "[", "numGenes", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"sb", "-", "b"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"maResult", "=", 
        RowBox[{"maResultIn", "[", 
         RowBox[{
         "state", ",", "amatrix", ",", "numGenes", ",", "nest", ",", "s", ",",
           "fisrtPars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mbResult", "=", 
        RowBox[{"mbResultIn", "[", 
         RowBox[{
         "state", ",", "bmatrix", ",", "numGenes", ",", "nest", ",", "s", ",",
           "fisrtPars"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"kstate", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"1", ",", "numGenes"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"ms", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"kstate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"state", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       " ", 
       RowBox[{"(*", " ", "kpar", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"m", "   ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"maResult", ",", "mbResult", ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"drivenForce", "=", 
        RowBox[{
         RowBox[{"m", ".", "secondPars"}], " ", "-", " ", "ms"}]}], " ", ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"derStateDynamicsModel", "=", 
        RowBox[{"Dt", "[", 
         RowBox[{"state", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"systemDynamicsDiffEqs", "=", 
        RowBox[{"derStateDynamicsModel", "\[Equal]", "drivenForce"}]}], " ", 
       ";", "\[IndentingNewLine]", 
       RowBox[{"diffElementsForStochModel", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<\[DifferentialD] x\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<[t]\>\""}], "]"}],
           ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"noiseMultiplicativeFactor", " ", "=", "noisefactor"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqsToStochasticSim", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"diffElementsForStochModel", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"systemDynamicsDiffEqs", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}], ")"}], " ", 
             RowBox[{
             "ToExpression", "[", "\"\<\[DifferentialD] t\>\"", "]"}]}], "+", 
            " ", 
            RowBox[{"ToExpression", "[", 
             RowBox[{
             "\"\<state[[i]]\>\"", "<>", 
              "\"\<noiseMultiplicativeFactor \[DifferentialD] w\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<[t]\>\""}], 
             "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"maxamostra", "=", 
        RowBox[{"Length", "[", "initialCoNditionValues", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plots", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hist0", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hist00", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hist000", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaTimeStep", " ", "=", " ", "simStep"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"timeForStochSim", "=", "simDuration"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"statelistForStochSim", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<x\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"itoStochasticProcess", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<w\>\"", "<>", 
            RowBox[{"ToString", "[", "l", "]"}], "<>", 
            "\"\<\[Distributed]WienerProcess[]\>\""}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "numGenes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"indexNumberOfLoopRepetitions", "=", "0"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"stochsSimulationresults", "=", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"indexNumberOfLoopRepetitions", "=", 
              RowBox[{"indexNumberOfLoopRepetitions", "+", "1"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"stochasticProc", "=", 
              RowBox[{"ItoProcess", "[", 
               RowBox[{"eqsToStochasticSim", ",", "state", ",", 
                RowBox[{"{", 
                 RowBox[{"statelistForStochSim", ",", 
                  RowBox[{"initialCoNditionValues", "[", 
                   RowBox[{"[", "amostra", "]"}], "]"}]}], "}"}], ",", "t", 
                ",", "itoStochasticProcess"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"stochRandomFunction", "=", 
              RowBox[{"RandomFunction", "[", 
               RowBox[{"stochasticProc", ",", 
                RowBox[{"{", 
                 RowBox[{"0.", ",", "timeForStochSim", ",", "deltaTimeStep"}],
                  "}"}]}], 
               RowBox[{"(*", 
                RowBox[{",", 
                 RowBox[{
                 "Method", "\[Rule]", "\"\<StochasticRungeKutta\>\""}]}], 
                "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"resultado", "=", 
              RowBox[{
               RowBox[{"Normal", "[", "stochRandomFunction", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"resultado0", "=", 
              RowBox[{
               RowBox[{"Normal", "[", "stochRandomFunction", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Round", "[", 
                    RowBox[{"timeForStochSim", "/", "2"}], "]"}], ")"}], "/", 
                  "deltaTimeStep"}], ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"resultado00", "=", 
              RowBox[{
               RowBox[{"Normal", "[", "stochRandomFunction", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Round", "[", 
                    RowBox[{"timeForStochSim", "/", "10"}], "]"}], ")"}], "/",
                   "deltaTimeStep"}], ",", "2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"exportPlots", ",", 
               RowBox[{
                RowBox[{"exportplot", "=", 
                 RowBox[{
                  RowBox[{"Normal", "[", "stochRandomFunction", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", ";;", ",", "2"}], "]"}], "]"}]}], ";", 
                " ", 
                RowBox[{"{", 
                 RowBox[{
                 "resultado", ",", "resultado0", ",", "resultado00", ",", 
                  "exportplot"}], "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"resultado", ",", "resultado0", ",", "resultado00"}], 
                "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"amostra", ",", "1", ",", "maxamostra"}], "}"}]}], "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "indexNumberOfLoopRepetitions", "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "maxamostra"}], "}"}]}], "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hist0", ",", "hist00", ",", "hist000"}], "}"}], "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"stochsSimulationresults", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", 
            RowBox[{";;", "3"}]}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"exportPlots", ",", 
         RowBox[{
          RowBox[{"plots", "=", 
           RowBox[{"stochsSimulationresults", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"hist0", ",", "hist00", ",", "hist000", ",", "plots"}], 
            "}"}], "]"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"hist0", ",", "hist00", ",", "hist000"}], "}"}], "]"}]}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.9128541219962244`*^9, 3.9128542253683867`*^9, {3.912854395575735*^9, 
   3.912854396546607*^9}, {3.9128544307424145`*^9, 3.912854480795816*^9}, {
   3.9128545378046875`*^9, 3.9128546169644365`*^9}, {3.912854679768524*^9, 
   3.9128546885864005`*^9}, {3.9128547960659246`*^9, 3.9128547966846232`*^9}, 
   3.912856222814557*^9, {3.912856396871366*^9, 3.9128564024545555`*^9}, {
   3.912867259497326*^9, 3.912867264862124*^9}, 3.9128673281523314`*^9, {
   3.912867380597133*^9, 3.9128673973321095`*^9}, {3.9128674280672827`*^9, 
   3.9128674384672422`*^9}, {3.919155153786208*^9, 3.9191552145020037`*^9}, {
   3.919155255401664*^9, 3.9191552646533017`*^9}, {3.919155487893093*^9, 
   3.919155489919714*^9}, {3.919240636067504*^9, 3.91924063819248*^9}, {
   3.9192407457913723`*^9, 3.9192407469780345`*^9}, 3.919335298654187*^9, {
   3.919336944205881*^9, 3.919336997383504*^9}, {3.9193370683751507`*^9, 
   3.9193370870855336`*^9}, {3.9193520691654844`*^9, 3.919352070073696*^9}, {
   3.919776629685663*^9, 3.9197766748161907`*^9}, {3.919776750113922*^9, 
   3.91977675124226*^9}, {3.924952392085923*^9, 
   3.924952401402828*^9}},ExpressionUUID->"ab2f9eb6-12af-423d-9506-\
44f51af72de0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Code to generate initial values, visualize time series, and histograms:\
\>", "Chapter",
 CellChangeTimes->{{3.9128552530302067`*^9, 3.9128552628297715`*^9}, {
  3.9128554873101883`*^9, 3.912855504431066*^9}, {3.91285894925006*^9, 
  3.9128589668701625`*^9}, {3.9249552278325057`*^9, 
  3.924955232253049*^9}},ExpressionUUID->"5c322aad-f009-4a66-9b98-\
4d4f1dc07286"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generatePointsInMultivariateNormalDistribution", "[", 
     RowBox[{"mean_", ",", "covarianceMatrix_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L", ",", "z", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "=", 
        RowBox[{"CholeskyDecomposition", "[", "covarianceMatrix", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"z", "=", 
        RowBox[{"RandomVariate", "[", 
         RowBox[{
          RowBox[{"NormalDistribution", "[", "]"}], ",", 
          RowBox[{"Length", "[", "mean", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{
         RowBox[{"L", ".", "z"}], "+", "mean"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateInitialConditionsInElipsoid", "[", 
     RowBox[{
     "elipsoidData_", ",", "indices_", ",", "sampleSize_", ",", 
      "selectConfidenceLevel_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dimToPlot", ",", "covAndMeans", ",", "sigmaFactor", ",", 
        "covMatrixSelectedCluster", ",", "mean", ",", "generatedPoints", ",", 
        "\[IndentingNewLine]", "df", ",", "confidenceLevel", ",", 
        "criticalValue", ",", "pointGenerator"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dimToPlot", "=", 
        RowBox[{"indices", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"covAndMeans", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"getCovarianceAndMean", "[", 
           RowBox[{"elipsoidData", "[", 
            RowBox[{"[", 
             RowBox[{"nCluster", ",", "All", ",", "dimToPlot"}], "]"}], "]"}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"nCluster", ",", 
            RowBox[{"Length", "[", "elipsoidData", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"df", "=", 
        RowBox[{"Length", "[", "dimToPlot", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"confidenceLevel", "=", "selectConfidenceLevel"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"criticalValue", "=", 
        RowBox[{"Quantile", "[", 
         RowBox[{
          RowBox[{"ChiSquareDistribution", "[", "df", "]"}], ",", 
          "confidenceLevel"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sigmaFactor", "=", "criticalValue"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pointGenerator", "[", 
         RowBox[{"cov_", ",", "mean_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"point", ",", "valid"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"valid", "=", "False"}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"!", "valid"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"point", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Max", "[", "cov", "]"}], "]"}], "*", 
                  RowBox[{"RandomVariate", "[", 
                   RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "1"}], "]"}], ",", 
                    RowBox[{"Length", "[", "mean", "]"}]}], "]"}]}], "+", 
                 "mean"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"point", "=", 
               RowBox[{
               "generatePointsInMultivariateNormalDistribution", "[", 
                RowBox[{"mean", ",", " ", "cov"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"valid", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"point", "-", "mean"}], ")"}], ".", 
                 RowBox[{"Inverse", "[", "cov", "]"}], ".", 
                 RowBox[{"(", 
                  RowBox[{"point", "-", "mean"}], ")"}]}], "<=", 
                "sigmaFactor"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"point", "=", 
               RowBox[{"Abs", "[", "point", "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "point"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"generatedPoints", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"covMatrixSelectedCluster", ",", "mean"}], "}"}], "=", 
              
              RowBox[{"covAndMeans", "[", 
               RowBox[{"[", "nCluster", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pointGenerator", "[", 
              RowBox[{"covMatrixSelectedCluster", ",", "mean"}], "]"}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"pointGenerator", "[", 
                 RowBox[{"covMatrixSelectedCluster", ",", "mean"}], "]"}], 
                ",", 
                RowBox[{"{", "sampleSize", "}"}]}], "]"}], ","}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"generatePointsInMultivariateNormalDistribution", "[", 
               RowBox[{
               "mean", ",", " ", "covMatrixSelectedCluster", ",", 
                "sampleSize"}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"nCluster", ",", 
              RowBox[{"Length", "[", "elipsoidData", "]"}]}], "}"}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", "sampleSize", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{"generatedPoints", ",", "1"}], "]"}]}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generateInitialConditions", "[", 
     RowBox[{"basinCenters_", ",", 
      RowBox[{"sampleInBasinWithNoise_", ":", "5"}], ",", " ", 
      RowBox[{"sampledRandomReal_", ":", "5"}], ",", " ", 
      RowBox[{"pertubationAmplitude_", ":", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "initialConditions", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"initialConditions", " ", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", 
                  RowBox[{"pertubationAmplitude", "*", 
                   RowBox[{"RandomVariate", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0.5", ",", "0.1"}], "]"}], ",", "ngenes"}], 
                    "]"}]}]}], "&"}], ",", " ", "basinCenters"}], "]"}], ",", 
              "sampleInBasinWithNoise"}], "]"}], ",", "1"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "10"}], "}"}], ",", "ngenes"}], "]"}], ",", 
            "sampledRandomReal"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "initialConditions"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"plotingTimeSeries", "[", 
     RowBox[{"trajectories_", ",", " ", 
      RowBox[{"selectingGenes_", ":", " ", "ngenes"}], ",", " ", 
      RowBox[{"selectedSample_", ":", "All"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plots", ",", "plotsPartitioned"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plots", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{
            RowBox[{"ListLinePlot", "[", 
             RowBox[{
              RowBox[{"trajectories", "[", 
               RowBox[{"[", 
                RowBox[{"selectedSample", ",", ";;", ",", "i"}], "]"}], "]"}],
               ",", 
              RowBox[{"Filling", "->", "None"}], ",", 
              RowBox[{"PlotLabel", "->", 
               RowBox[{"names", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"PlotRange", "->", "Full"}], ",", 
              RowBox[{"ImageSize", "->", "200"}], ",", 
              RowBox[{"Frame", "->", "True"}], ",", " ", 
              RowBox[{"FrameLabel", "->", 
               RowBox[{"{", 
                RowBox[{"\"\<Time\>\"", ",", " ", "\"\<Expression\>\""}], 
                "}"}]}]}], "]"}], ",", 
            RowBox[{"FrameTicks", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"tickFunc", ",", "Automatic"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"tickFunc", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "selectingGenes"}], "}"}]}], "]"}]}], ";", "\n", 
       
       RowBox[{"plotsPartitioned", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{"plots", ",", "5"}], 
         RowBox[{"(*", 
          RowBox[{",", "4", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "*)"}], "]"}]}], ";", "\n", 
       RowBox[{"Grid", "[", 
        RowBox[{"plotsPartitioned", ",", 
         RowBox[{"Frame", "->", "None"}], ",", 
         RowBox[{"Spacings", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotingHistograms", "[", 
    RowBox[{"datapoints_", ",", "histList_", ",", " ", 
     RowBox[{"selectingGenes_", ":", " ", "ngenes"}], ",", " ", 
     RowBox[{"selectedSample_", ":", "All"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"histogramsList", ",", "plots", ",", "plotsPartitioned"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"histogramsList", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "datapoints", "}"}], ",", "histList", ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Histogram", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"selectedSample", ",", "i"}], "]"}], "]"}], "&"}], 
             ",", "histogramsList"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "12", ",", "0.5"}], "}"}], ",", 
           "\"\<Probability\>\"", ",", 
           RowBox[{"PlotLabel", "->", 
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "selectingGenes"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plotsPartitioned", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"plots", ",", "5"}], 
        RowBox[{"(*", 
         RowBox[{",", "4", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{"plotsPartitioned", ",", 
        RowBox[{"Frame", "->", "None"}], ",", 
        RowBox[{"Spacings", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.913125280314521*^9, 3.913125294858945*^9}, {
   3.913125327866638*^9, 3.913125338593029*^9}, {3.9131256362930794`*^9, 
   3.913125679316407*^9}, 3.9131257122384353`*^9, 3.9131259003186226`*^9, {
   3.913126057843303*^9, 3.913126059860898*^9}, {3.913126097740456*^9, 
   3.9131261735574903`*^9}, {3.9131262228606987`*^9, 
   3.9131262742347713`*^9}, {3.913126689518083*^9, 3.9131267511073046`*^9}, {
   3.9131268905850844`*^9, 3.9131269201493797`*^9}, {3.9131269883930836`*^9, 
   3.9131270149800043`*^9}, {3.913127074079735*^9, 3.9131270824760313`*^9}, {
   3.9131272951941595`*^9, 3.913127382337566*^9}, {3.9131275018524137`*^9, 
   3.9131275152169857`*^9}, {3.9131276438061323`*^9, 3.913127682484193*^9}, {
   3.913127772110743*^9, 3.913127817520218*^9}, {3.913127880714655*^9, 
   3.9131278845086355`*^9}, {3.9131279219962797`*^9, 3.913127957363248*^9}, {
   3.913132203779552*^9, 3.9131322388253326`*^9}, {3.913140954806341*^9, 
   3.913140955462599*^9}, {3.913301495075129*^9, 3.913301508868679*^9}, {
   3.924952375631302*^9, 3.924952376460496*^9}, {3.924955423053317*^9, 
   3.9249554250350237`*^9}, {3.924955461468897*^9, 
   3.9249554788460684`*^9}},ExpressionUUID->"cb33c4b4-8ed4-4025-95b5-\
ad476313555c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Code to identify parameters that result in points inside ellipsoids:\
\>", "Chapter",
 CellChangeTimes->{{3.9128572270423994`*^9, 3.912857246922442*^9}, 
   3.9249552423417463`*^9},ExpressionUUID->"f0d2630d-5f10-4645-a1aa-\
60d07465a467"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testParametersforClustersCompat", "[", 
     RowBox[{
     "elipsoidReference_", ",", "estimatedParsList_", ",", "secondParsList_", 
      ",", "hyperparametersList_", ",", "initialCoNditionValues_", ",", 
      "parIndex_", ",", " ", 
      RowBox[{"selectedNoiseFactor_", ":", "0.001"}], ",", 
      RowBox[{"timeForSimulation_", ":", "20"}], ",", 
      "selectConfidenceLevel_", ",", "postotal_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"simStep", ",", 
        RowBox[{"exportPlots", "=", " ", "False"}], ",", "hist0Method", ",", 
        "hist00Method", ",", "hist000Method"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"simStep", "=", "0.1"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"simStep", "=", "0.05"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"simStep", "=", "0.01"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hist0Method", ",", "hist00Method", ",", "hist000Method"}], 
         "}"}], "=", 
        RowBox[{"runSimulation", "[", 
         RowBox[{
         "parIndex", ",", " ", "estimatedParsList", ",", " ", 
          "secondParsList", ",", " ", "hyperparametersList", ",", " ", 
          "selectedNoiseFactor", ",", " ", "initialCoNditionValues", ",", 
          "  ", "NewActivationFunction", ",", "NewInhibitionFunction", ",", 
          " ", "exportPlots", ",", " ", "timeForSimulation", ",", " ", 
          "simStep"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"percentOfUnclusteredPointsInsideElipsoids", "[", 
          RowBox[{
          "hist0Method", ",", "elipsoidReference", ",", "postotal", ",", 
           "selectConfidenceLevel"}], "]"}], ",", "hist0Method"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"spanParametersForClustersCompat", "[", 
     RowBox[{
     "elipsoidReference_", ",", "estimatedParsList_", ",", "secondParsList_", 
      ",", "hyperparametersList_", ",", "initialCoNditionValues_", ",", 
      RowBox[{"mode_", ":", "\"\<storingResults\>\""}], ",", " ", 
      RowBox[{"selectedNoiseFactor_", ":", "0.001"}], ",", 
      RowBox[{"timeForSimulation_", ":", "20"}], ",", 
      "selectConfidenceLevel_", ",", "postotal_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "totalParametersCombinations", ",", "parIndex", ",", "listOfResults", 
        ",", "listOfPoints", ",", "bothNonZero", ",", "dataPoints", ",", " ", 
        
        RowBox[{"debug", "=", "False"}]}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<selectedNoiseFactor :\>\"", ",", " ", "selectedNoiseFactor"}],
            "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<timeForSimulation :\>\"", ",", " ", "timeForSimulation"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<selectConfidenceLevel :\>\"", ",", " ", 
            "selectConfidenceLevel"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<postotal :\>\"", ",", " ", "postotal"}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"totalParametersCombinations", "=", 
        RowBox[{"Length", "[", "estimatedParsList", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"listOfResults", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"listOfPoints", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"parameterNumber", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"parameterNumber", " ", "=", " ", 
             RowBox[{"parameterNumber", "+", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"bothNonZero", ",", "dataPoints"}], "}"}], "  ", "=", 
             RowBox[{"testParametersforClustersCompat", "[", 
              RowBox[{
              "elipsoidReference", ",", "estimatedParsList", ",", 
               "secondParsList", ",", "hyperparametersList", ",", 
               "initialCoNditionValues", ",", "parIndex", ",", " ", 
               "selectedNoiseFactor", ",", "timeForSimulation", ",", 
               "selectConfidenceLevel", ",", "postotal"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"mode", " ", "==", " ", "\"\<storingResults\>\""}], ",",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"listOfResults", ",", "bothNonZero"}], "]"}], ";", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"listOfPoints", ",", "dataPoints"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"Not", "[", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Round", "[", "bothNonZero", "]"}], ",", "0"}], 
                   "]"}], "]"}], ",", " ", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"listOfResults", ",", "parIndex"}], "]"}]}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"parIndex", ",", "totalParametersCombinations"}], "}"}]}],
           "]"}], ",", 
         RowBox[{"ProgressIndicator", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "parameterNumber", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "totalParametersCombinations"}], "}"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"listOfResults", ",", "listOfPoints"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deleteZeroCases", "[", "list_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "zeroRemoved", "}"}], ",", 
     RowBox[{"zeroRemoved", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"list", ",", 
        RowBox[{"_", "0."}], ",", "1"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{" ", 
       RowBox[{"deleteZeroCases", "[", 
        RowBox[{"list", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ">", "0"}], " ", 
     ".."}], " ", "to", " ", "select", " ", "case", " ", "presenting", " ", 
    "at", " ", "least", " ", "one", " ", "stability", " ", "within", " ", "a",
     " ", "confidence", " ", "region"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positionsAndFilledClusters", "[", "list_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"temporaryList", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"deleteZeroCases", "[", 
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ">", "0"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"temporaryList", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "temporaryList"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9128552638549814`*^9, {3.9128664808473444`*^9, 3.912866483897153*^9}, {
   3.912867474302224*^9, 3.91286753304714*^9}, {3.912867579627101*^9, 
   3.9128675841523223`*^9}, {3.9128718710076504`*^9, 3.9128718737879257`*^9}, 
   3.913028249200014*^9, {3.9131100651582904`*^9, 3.913110262119933*^9}, {
   3.9131102942723475`*^9, 3.9131103147905397`*^9}, {3.9131104167736063`*^9, 
   3.9131104407991347`*^9}, {3.9131104726963835`*^9, 
   3.9131104980718656`*^9}, {3.913110533959293*^9, 3.913110534976152*^9}, {
   3.9131132062036405`*^9, 3.91311320667239*^9}, 3.9131138890291123`*^9, {
   3.9131411343032336`*^9, 3.913141135412429*^9}, {3.9131412096161737`*^9, 
   3.9131412334881477`*^9}, {3.913304994014044*^9, 3.913305034951395*^9}, {
   3.9136361231829257`*^9, 3.913636162398428*^9}, {3.913636514553491*^9, 
   3.913636532479395*^9}, {3.9136372095126987`*^9, 3.913637210005499*^9}, {
   3.9136385489177213`*^9, 3.9136385497002354`*^9}, {3.9177707471580296`*^9, 
   3.917770747502756*^9}, {3.9181448892346716`*^9, 3.918144920696271*^9}, {
   3.9191538666463876`*^9, 3.91915392950525*^9}, {3.919240647388175*^9, 
   3.919240650957945*^9}, {3.919336855664382*^9, 3.9193368592425365`*^9}, {
   3.91977654240872*^9, 3.9197765471304216`*^9}, {3.920525626069059*^9, 
   3.9205256300863333`*^9}, {3.924955522902269*^9, 
   3.9249555461236525`*^9}},ExpressionUUID->"5c64f331-1e48-4490-ba14-\
0933f82f5b25"]
}, Closed]],

Cell[CellGroupData[{

Cell["Code to parameters\[CloseCurlyQuote] estimation and multistability:", \
"Chapter",
 CellChangeTimes->{{3.9129300649389496`*^9, 3.9129300924863777`*^9}, {
   3.913012062843834*^9, 3.9130120662352734`*^9}, 3.9131105777295046`*^9, 
   3.924955284697479*^9, {3.9249553170562797`*^9, 
   3.9249553405890417`*^9}},ExpressionUUID->"61e77d93-beab-4951-a373-\
2ff8314dd0eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trueOrFalseForEachElement", "[", 
     RowBox[{"list_", ",", " ", "elementsList_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"list", ",", "#"}], "]"}], "&"}], ",", "elementsList"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filteredCombinations", "[", 
    RowBox[{"methodNBCdataclustTotal_", ",", " ", 
     RowBox[{"combinationLength_", ":", "2"}], ",", 
     RowBox[{"elementsList_", ":", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"subSets", ",", "newSubset", ",", "newSubsetWithoutNull"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subSets", " ", "=", " ", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "methodNBCdataclustTotal", "]"}], "]"}], ",", 
         RowBox[{"{", "combinationLength", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newSubset", " ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"trueOrFalseForEachElement", "[", 
              RowBox[{
               RowBox[{"subSets", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "elementsList"}], "]"}], 
             ",", "True"}], "]"}], ",", 
           RowBox[{"subSets", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", 
           RowBox[{"Length", "[", "subSets", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newSubsetWithoutNull", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"newSubset", ",", 
         RowBox[{"_", "?", "ListQ"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "newSubsetWithoutNull"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"substituteListValues", "[", "listValues_", "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"postotal", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}], "->", "#"}], "]"}], "&"}], 
     ",", "listValues"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"substituteCOnfidenceExpressionValues", "[", 
    RowBox[{"list_", ",", "listValues_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"list", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"listValues", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"clustersCombinationsMoreThanTwo", "[", 
    RowBox[{
    "dataClust_", ",", "basinCenters_", ",", "basinSigmas_", ",", 
     "dataWeightPerc_", ",", "parSinputs_", ",", "parNinputs_", ",", 
     "parsLimits_", ",", 
     RowBox[{"combinationLength_", ":", "2"}], ",", 
     RowBox[{"elementsList_", ":", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}]}], ",", 
     RowBox[{"centroidsSampling_", ":", "2"}], ",", " ", 
     RowBox[{"uniformSampling_", ":", "0"}], ",", " ", 
     RowBox[{"insideConfidence_", ":", "False"}], ",", 
     RowBox[{"selectConfidenceLevel_", ":", "0.68"}], ",", 
     RowBox[{"pertubationAmplitude_", ":", "0"}], ",", "postotal_", ",", 
     RowBox[{"tryAllCombinations_", ":", "2"}], ",", 
     RowBox[{"noiseFactor_", ":", "0.001"}], ",", 
     RowBox[{"timeForSimulation_", ":", "20"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "clustersCombinations", ",", "numberOfClusterCombinations", ",", 
       "newVariablesForSelectedCLusters", ",", 
       "saveCombinationParameterIndicesAndFilledClusters", ",", 
       "\[IndentingNewLine]", "minSvalues", ",", "maxSfortest", ",", " ", 
       "stepSvalues", ",", "minNvalues", ",", "maxNfortest", ",", " ", 
       "stepNvalues", ",", "infLim", ",", " ", "supLim", ",", 
       "parameterCombinationsNumber", ",", "\[IndentingNewLine]", 
       "secondParsList", ",", "initialCoNditionValues", ",", 
       "selectingClusters", ",", "selectedClustersStatisticsLists", ",", 
       "positionsAndFilled", ",", "\[IndentingNewLine]", "estimatedParsList", 
       ",", "residualsList", ",", "residualsTotalList", ",", 
       "residualsMaxList", ",", "hyperparametersList", ",", 
       "listOfPromissingParameters", ",", "\[IndentingNewLine]", 
       "listOfPoints", ",", "listForListOfPoints", ",", 
       "listForListOfParameters", ",", "positionsToStore", ",", 
       "\[IndentingNewLine]", "debug", ",", "ruido"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"debug", "=", "False"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"tryAllCombinations", "==", "1"}], ",", " ", 
        RowBox[{"clustersCombinations", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"filteredCombinations", "[", 
               RowBox[{"dataClust", ",", " ", "#", ",", "elementsList"}], 
               "]"}], "&"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "dataClust", "]"}], "]"}]}], "]"}], ",", 
           "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tryAllCombinations", "==", "2"}], ",", 
        RowBox[{"clustersCombinations", "=", 
         RowBox[{"filteredCombinations", "[", 
          RowBox[{
          "dataClust", ",", "combinationLength", ",", "elementsList"}], 
          "]"}]}], ",", "\[IndentingNewLine]", "True", ",", 
        RowBox[{"clustersCombinations", "=", 
         RowBox[{"ToExpression", "[", "tryAllCombinations", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"numberOfClusterCombinations", "=", 
       RowBox[{"Length", "[", "clustersCombinations", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Total number of clusters combinations: \>\"", ",", " ", 
        "numberOfClusterCombinations"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"newVariablesForSelectedCLusters", "=", 
       RowBox[{"{", 
        RowBox[{
        "dataClust", ",", "basinCenters", ",", "basinSigmas", ",", 
         "dataWeightPerc"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"saveCombinationParameterIndicesAndFilledClusters", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"listForListOfPoints", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"listForListOfParameters", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minSvalues", ",", "maxSfortest", ",", " ", "stepSvalues"}], 
        "}"}], "=", "parSinputs"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"minNvalues", ",", "maxNfortest", ",", " ", "stepNvalues"}], 
        "}"}], "=", "parNinputs"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"infLim", ",", " ", "supLim"}], "}"}], "=", "parsLimits"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"parameterCombinationsNumber", " ", "=", " ", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"minSvalues", ",", "maxSfortest", ",", "stepSvalues"}], 
          "]"}], "]"}], " ", "*", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"minNvalues", ",", "maxNfortest", ",", "stepNvalues"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"secondParsList", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"2", "*", "ngenes"}]}], "]"}], ",", 
         "parameterCombinationsNumber"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "insideConfidence", "]"}], ",", 
        RowBox[{"initialCoNditionValues", "=", 
         RowBox[{"generateInitialConditions", "[", 
          RowBox[{
          "basinCenters", ",", "centroidsSampling", ",", "uniformSampling", 
           ",", "pertubationAmplitude"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{
         RowBox[{
         "savedInitialCoNditionValues", " ", "=", "initialCoNditionValues"}], 
         ";", 
         RowBox[{"Print", "[", "savedInitialCoNditionValues", "]"}]}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"combinationCont", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"combinationCont", "=", 
             RowBox[{"combinationCont", "+", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"selectingClusters", "=", 
             RowBox[{"clustersCombinations", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"selectedClustersStatisticsLists", "=", 
             RowBox[{"selectedClustersStatistics", "[", 
              RowBox[{
              "newVariablesForSelectedCLusters", ",", "selectingClusters"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "estimatedParsList", ",", "residualsList", ",", 
               "residualsTotalList", ",", "residualsMaxList", ",", 
               "hyperparametersList"}], "}"}], "=", 
             RowBox[{"parametersEstimation", "[", 
              RowBox[{
              "selectedClustersStatisticsLists", ",", "parSinputs", ",", 
               "parNinputs", ",", "parsLimits"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"insideConfidence", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"debug", ",", 
                 RowBox[{"Print", "[", 
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"selectedClustersStatisticsLists", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"ruido", " ", "=", " ", 
                RowBox[{"generateInitialConditionsInElipsoid", "[", 
                 RowBox[{
                  RowBox[{"selectedClustersStatisticsLists", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", "postotal", ",", 
                  " ", "centroidsSampling", ",", "selectConfidenceLevel"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"debug", ",", 
                 RowBox[{"Print", "[", 
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"selectedClustersStatisticsLists", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"initialCoNditionValues", "=", 
                RowBox[{"substituteCOnfidenceExpressionValues", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"selectedClustersStatisticsLists", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    "centroidsSampling"}], "]"}], ",", "1"}], "]"}], ",", 
                  RowBox[{"substituteListValues", "[", "ruido", "]"}]}], 
                 "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"listOfPromissingParameters", ",", "listOfPoints"}], 
              "}"}], "=", 
             RowBox[{"spanParametersForClustersCompat", "[", 
              RowBox[{
              "dataClust", ",", "estimatedParsList", ",", "secondParsList", 
               ",", "hyperparametersList", ",", "initialCoNditionValues", 
               ",", "\"\<storingResults\>\"", ",", "noiseFactor", ",", " ", 
               "timeForSimulation", ",", "selectConfidenceLevel", ",", " ", 
               "postotal"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"positionsAndFilled", " ", "=", " ", 
             RowBox[{
             "positionsAndFilledClusters", "[", "listOfPromissingParameters", 
              "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "positionsAndFilled", "]"}], ">", "0"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"positionsToStore", "=", 
                RowBox[{"positionsAndFilled", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"listForListOfPoints", ",", 
                 RowBox[{"{", 
                  RowBox[{"selectingClusters", ",", 
                   RowBox[{"listOfPoints", "[", 
                    RowBox[{"[", "positionsToStore", "]"}], "]"}]}], "}"}]}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"listForListOfParameters", ",", 
                 RowBox[{"{", 
                  RowBox[{"selectingClusters", ",", 
                   RowBox[{"estimatedParsList", "[", 
                    RowBox[{"[", "positionsToStore", "]"}], "]"}]}], "}"}]}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{
                "saveCombinationParameterIndicesAndFilledClusters", ",", 
                 RowBox[{"{", 
                  RowBox[{"selectingClusters", ",", "positionsAndFilled", ",", 
                   RowBox[{"hyperparametersList", "[", 
                    RowBox[{"[", "positionsToStore", "]"}], "]"}], ",", 
                   RowBox[{"estimatedParsList", "[", 
                    RowBox[{"[", "positionsToStore", "]"}], "]"}]}], "}"}]}], 
                "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numberOfClusterCombinations"}], "}"}]}], "]"}],
          ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "combinationCont", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "numberOfClusterCombinations"}], "}"}]}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "saveCombinationParameterIndicesAndFilledClusters", ",", 
        "listForListOfPoints", ",", "listForListOfParameters"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9131106324178286`*^9, 3.9131106334334345`*^9}, 
   3.9131106854719915`*^9, {3.9131107230051203`*^9, 3.9131107248644967`*^9}, 
   3.9131108343133125`*^9, {3.9131126256152396`*^9, 3.913112679057283*^9}, 
   3.9131132224266605`*^9, {3.9131279891023707`*^9, 3.913128103987604*^9}, {
   3.913128147092043*^9, 3.913128157652484*^9}, {3.9131283662332306`*^9, 
   3.9131283682350388`*^9}, {3.9131284167948065`*^9, 3.913128433794274*^9}, {
   3.9131291885364685`*^9, 3.9131292048378057`*^9}, {3.9131292449177723`*^9, 
   3.9131292542740736`*^9}, {3.9131314367779627`*^9, 3.91313146891973*^9}, {
   3.913132433183487*^9, 3.9131324335739775`*^9}, {3.9131324663159943`*^9, 
   3.9131325273405843`*^9}, {3.913132666455163*^9, 3.9131326687999*^9}, {
   3.913136027143406*^9, 3.913136047158718*^9}, {3.913136096074274*^9, 
   3.913136104181554*^9}, {3.9131405680255394`*^9, 3.9131405897554646`*^9}, {
   3.913140990501279*^9, 3.913140995267481*^9}, {3.9131410478332596`*^9, 
   3.913141072886941*^9}, {3.9131412686936083`*^9, 3.9131412691154423`*^9}, {
   3.9131942664433885`*^9, 3.913194300223278*^9}, 3.913194360313867*^9, {
   3.9131998438737817`*^9, 3.9131998488590612`*^9}, {3.913296594755558*^9, 
   3.91329663135956*^9}, {3.913296759620162*^9, 3.9132968126371326`*^9}, {
   3.913297007602767*^9, 3.913297007793993*^9}, {3.9133015506626034`*^9, 
   3.9133015709899964`*^9}, {3.9133051354853473`*^9, 
   3.9133051396346326`*^9}, {3.9133051987515078`*^9, 
   3.9133052025511465`*^9}, {3.9133095593426666`*^9, 3.913309677572505*^9}, {
   3.9133103094891315`*^9, 3.9133103143902063`*^9}, {3.913310381102202*^9, 
   3.9133103878655167`*^9}, {3.9133104709742455`*^9, 3.913310495261753*^9}, 
   3.91331068877394*^9, {3.913631129185204*^9, 3.913631161141473*^9}, {
   3.9136312148443117`*^9, 3.9136312425182147`*^9}, {3.9136313495511055`*^9, 
   3.9136313618841314`*^9}, {3.9136327808694825`*^9, 3.91363280785404*^9}, {
   3.9136329620415096`*^9, 3.913632962391835*^9}, {3.913633141947735*^9, 
   3.913633145346225*^9}, {3.913633198734907*^9, 3.913633233611278*^9}, {
   3.9136333508388696`*^9, 3.9136333531206865`*^9}, {3.9136334138822837`*^9, 
   3.913633423589992*^9}, {3.913636230584544*^9, 3.913636240311631*^9}, {
   3.9136362995153947`*^9, 3.9136363231353474`*^9}, {3.913637168943512*^9, 
   3.913637193912135*^9}, {3.9182087398245106`*^9, 3.9182087719519405`*^9}, {
   3.9191555512808437`*^9, 3.919155573066081*^9}, {3.919155606964097*^9, 
   3.919155610427572*^9}, 3.92495052187281*^9, {3.924950559144695*^9, 
   3.9249506106216836`*^9}},ExpressionUUID->"06a17e42-529d-41fb-83aa-\
9bfb473a13c9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Code to generate a dataset of combinations and statistics:", "Chapter",
 CellChangeTimes->{{3.9130120825307026`*^9, 3.91301210061051*^9}, {
   3.9133027202303567`*^9, 3.91330272472744*^9}, {3.9134785743925266`*^9, 
   3.9134785748456497`*^9}, 3.9134788209978786`*^9, 
   3.924955349133375*^9},ExpressionUUID->"2fe57cbd-1cb2-4067-9adb-\
6b3e2dedd19b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"processCombinations", "[", 
   RowBox[{
   "combination_", ",", " ", "parsAndCLusters_", ",", " ", 
    "hyperparametersList_", ",", "activationParameters_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Combination\>\"", "->", "combination"}], ",", 
       RowBox[{"\"\<ParIndex\>\"", "->", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"\"\<ClusterFilled\>\"", "->", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"\"\<n\>\"", "->", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", 
       RowBox[{"\"\<S\>\"", "->", 
        RowBox[{"#", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ",", 
       RowBox[{"\"\<ActivationParameters\>\"", "->", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "ngenes"}], "]"}], "]"}]}], ",", 
       RowBox[{"\"\<InhibitionParameters\>\"", "->", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"ngenes", "+", "1"}], ";;", 
           RowBox[{"2", "*", "ngenes"}]}], "]"}], "]"}]}]}], "|>"}], "&"}], 
    ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"parsAndCLusters", ",", "hyperparametersList", ",", "2"}], 
       "]"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "&"}], ",", "activationParameters"}], "]"}],
       ",", "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "generateCombinationsDataset", "[", "listOfClutersCombinationsResult_", 
    "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"processCombinations", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "&"}], ",", 
       "listOfClutersCombinationsResult"}], "]"}], ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"processedGroupedDataset", "[", "rawDataSet_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "debug", ",", "keys", ",", "values", ",", " ", "flattenedKeysOfValues", 
       ",", "inListValuesToLetters", ",", " ", "letterKeys", ",", 
       "flattenedValuesofValues", ",", "output"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"debug", "=", "False"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"keys", "=", " ", 
       RowBox[{"Keys", "[", "rawDataSet", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<keys: \>\"", ",", "keys"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"values", "=", 
       RowBox[{"Values", "[", "rawDataSet", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", "values", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"flattenedKeysOfValues", " ", "=", " ", 
       RowBox[{"Keys", "[", "values", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<flattenedKeysOfValues: \>\"", ",", "flattenedKeysOfValues"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inListValuesToLetters", "[", "list_", "]"}], ":=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"formatLettersFromList", "[", "#", "]"}], "]"}], "&"}], 
         ",", "list"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"letterKeys", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"inListValuesToLetters", "[", "#", "]"}], "&"}], ",", 
         "flattenedKeysOfValues"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<letterKeys: \>\"", ",", "letterKeys"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"flattenedValuesofValues", " ", "=", " ", 
       RowBox[{"Values", "[", "values", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<flattenedValuesofValues: \>\"", ",", 
          "flattenedValuesofValues"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"<|", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"keys", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "->", 
           RowBox[{"<|", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"letterKeys", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "->", 
              RowBox[{"flattenedValuesofValues", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "|>"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "keys", "]"}]}], "}"}]}], "]"}], 
        "|>"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"returnClustersCombinationsStatistics", "[", 
     RowBox[{"dataSetCombinations_", ",", 
      RowBox[{"print_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ifNotZeroTurnOne", ",", "newDataSetOfCombinations", ",", 
        "joinAndSortCount", ",", "newDataSetOfCombinationsCount", ",", 
        "\[IndentingNewLine]", "newDataSetOfCombinationsGather", ",", 
        "joinAndSortLength", ",", "newDataSetOfCombinationsLength", ",", 
        "\[IndentingNewLine]", "combinedStatistics"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ifNotZeroTurnOne", "[", "list_", "]"}], ":=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "!=", "0"}], ",", "1", ",", "0"}], "]"}], "&"}], 
          ",", "list"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ifNotZeroTurnOne", "[", "list_", "]"}], ":=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"list", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "!=", "0"}], ",", "i", ",", 
                "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"newDataSetOfCombinations", " ", "=", " ", 
            RowBox[{"dataSetCombinations", "[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<ClusterFilled\>\"", "->", "ifNotZeroTurnOne"}], 
               "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"primeiro", " ", "output"}], "*)"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"joinAndSortCount", "[", "list_", "]"}], ":=", 
           RowBox[{"Counts", "[", 
            RowBox[{"Sort", "[", 
             RowBox[{"Join", "[", "list", "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newDataSetOfCombinationsCount", "=", 
           RowBox[{
            RowBox[{"newDataSetOfCombinations", "[", 
             RowBox[{
              RowBox[{"GroupBy", "[", "\"\<ClusterFilled\>\"", "]"}], ",", 
              " ", "joinAndSortCount", ",", " ", "\"\<ParIndex\>\""}], "]"}], 
            "//", "Normal"}]}], ";"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"segundo", " ", "output"}], "*)"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newDataSetOfCombinationsGather", "=", " ", 
          RowBox[{
           RowBox[{"newDataSetOfCombinations", "[", 
            RowBox[{
             RowBox[{"GroupBy", "[", "\"\<ClusterFilled\>\"", "]"}], ",", " ",
              "joinAndSortCount", ",", " ", "\"\<Combination\>\""}], "]"}], "//",
            "Normal"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newDataSetOfCombinationsGather", "=", 
          RowBox[{
          "processedGroupedDataset", "[", "newDataSetOfCombinationsGather", 
           "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"terceiro", " ", "output"}], "*)"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"joinAndSortLength", "[", "list_", "]"}], ":=", 
         RowBox[{"Length", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"Join", "[", "list", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newDataSetOfCombinationsLength", "=", 
         RowBox[{
          RowBox[{"newDataSetOfCombinations", "[", 
           RowBox[{
            RowBox[{"GroupBy", "[", "\"\<ClusterFilled\>\"", "]"}], ",", " ", 
            "joinAndSortLength", ",", " ", "\"\<ParIndex\>\""}], "]"}], "//", 
          "Normal"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"juntando", " ", "outputs"}], "*)"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"combinedStatistics", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
         "newDataSetOfCombinationsCount", ",", 
          "newDataSetOfCombinationsGather", ",", 
          "newDataSetOfCombinationsLength"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"print", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "newDataSetOfCombinationsCount", ",", "\"\<\\n\>\"", ",", 
           "newDataSetOfCombinationsGather", ",", "\"\<\\n\>\"", ",", 
           "newDataSetOfCombinationsLength"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "combinedStatistics"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "allPointsToDataset", "[", "listOfClutersCombinationsPoitsResult_", "]"}],
     ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "indexingSamplings", ",", "indexingPars", ",", 
        "generatePointsDataset"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"indexingSamplings", "[", "list_", "]"}], ":=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"names", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "->", 
           RowBox[{"list", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indexingPars", "[", 
         RowBox[{"list0_", ",", "k_", ",", "list1_"}], "]"}], ":=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Combination\>\"", "->", "list0"}], ",", 
            RowBox[{"\"\<parIndex\>\"", "->", "k"}], ",", 
            RowBox[{"\"\<SamplingIndex\>\"", "->", "i"}], ",", 
            RowBox[{"indexingSamplings", "[", 
             RowBox[{"list1", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "|>"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "list1", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"generatePointsDataset", "[", "list0_", "]"}], ":=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"indexingPars", "[", 
             RowBox[{
              RowBox[{"list0", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "k", ",", 
              RowBox[{"list0", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "k"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"list0", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"generatePointsDataset", "[", "#", "]"}], "&"}], ",", " ",
            "listOfClutersCombinationsPoitsResult"}], "]"}], ",", "1"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"transformedDataset", "[", 
    RowBox[{"dataSetPoints_", ",", "dataSetCombinationsReference_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"transformarPointsIndices", ",", " ", "newDataSet"}], "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"transformarPointsIndices", "[", 
        RowBox[{"combinationLabel_", ",", "parIndexNumber_"}], "]"}], ":=", 
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "combinationsAndIndices", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"combinationsAndIndices", " ", "=", 
           RowBox[{"dataSetCombinationsReference", "[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Combination\>\"", ",", "\"\<ParIndex\>\""}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"combinationsAndIndices", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"#Combination", "==", "combinationLabel"}], "&"}], 
              "]"}], ",", "\"\<ParIndex\>\""}], "]"}], "[", "parIndexNumber", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newDataSet", "=", 
       RowBox[{"dataSetPoints", "[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"<|", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<parIndex\>\"", "->", 
             RowBox[{"transformarPointsIndices", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "\"\<Combination\>\"", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "\"\<parIndex\>\"", "]"}], "]"}]}], "]"}]}]}], 
           "|>"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "newDataSet"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9130121015977077`*^9, 3.913012106807725*^9}, {
   3.9130168376306887`*^9, 3.913016879772724*^9}, {3.913016923423971*^9, 
   3.9130169340868025`*^9}, {3.913019747590748*^9, 3.9130197503890944`*^9}, {
   3.913020237493433*^9, 3.9130202900908203`*^9}, {3.913020843798916*^9, 
   3.9130208442793655`*^9}, {3.9130316127641306`*^9, 3.913031659283352*^9}, {
   3.9131109804824347`*^9, 3.9131109810761876`*^9}, {3.913111014273878*^9, 
   3.913111015382541*^9}, {3.913297994730186*^9, 3.9132980034585185`*^9}, {
   3.913298050468326*^9, 3.913298101815421*^9}, {3.9132986513155184`*^9, 
   3.9132987093123965`*^9}, {3.9133027363648005`*^9, 3.913302736847172*^9}, {
   3.913302815693756*^9, 3.9133028278052645`*^9}, {3.9133038725268493`*^9, 
   3.9133038792563524`*^9}, {3.9133047104609385`*^9, 
   3.9133047152463756`*^9}, {3.913305655121209*^9, 3.9133056602081413`*^9}, {
   3.913443256983391*^9, 3.9134432575146723`*^9}, {3.9134432897576914`*^9, 
   3.9134434210906305`*^9}, {3.913443796104186*^9, 3.9134438169079103`*^9}, {
   3.9134439453390493`*^9, 3.9134439468078327`*^9}, {3.9134439814241934`*^9, 
   3.913444029270601*^9}, {3.913444209619758*^9, 3.913444356117647*^9}, {
   3.91344506767348*^9, 3.913445117488391*^9}, {3.9134458993612757`*^9, 
   3.9134460012458153`*^9}, {3.9134461311401477`*^9, 
   3.9134461326243787`*^9}, {3.913450405955261*^9, 3.9134504173185043`*^9}, {
   3.9134504960569534`*^9, 3.913450519737262*^9}, 3.913450788606494*^9, {
   3.913450838818248*^9, 3.913450848952282*^9}, {3.913451030002244*^9, 
   3.913451034661228*^9}, {3.9134511007554674`*^9, 3.9134511287931223`*^9}, {
   3.9134512160975647`*^9, 3.913451223558795*^9}, {3.913451281573531*^9, 
   3.9134514235545826`*^9}, {3.9134515562089643`*^9, 3.913451572756507*^9}, {
   3.913451693599621*^9, 3.913451755212795*^9}, 3.913451898758379*^9, {
   3.9134523396539497`*^9, 3.913452350351473*^9}, {3.9134527231755123`*^9, 
   3.9134527377068615`*^9}, {3.913452805337132*^9, 3.9134528919085803`*^9}, {
   3.9134531126587296`*^9, 3.9134531425042987`*^9}, {3.9134532472627974`*^9, 
   3.913453294538079*^9}, {3.9134533247456875`*^9, 3.9134533269308586`*^9}, 
   3.9134533811652412`*^9, {3.9134534525764036`*^9, 3.9134534564524994`*^9}, {
   3.913453541924609*^9, 3.913453542727456*^9}, {3.9134537034966183`*^9, 
   3.913453707307538*^9}, {3.9134538346402416`*^9, 3.913453834890244*^9}, {
   3.913454112599724*^9, 3.9134541141778145`*^9}, {3.913454215568407*^9, 
   3.913454220005908*^9}, {3.9134549195796814`*^9, 3.9134549198775415`*^9}, {
   3.913455240173752*^9, 3.9134552425224085`*^9}, {3.913455301228279*^9, 
   3.9134553464898663`*^9}, {3.9134554297301655`*^9, 3.913455436281417*^9}, {
   3.913455523114192*^9, 3.913455548663576*^9}, {3.913455634401191*^9, 
   3.913455657181557*^9}, {3.913455938257961*^9, 3.9134559466763754`*^9}, {
   3.9134561282425175`*^9, 3.91345617902991*^9}, {3.913462243561853*^9, 
   3.913462328709992*^9}, {3.9134629805436487`*^9, 3.9134630125537167`*^9}, {
   3.9134653957980833`*^9, 3.913465403971078*^9}, {3.913465532054251*^9, 
   3.9134655404279985`*^9}, {3.913465819966319*^9, 3.913465820391451*^9}, 
   3.913465897532317*^9, {3.9134660968992395`*^9, 3.913466099685577*^9}, {
   3.913466530421466*^9, 3.9134665319125557`*^9}, {3.9134709600162816`*^9, 
   3.9134709603899317`*^9}, {3.9134717321035504`*^9, 3.9134717330100775`*^9}, 
   3.9134732234193754`*^9, {3.9134732666831856`*^9, 3.9134733160175395`*^9}, {
   3.9134734973176136`*^9, 3.913473543477779*^9}, {3.9134739568785744`*^9, 
   3.9134740041542835`*^9}, {3.9134740615496197`*^9, 
   3.9134740663732243`*^9}, {3.913474870877815*^9, 3.913474928614601*^9}, {
   3.913475004247861*^9, 3.9134750169274716`*^9}, {3.9134750757749233`*^9, 
   3.9134750839612246`*^9}, {3.9134753825428743`*^9, 3.913475388550563*^9}, {
   3.913475619517568*^9, 3.9134756335098314`*^9}, {3.9134757102681503`*^9, 
   3.913475719540832*^9}, {3.9134759726158724`*^9, 3.9134760970438156`*^9}, {
   3.9134761276347294`*^9, 3.9134761739317474`*^9}, {3.913476212345972*^9, 
   3.913476212984956*^9}, 3.9134762438331337`*^9, {3.913476289042467*^9, 
   3.9134762892678385`*^9}, {3.9134764120110826`*^9, 3.913476412243991*^9}, {
   3.913476664331273*^9, 3.9134767368835263`*^9}, {3.913476782354523*^9, 
   3.9134768047288375`*^9}, {3.913476864006128*^9, 3.91347686481898*^9}, 
   3.913477369622478*^9, 3.913477487646083*^9, {3.9134775726727743`*^9, 
   3.9134775735449734`*^9}, {3.913477614579506*^9, 3.9134776241920495`*^9}, 
   3.913477675715123*^9, {3.913477736632959*^9, 3.913477746631874*^9}, {
   3.9134777855545797`*^9, 3.913477807301691*^9}, {3.9134778445613613`*^9, 
   3.9134778447366924`*^9}, {3.9134786258223867`*^9, 3.913478626744254*^9}, {
   3.913478727801344*^9, 3.9134787295234623`*^9}, {3.9134787696257277`*^9, 
   3.913478772094474*^9}, 3.913478810766059*^9, {3.9135353165303802`*^9, 
   3.913535337241563*^9}, {3.9135358554119043`*^9, 3.9135358590993896`*^9}, {
   3.913536067380477*^9, 3.9135360675992603`*^9}, {3.9135361305567875`*^9, 
   3.91353613296658*^9}, {3.913536217683116*^9, 3.9135362254142632`*^9}, {
   3.9135362822471*^9, 3.9135363185639305`*^9}, {3.9135365944267917`*^9, 
   3.9135365997383175`*^9}, {3.913536750468046*^9, 3.9135367535957794`*^9}, {
   3.9135400379339375`*^9, 3.913540074617407*^9}, {3.913540222407429*^9, 
   3.9135402267564*^9}, {3.9135403128457365`*^9, 3.9135403134138145`*^9}, 
   3.9135414623762836`*^9, {3.913542658135728*^9, 3.91354265942249*^9}, {
   3.913542728217345*^9, 3.913542731587347*^9}, {3.9135427682423925`*^9, 
   3.913542770835832*^9}, {3.913542848384235*^9, 3.9135428508645515`*^9}, {
   3.9135428929946947`*^9, 3.913542912314828*^9}, {3.9135432265534973`*^9, 
   3.9135432399317727`*^9}, {3.913543391278296*^9, 3.913543393275*^9}, {
   3.913543441867319*^9, 3.9135434421148586`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"6ad07f1b-2e5e-4011-ba04-e2eb20603c37"]
}, Closed]],

Cell[CellGroupData[{

Cell["Code to generate bar charts, etc.:", "Chapter",
 CellChangeTimes->{{3.9130120825307026`*^9, 3.91301210061051*^9}, {
   3.9133027202303567`*^9, 3.91330272472744*^9}, {3.9134785743925266`*^9, 
   3.91347860108146*^9}, 3.9135425753740025`*^9, 
   3.924955357174758*^9},ExpressionUUID->"17cc5ecc-5e5f-45fa-a29b-\
4be5a726d4ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"formatLettersFromList", "[", "list_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"str", "=", 
         RowBox[{"{", "}"}]}], ",", "tempList"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tempList", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"list", ",", 
          RowBox[{"_", "0"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"str", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"numberToCapitalLetter", "[", "#", "]"}], "&"}], ",", 
          "tempList"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ToString", "[", "str", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreateBarChartsGrid", "[", 
     RowBox[{"data_", ",", 
      RowBox[{"rotated_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"charts", ",", "createSingleChart"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"createSingleChart", "[", 
         RowBox[{"key_", ",", "values_"}], "]"}], ":=", 
        RowBox[{"BarChart", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Values", "[", "values", "]"}], ",", 
          RowBox[{"ChartLabels", "->", 
           RowBox[{"If", "[", 
            RowBox[{"rotated", ",", 
             RowBox[{"Placed", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Keys", "[", "values", "]"}], "]"}], ",", "Axis", ",", 
               RowBox[{
                RowBox[{"Rotate", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"45", "Degree"}]}], "]"}], "&"}]}], " ", "]"}], ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Keys", "[", "values", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", 
             RowBox[{"FontSize", "->", 
              RowBox[{"If", "[", 
               RowBox[{"rotated", ",", "8", ",", "12"}], "]"}]}]}], "]"}]}], 
          ",", 
          RowBox[{"PlotLabel", "->", 
           RowBox[{"\"\<Clusters \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"formatLettersFromList", "[", "key", "]"}], "]"}]}]}], 
          ",", 
          RowBox[{"ChartStyle", "->", "\"\<Pastel\>\""}], ",", 
          RowBox[{"LabelingFunction", "->", "Above"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Values", "[", "values", "]"}], "+", "5"}], "]"}]}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"charts", "=", 
        RowBox[{"createSingleChart", "@@@", 
         RowBox[{"Normal", "[", "data", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"charts", ",", 
           RowBox[{"UpTo", "[", "3", "]"}]}], "]"}], ",", 
         RowBox[{"Frame", "->", "None"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{"GraphicsGrid", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"charts", ",", 
          RowBox[{"UpTo", "[", "3", "]"}]}], "]"}], ",", 
        RowBox[{"Frame", "->", "None"}]}], "]"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CreatePairedBarChartsGrid", "[", 
     RowBox[{"data1_", ",", "data2_", ",", " ", "stringList_", ",", 
      RowBox[{"reducedLabels_", ":", "False"}], ",", 
      RowBox[{"cols_", ":", "4"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "combinedKeys", ",", "fillMissingKeys", ",", "filledData1", ",", 
        "filledData2", ",", "createPairedChart", ",", "completeData1", ",", 
        "completeData2", ",", "\[IndentingNewLine]", "combinedPars", ",", 
        "fillMissingParams", ",", "keyForChart", ",", "dataForChart1", ",", 
        "dataForChart2", ",", "data", ",", "debug", ",", "max"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"debug", "=", "False"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<data1: \>\"", ",", " ", "data1", ",", " ", "\"\<\\n\>\"", ",", 
           " ", "\"\<data2: \>\"", ",", " ", "data2"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Keys[data1]: \>\"", ",", " ", 
           RowBox[{"Keys", "[", "data1", "]"}], ",", " ", "\"\<\\n\>\"", ",", 
           " ", "\"\<Keys[data2]: \>\"", ",", " ", 
           RowBox[{"Keys", "[", "data2", "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"combinedKeys", "=", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "data1", "]"}], ",", 
          RowBox[{"Keys", "[", "data2", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"combinedPars", "=", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Keys", "[", 
            RowBox[{"Values", "[", "data1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Keys", "[", 
            RowBox[{"Values", "[", "data2", "]"}], "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<combinedKeys: \>\"", ",", " ", "combinedKeys", ",", " ", 
           "\"\<\\n\>\"", ",", " ", "\"\<combinedPars: \>\"", ",", " ", 
           "combinedPars"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fillMissingKeys", "[", 
         RowBox[{"data_", ",", "keys_"}], "]"}], ":=", 
        RowBox[{"Association", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"data", ",", "#"}], "]"}], ",", 
              RowBox[{"#", "->", 
               RowBox[{"data", "[", "#", "]"}]}], ",", 
              RowBox[{"#", "->", 
               RowBox[{"<|", "|>"}]}]}], "]"}], "&"}], ",", "keys"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"filledData1", "=", 
        RowBox[{"fillMissingKeys", "[", 
         RowBox[{"data1", ",", "combinedKeys"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"filledData2", "=", 
        RowBox[{"fillMissingKeys", "[", 
         RowBox[{"data2", ",", "combinedKeys"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<filledData1: \>\"", ",", " ", "filledData1", ",", " ", 
           "\"\<\\n\>\"", ",", " ", "\"\<filledData2: \>\"", ",", " ", 
           "filledData2"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fillMissingParams", "[", 
         RowBox[{"data_", ",", "combinedPars_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "updatedData", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"updatedData", "=", 
            RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"updatedData", "=", 
            RowBox[{
             RowBox[{"Keys", "[", "data", "]"}], "->", 
             RowBox[{"Join", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"<|", 
                 RowBox[{
                  RowBox[{"combinedPars", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "->", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Keys", "[", 
                    RowBox[{"Values", "[", "data", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"combinedPars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Values", "[", "data", "]"}], ",", 
                    RowBox[{"combinedPars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", "0"}], 
                   "]"}]}], "|>"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", 
                  RowBox[{"Length", "[", "combinedPars", "]"}]}], "}"}]}], 
               "]"}]}]}]}], ";", "\[IndentingNewLine]", "updatedData"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"completeData1", "=", 
        RowBox[{"AssociationMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fillMissingParams", "[", 
            RowBox[{"#", ",", "combinedPars"}], "]"}], "&"}], ",", 
          "filledData1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"completeData2", "=", 
        RowBox[{"AssociationMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fillMissingParams", "[", 
            RowBox[{"#", ",", "combinedPars"}], "]"}], "&"}], ",", 
          "filledData2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"debug", ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<completeData1: \>\"", ",", " ", "completeData1", ",", " ", 
           "\"\<\\n\>\"", ",", " ", "\"\<completeData2: \>\"", ",", " ", 
           "completeData2"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"keyForChart", "=", 
        RowBox[{
         RowBox[{"Keys", "[", 
          RowBox[{"Values", "[", "completeData1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dataForChart1", "=", 
        RowBox[{"Values", "[", 
         RowBox[{"Values", "[", "completeData1", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dataForChart2", "=", 
        RowBox[{"Values", "[", 
         RowBox[{"Values", "[", "completeData2", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "#", "}"}], "&"}], ",", "dataForChart1"}], "]"}], 
          ",", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "#", "}"}], "&"}], ",", "dataForChart2"}], "]"}], 
          ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "#", "}"}], "&"}], ",", "combinedKeys"}], "]"}], 
          ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"createPairedChart", "[", "data_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"debug", ",", 
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<\\n\>\"", ",", 
               "keyForChart"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"max", " ", "=", " ", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"data", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "]"}], "+", 
             "2"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"PairedBarChart", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"data", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"PlotLabel", "->", 
              RowBox[{"\"\<Clusters \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"formatLettersFromList", "[", 
                 RowBox[{"data", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"BarSpacing", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "0", ",", "1"}], "}"}]}], 
             RowBox[{"(*", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0.5"}], "}"}], "*)"}], ",", 
             RowBox[{"Method", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\"\<LabelStyle\>\"", "\[Rule]", "\"\<Short\>\""}], 
               "}"}]}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", "\"\<Pastel\>\""}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", " ", "Automatic"}], "}"}]}], 
               "}"}]}], 
             RowBox[{"(*", 
              RowBox[{",", " ", 
               RowBox[{"ChartStyle", "->", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", 
                  RowBox[{"FontSize", "->", "25"}]}], "]"}]}]}], "*)"}], ",", 
             
             RowBox[{"LabelingFunction", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<\>\"", ",", "\"\<\>\"", ",", "#1", ",", "\"\<\>\""}],
                     "}"}], ",", "\"\<\>\""}], "]"}], ",", "Center"}], "]"}], 
                "&"}], ")"}]}], ",", 
             RowBox[{"ImageSize", "->", 
              RowBox[{"If", "[", 
               RowBox[{"reducedLabels", ",", 
                RowBox[{"{", 
                 RowBox[{"300", ",", "800"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"300", ",", "500"}], "}"}]}], 
               RowBox[{"(*", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"10", ",", "400"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"320", ",", "400"}], "}"}]}], "}"}], "*)"}], 
               "]"}]}], ",", 
             RowBox[{"ImageMargins", "\[Rule]", "1"}], ",", 
             RowBox[{"Frame", "->", "True"}], ",", 
             RowBox[{"PlotRange", "->", "All"}], ",", 
             RowBox[{"FrameStyle", "->", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", 
                RowBox[{"FontSize", "->", "16"}]}], "]"}]}], ",", 
             RowBox[{"LabelStyle", "->", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", 
                RowBox[{"FontSize", "->", "14"}]}], "]"}]}], ",", " ", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"If", "[", 
               RowBox[{"reducedLabels", ",", "3", ",", "1.8"}], "]"}]}], ",", 
             
             RowBox[{"ImagePadding", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "20"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"If", "[", 
               RowBox[{"reducedLabels", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", "3"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}], 
               "]"}]}], ",", 
             RowBox[{"FrameTicks", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"None", ",", "None"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"0", ",", "max", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"max", "/", "5"}], "]"}]}], "]"}], ",", "None"}], 
                 "}"}]}], "}"}]}], ",", 
             RowBox[{"ChartLabels", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"stringList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"stringList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "Above"}], 
                 "]"}], ",", "None", ",", 
                RowBox[{"If", "[", 
                 RowBox[{"reducedLabels", ",", 
                  RowBox[{"Placed", "[", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"#", ",", "Bold", ",", 
                    RowBox[{"FontSize", "->", "8"}]}], "]"}], "&"}], ",", 
                    "keyForChart"}], "]"}], ",", "\"\<LeftAxis\>\""}], "]"}], 
                  ",", 
                  RowBox[{"Placed", "[", 
                   RowBox[{"keyForChart", ",", "\"\<LeftAxis\>\""}], "]"}]}], 
                 "]"}]}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"createPairedChart", "/@", "data"}], ",", 
           RowBox[{"UpTo", "[", "cols", "]"}]}], "]"}], ",", 
         RowBox[{"Frame", "->", "None"}]}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotFinalBarCharts", "[", 
    RowBox[{"joinedData_", ",", "stringList_", ",", " ", 
     RowBox[{"reducedPlots_", ":", " ", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"max", ",", " ", "joinedInputs", ",", " ", "plotBasCharts"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"max", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "joinedData", "]"}], "+", "85"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"joinedInputs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"joinedData", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"stringList", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "stringList", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"plotBasCharts", "[", 
        RowBox[{"valuesInput_", ",", "max_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BarChart", "[", 
          RowBox[{
           RowBox[{"Values", "[", 
            RowBox[{"valuesInput", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"PlotLabel", "->", 
            RowBox[{"valuesInput", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"ChartLabels", "->", 
            RowBox[{"If", "[", 
             RowBox[{"reducedPlots", ",", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"formatLettersFromList", "[", "#", "]"}], "&"}], 
                  ",", 
                  RowBox[{"Keys", "[", 
                   RowBox[{"valuesInput", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
                "Axis", ",", 
                RowBox[{
                 RowBox[{"Rotate", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"45", " ", "Degree"}]}], "]"}], "&"}]}], "]"}], 
              ",", 
              RowBox[{"Keys", "[", 
               RowBox[{"valuesInput", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"FrameStyle", "->", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", 
              RowBox[{"FontSize", "->", 
               RowBox[{"If", "[", 
                RowBox[{"True", ",", "8", ",", "12"}], "]"}]}]}], "]"}]}], 
           ",", 
           RowBox[{"ChartStyle", "->", "\"\<Pastel\>\""}], ",", 
           RowBox[{"BarSpacing", "->", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "Automatic", ",", "Automatic"}], "}"}]}], 
           ",", 
           RowBox[{"LabelingFunction", "->", "Above"}], ",", 
           RowBox[{"Frame", "->", "True"}], ",", 
           RowBox[{"ImageSize", "->", "All"}], ",", 
           RowBox[{"PlotRange", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "max"}], "}"}]}], ",", 
           RowBox[{"ImageMargins", "->", "1"}], ",", 
           RowBox[{"PlotRangePadding", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "150"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "->", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", 
              RowBox[{"FontSize", "->", "8"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
      ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"exportFinalGridCounts", "=", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"plotBasCharts", "[", 
               RowBox[{"#", ",", "max"}], "]"}], "&"}], ",", "joinedInputs"}],
             "]"}], ",", 
           RowBox[{"UpTo", "[", "4", "]"}]}], "]"}], ",", 
         RowBox[{"Frame", "->", "None"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "exportFinalGridCounts"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9134786854577684`*^9, 3.9134786868327923`*^9}, {
   3.913479603878017*^9, 3.9134796200217*^9}, {3.9134796716868334`*^9, 
   3.913479675249343*^9}, 3.913479730425748*^9, {3.913479779965041*^9, 
   3.9134798126829176`*^9}, {3.9134798529204164`*^9, 3.913479857579625*^9}, {
   3.913479917428586*^9, 3.9134799930124216`*^9}, {3.913480051035106*^9, 
   3.913480051285136*^9}, 3.9135448910136995`*^9, {3.913544931601522*^9, 
   3.9135450216386895`*^9}, {3.9135460633245454`*^9, 
   3.9135460741592593`*^9}, {3.913546699801052*^9, 3.9135467007155633`*^9}, {
   3.91354685306069*^9, 3.913546888379805*^9}, {3.9135469361835537`*^9, 
   3.9135469363063173`*^9}, {3.9135469906207685`*^9, 
   3.9135469940140696`*^9}, {3.9135470336575074`*^9, 
   3.9135470617177935`*^9}, {3.9135471686177588`*^9, 3.913547194219179*^9}, {
   3.913547320360541*^9, 3.913547429252392*^9}, {3.913547509508667*^9, 
   3.9135475096524105`*^9}, {3.9135475936207895`*^9, 3.913547609202832*^9}, {
   3.9135477126162395`*^9, 3.9135477157298603`*^9}, {3.9135478436721134`*^9, 
   3.913547906534275*^9}, {3.913548000612625*^9, 3.9135480729995985`*^9}, {
   3.9135481115205045`*^9, 3.913548211637314*^9}, {3.913615175812538*^9, 
   3.9136151881058826`*^9}, 3.917108090363519*^9, {3.9181453896058164`*^9, 
   3.918145389844918*^9}, {3.9181454386263294`*^9, 3.918145581376909*^9}, {
   3.9181457919000826`*^9, 3.918145820962082*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"c2eec048-8b6f-4def-b123-8b2c6dd2a954"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Part 1 - Clusters\[CloseCurlyQuote] investigation using ellipsoid \
statistics:", "Title",
 CellChangeTimes->{{3.912803431861479*^9, 3.9128034397830853`*^9}, {
   3.9131091051094236`*^9, 3.9131091397425065`*^9}, {3.913111979249667*^9, 
   3.9131119830556126`*^9}, {3.913621795130267*^9, 3.913621795368944*^9}, {
   3.9136225684918084`*^9, 3.913622586631748*^9}, {3.913622650600486*^9, 
   3.913622651405878*^9}, {3.9136472831372952`*^9, 3.913647284208005*^9}, {
   3.924948476775714*^9, 3.9249484989529433`*^9}, {3.9249493877868357`*^9, 
   3.9249494647724066`*^9}, 3.9249495592380457`*^9, {3.924950403999075*^9, 
   3.9249504043191195`*^9}, 
   3.9249556651537457`*^9},ExpressionUUID->"4f2d8d24-b3fc-4cf6-8db5-\
a6ec296c26cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Load", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"loadAllData", "[", 
     RowBox[{"EuclideanDistance", ",", " ", "postotal"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"loadAllData", "[", 
      RowBox[{"ManhattanDistance", ",", "postotal"}], "]"}], ";"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Table", " ", "with", " ", "mean", " ", "and", " ", "standard", " ", 
     "deviations", " ", "of", " ", "each", " ", "cluster"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"clustersAndMarkersStatistics", "[", 
     RowBox[{
     "methodNBCdatabasinscentersTotal", ",", " ", 
      "methodNBCdatabasinssigmasTotal", ",", " ", "postotal"}], "]"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listaDeDatasets", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<methodNBCdataclustTotal\>\"", ",", " ", 
       "\"\<methodNBCdataclustBTS1\>\"", ",", " ", 
       "\"\<methodNBCdataclustBTS2\>\"", ",", " ", 
       "\"\<methodNBCdataclustBTS4\>\"", ",", " ", 
       "\"\<methodNBCdataclustBTS6\>\"", ",", 
       "\"\<methodNBCdataclustAllRegularCells\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<\\n\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{
         "\"\<Number of clusters - \>\"", "<>", "#", "<>", "\"\< :\>\""}], 
         ",", 
         RowBox[{"Dimensions", "[", 
          RowBox[{"ToExpression", "[", "#", "]"}], "]"}]}], "]"}], "&"}], ",",
       "listaDeDatasets"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.924951599635243*^9, 3.9249516031380615`*^9}, {
  3.9249517165466003`*^9, 3.9249517169222593`*^9}, {3.92495182110962*^9, 
  3.9249518213370113`*^9}, {3.924955760455921*^9, 3.9249557644476748`*^9}, {
  3.9249559264285784`*^9, 
  3.924955927457167*^9}},ExpressionUUID->"2200efca-a545-468b-ac35-\
191f77351649"],

Cell[CellGroupData[{

Cell["\<\
Data and ellipsoids; 95%, 68%, and 20%; 40 genes and 3 genes:\
\>", "Chapter",
 CellChangeTimes->{{3.924276133022518*^9, 3.9242761454675074`*^9}, 
   3.924276186332281*^9, {3.924276305412945*^9, 3.9242763534833508`*^9}, 
   3.924276402391062*^9, {3.924277958517528*^9, 3.9242779648382163`*^9}, 
   3.924955616431367*^9},ExpressionUUID->"cb12f38c-ebf2-4f77-a863-\
3eecf58037b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"orderedsim", "=", 
    RowBox[{"generateGaussianNoCrossCorrelated", "[", 
     RowBox[{
     "methodNBCdatabasinscentersTotal", ",", "methodNBCdatabasinssigmasTotal",
       ",", "methodNBCdataweightsTotal", ",", "True"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<95%: Gaussian X Gaussian (40 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{"orderedsim", ",", "orderedsim", ",", " ", "0", ",", "0.95"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<95%: Gaussian X Gaussian (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "orderedsim", ",", "orderedsim", ",", " ", "postotal", ",", "0.95"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<95%: BT_All X Gaussian (40 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "methodNBCdataclustTotal", ",", "orderedsim", ",", " ", "0", ",", "0.95"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<95%: BT_All X Gaussian (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "methodNBCdataclustTotal", ",", "orderedsim", ",", " ", "postotal", ",", 
   "0.95"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<95%: BT_All X BT_All (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"percentOfPointsInsideElipsoids", "[", 
   RowBox[{
   "methodNBCdataclustTotal", ",", "methodNBCdataclustTotal", ",", " ", 
    "postotal", ",", "0.95"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<68%: Gaussian X Gaussian (40 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{"orderedsim", ",", "orderedsim", ",", " ", "0", ",", "0.68"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<68%: Gaussian X Gaussian (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "orderedsim", ",", "orderedsim", ",", " ", "postotal", ",", "0.68"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<68%: BT_All X Gaussian (40 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "methodNBCdataclustTotal", ",", "orderedsim", ",", " ", "0", ",", "0.68"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<68%: BT_All X Gaussian (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "methodNBCdataclustTotal", ",", "orderedsim", ",", " ", "postotal", ",", 
   "0.68"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<68%: BT_All X BT_All (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"percentOfPointsInsideElipsoids", "[", 
   RowBox[{
   "methodNBCdataclustTotal", ",", "methodNBCdataclustTotal", ",", " ", 
    "postotal", ",", "0.68"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<20%: Gaussian X Gaussian (40 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{"orderedsim", ",", "orderedsim", ",", " ", "0", ",", "0.20"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<20%: Gaussian X Gaussian (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "orderedsim", ",", "orderedsim", ",", " ", "postotal", ",", "0.20"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<20%: BT_All X Gaussian (40 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "methodNBCdataclustTotal", ",", "orderedsim", ",", " ", "0", ",", "0.20"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<20%: BT_All X Gaussian (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"percentOfPointsInsideElipsoids", "[", 
  RowBox[{
  "methodNBCdataclustTotal", ",", "orderedsim", ",", " ", "postotal", ",", 
   "0.20"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<20%: BT_All X BT_All (3 genes)\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"percentOfPointsInsideElipsoids", "[", 
   RowBox[{
   "methodNBCdataclustTotal", ",", "methodNBCdataclustTotal", ",", " ", 
    "postotal", ",", "0.20"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9242764041322813`*^9, 3.924276428052699*^9}, {
  3.9242764587178574`*^9, 3.924276477703931*^9}, {3.924277397587818*^9, 
  3.9242774152755985`*^9}, {3.924277513237234*^9, 3.924277580330415*^9}, {
  3.924277642612602*^9, 3.9242779236054225`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"4538c991-eddc-41e7-b1aa-0b27e5bb2e45"]
}, Closed]],

Cell[CellGroupData[{

Cell["Verifying the unclustered points within ellipsoids :", "Chapter",
 CellChangeTimes->{{3.912791542727854*^9, 3.9127915523582716`*^9}, {
  3.9127993365202017`*^9, 3.9127993395605373`*^9}, {3.9127993845605984`*^9, 
  3.9127993864705315`*^9}, {3.917087700149686*^9, 3.917087702588772*^9}, {
  3.9170987338442707`*^9, 3.917098744338485*^9}, {3.9249518398797426`*^9, 
  3.9249518406295996`*^9}, {3.9249556240452137`*^9, 
  3.9249556274688516`*^9}},ExpressionUUID->"6c52182c-e4c2-460f-a80a-\
108252b47417"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"65c55a39-9fc6-4b85-ac24-2d487a13a81d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listaDeDatasets", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<methodNBCdataclustTotal\>\"", ",", " ", 
     "\"\<methodNBCdataclustBTS1\>\"", ",", " ", 
     "\"\<methodNBCdataclustBTS2\>\"", ",", " ", 
     "\"\<methodNBCdataclustBTS4\>\"", ",", " ", 
     "\"\<methodNBCdataclustBTS6\>\"", ",", 
     "\"\<methodNBCdataclustAllRegularCells\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<\\n\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
       "\"\<Number of clusters - \>\"", "<>", "#", "<>", "\"\< :\>\""}], ",", 
       
       RowBox[{"Dimensions", "[", 
        RowBox[{"ToExpression", "[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
    "listaDeDatasets"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<\\n\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"\"\<Values - \>\"", "<>", "#", "<>", "\"\<->\>\""}], ",", 
       RowBox[{"percentOfUnclusteredPointsInsideElipsoids", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"ToExpression", "[", "#", "]"}], ",", "1"}], "]"}], ",", 
         "methodNBCdataclustTotal", ",", " ", "postotal", ",", 
         "confidenceLevelDefaultValue"}], "]"}]}], "]"}], "&"}], ",", " ", 
    "listaDeDatasets"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9127925691892776`*^9, 3.912792589238303*^9}, {
   3.9127926798286123`*^9, 3.9127927250385065`*^9}, {3.9127927834005156`*^9, 
   3.9127927863184366`*^9}, {3.912792858128617*^9, 3.9127928775085115`*^9}, {
   3.9127932185085278`*^9, 3.912793218638486*^9}, {3.912793579881251*^9, 
   3.9127935813806744`*^9}, 3.912794761798678*^9, {3.91280233495688*^9, 
   3.9128023377263613`*^9}, {3.9128026301641717`*^9, 
   3.9128026326013594`*^9}, {3.9171832882034883`*^9, 3.917183321645528*^9}, {
   3.9249518197876296`*^9, 3.92495183380125*^9}, {3.924952100065451*^9, 
   3.9249521038282022`*^9}, {3.924952261751938*^9, 3.9249522631238365`*^9}, {
   3.9249557360671825`*^9, 
   3.9249557479840965`*^9}},ExpressionUUID->"be0d2e2b-fbe5-428d-8c83-\
579afae6058f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ellipsoids visualization", "Chapter",
 CellChangeTimes->{{3.9126960297532935`*^9, 3.9126960403602524`*^9}, {
  3.912712863999097*^9, 3.912712864186673*^9}, {3.912786294192947*^9, 
  3.912786295493093*^9}, {3.912791531144582*^9, 3.9127915325680857`*^9}, {
  3.9127993991001763`*^9, 3.9127993993799653`*^9}, {3.9249517767075567`*^9, 
  3.924951781346863*^9}},ExpressionUUID->"09cfeeff-3062-4b16-bf93-\
6b22fa922616"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"elipsoidPlotsEuc", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotPointsAndElipsoid", "[", 
       RowBox[{
        RowBox[{"orderedDataCluster", "[", 
         RowBox[{
         "methodNBCdataclustBTS1", ",", "methodNBCdataclustTotal", ",", 
          "postotal"}], "]"}], ",", "methodNBCdataclustTotal", ",", " ", 
        "postotal", ",", "confidenceLevelDefaultValue"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotPointsAndElipsoid", "[", 
       RowBox[{
        RowBox[{"orderedDataCluster", "[", 
         RowBox[{
         "methodNBCdataclustBTS2", ",", "methodNBCdataclustTotal", ",", 
          "postotal"}], "]"}], ",", "methodNBCdataclustTotal", ",", " ", 
        "postotal", ",", "confidenceLevelDefaultValue"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotPointsAndElipsoid", "[", 
       RowBox[{
        RowBox[{"orderedDataCluster", "[", 
         RowBox[{
         "methodNBCdataclustBTS4", ",", "methodNBCdataclustTotal", ",", 
          "postotal"}], "]"}], ",", "methodNBCdataclustTotal", ",", " ", 
        "postotal", ",", "confidenceLevelDefaultValue"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotPointsAndElipsoid", "[", 
       RowBox[{
        RowBox[{"orderedDataCluster", "[", 
         RowBox[{
         "methodNBCdataclustBTS6", ",", "methodNBCdataclustTotal", ",", 
          "postotal"}], "]"}], ",", "methodNBCdataclustTotal", ",", " ", 
        "postotal", ",", "confidenceLevelDefaultValue"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotPointsAndElipsoid", "[", 
       RowBox[{
       "methodNBCdataclustTotal", ",", "methodNBCdataclustTotal", ",", " ", 
        "postotal", ",", "confidenceLevelDefaultValue"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotPointsAndElipsoid", "[", 
       RowBox[{
        RowBox[{"orderedDataCluster", "[", 
         RowBox[{
         "methodNBCdataclustAllRegularCells", ",", "methodNBCdataclustTotal", 
          ",", "postotal"}], "]"}], ",", "methodNBCdataclustTotal", ",", " ", 
        "postotal", ",", "confidenceLevelDefaultValue"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotsPartitionedEuc", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{"elipsoidPlotsEuc", ",", "2"}], "]"}]}], ";"}], "\n", 
 RowBox[{"plotsPartitionedEucExport", "=", 
  RowBox[{"Grid", "[", 
   RowBox[{"plotsPartitionedEuc", ",", 
    RowBox[{"Frame", "->", "None"}], ",", 
    RowBox[{"Spacings", "->", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.912791611148204*^9, 3.9127916364112062`*^9}, {
   3.9127967909194784`*^9, 3.9127967920495367`*^9}, {3.912797361879681*^9, 
   3.912797535504345*^9}, {3.912797570539725*^9, 3.912797589859356*^9}, {
   3.91279768019952*^9, 3.9127976971198063`*^9}, 3.9127977502795763`*^9, {
   3.9127978988444395`*^9, 3.9127979056216884`*^9}, 3.9127980013145857`*^9, {
   3.9127980365695243`*^9, 3.912798038149731*^9}, {3.9127980741097507`*^9, 
   3.912798075959792*^9}, {3.9127981533498087`*^9, 3.912798153659765*^9}, {
   3.912802654216058*^9, 3.9128026639699907`*^9}, {3.9128030077209625`*^9, 
   3.912803015900841*^9}, {3.9131414553924894`*^9, 3.9131414635098124`*^9}, {
   3.9135613463223324`*^9, 3.9135613728400397`*^9}, {3.9135619517729025`*^9, 
   3.9135619520789332`*^9}, 3.9135623137395525`*^9, {3.9249514021581917`*^9, 
   3.9249514053811646`*^9}},ExpressionUUID->"1b8c263a-49dd-428e-8355-\
c0d4ee757cd8"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"41a829b6-cdcb-4bc6-a84c-ac93a4b7ceea"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Part 2 - GRN stochastic dynamics (timestep 0.05, Euler e SimTime 200):\
\>", "Title",
 CellChangeTimes->{{3.9128757659499702`*^9, 3.912875812715234*^9}, {
   3.9129310179554996`*^9, 3.9129310595252233`*^9}, {3.912931108058328*^9, 
   3.9129311088395815`*^9}, {3.9129314567518415`*^9, 
   3.9129314703461585`*^9}, {3.912932952236614*^9, 3.912932954571258*^9}, {
   3.912933386216301*^9, 3.9129333883613105`*^9}, {3.913027500894021*^9, 
   3.9130275308430147`*^9}, {3.9130305239230003`*^9, 3.913030531898495*^9}, 
   3.9131092300878453`*^9, {3.9131092704079204`*^9, 3.91310928902509*^9}, {
   3.9131115838722258`*^9, 3.913111587081572*^9}, {3.913111669532296*^9, 
   3.913111675777321*^9}, {3.9131119996349993`*^9, 3.913112001381317*^9}, 
   3.9131121422617965`*^9, {3.9133098916022725`*^9, 3.913309905906011*^9}, {
   3.913311405527177*^9, 3.9133114184864454`*^9}, {3.913345674177055*^9, 
   3.9133456839079065`*^9}, {3.9133716346018844`*^9, 
   3.9133716404653845`*^9}, {3.9135602355171328`*^9, 
   3.9135602359194417`*^9}, {3.913621805625018*^9, 3.9136218082343516`*^9}, {
   3.913645105252553*^9, 3.9136451198141823`*^9}, {3.917768848680534*^9, 
   3.917768866652109*^9}, {3.917769266685013*^9, 3.9177692706839185`*^9}, {
   3.917789844854822*^9, 3.9177898524415693`*^9}, {3.918207499627396*^9, 
   3.9182075028738823`*^9}, {3.919153140079104*^9, 3.9191531467956676`*^9}, {
   3.9192405132977543`*^9, 3.919240543313448*^9}, {3.9192633467800627`*^9, 
   3.9192633469039116`*^9}, {3.9192634125495996`*^9, 3.919263415297248*^9}, {
   3.9193364005233164`*^9, 3.9193364361519566`*^9}, {3.919662450809505*^9, 
   3.919662468939622*^9}, {3.9197764492901497`*^9, 3.919776477541849*^9}, {
   3.919776508823763*^9, 3.9197765089367127`*^9}, {3.9197965341583033`*^9, 
   3.919796539883659*^9}, {3.919797571760007*^9, 3.919797575503007*^9}, {
   3.919837567454906*^9, 3.919837577653017*^9}, {3.9198616007069883`*^9, 
   3.9198616151069884`*^9}, {3.920527636401201*^9, 3.920527648047057*^9}, {
   3.9205506595636115`*^9, 3.920550684612608*^9}, {3.924949616527505*^9, 
   3.924949665811819*^9}, 
   3.9249556692901163`*^9},ExpressionUUID->"9bbc45dc-4e97-4c19-a08a-\
d85976e2f2d5"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"35eefde8-bd9d-4cfb-8a03-3b1d18b0b1b6"],

Cell[CellGroupData[{

Cell["Run:", "Chapter",
 CellChangeTimes->{{3.913478900066908*^9, 3.913478927438167*^9}, {
  3.9249557944687147`*^9, 
  3.9249557969312096`*^9}},ExpressionUUID->"bfbfaee8-a322-4898-addd-\
c3c5cfe2a111"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"1e74293c-8ee8-46d3-84eb-bc561a498c59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "load"}]}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{"data", " ", "--"}], "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "-"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"loadAllData", "[", 
     RowBox[{"EuclideanDistance", ",", " ", "postotal"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"loadAllData", "[", 
      RowBox[{"ManhattanDistance", ",", "postotal"}], "]"}], ";"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.913645410310119*^9, 3.9136454109736533`*^9}, 
   3.9136459700125513`*^9, {3.917769877415677*^9, 3.9177698848822403`*^9}, {
   3.9249496325177917`*^9, 3.924949632779132*^9}, {3.924955973560195*^9, 
   3.9249559999152155`*^9}},ExpressionUUID->"ce1fcd7f-4181-4045-a00c-\
2026355c5000"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"d9ca6f67-26f1-4c51-ace3-9e1615f519c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Par", " ", "limits"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"parSinputs", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "4", ",", " ", "0.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parNinputs", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", " ", "0.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parsLimits", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "100"}], ",", " ", "10"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selectedNoiseFactor", " ", "=", " ", "0.001"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selectedTimeForSimulation", " ", "=", " ", "200"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"samplingsToRun", " ", "=", " ", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uniformSampling", " ", "=", " ", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pertubationAmplitude", " ", "=", " ", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"combinationsToTest", "=", "1"}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"all", " ", "combinations", " ", "mode"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{
     "aLLCOMBeuclideanListOfClutersCombinationsResult95", " ", "=", " ", 
      RowBox[{"clustersCombinationsMoreThanTwo", "[", 
       RowBox[{
       "methodNBCdataclustTotal", ",", "methodNBCdatabasinscentersTotal", ",",
         "methodNBCdatabasinssigmasTotal", ",", 
        "methodNBCdataweightspercTotal", ",", "parSinputs", ",", "parNinputs",
         ",", "parsLimits", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
         "}"}], ",", "samplingsToRun", ",", "uniformSampling", ",", "False", 
        ",", "0.95", ",", "pertubationAmplitude", ",", "postotal", ",", 
        "combinationsToTest", ",", " ", "selectedNoiseFactor", ",", 
        "selectedTimeForSimulation"}], "]"}]}], ";"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Dimensions", "[", "aLLCOMBeuclideanListOfClutersCombinationsResult95", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9128829574151096`*^9, 3.9128829579932003`*^9}, {
   3.9128830267376423`*^9, 3.912883036695286*^9}, {3.9129283621019087`*^9, 
   3.91292837233241*^9}, {3.912933609531368*^9, 3.912933612751748*^9}, 
   3.912940803254589*^9, 3.9131121535039225`*^9, {3.9131122819634867`*^9, 
   3.9131122821822443`*^9}, 3.9131127125753*^9, {3.913112746720853*^9, 
   3.9131127533799973`*^9}, {3.9131128971503863`*^9, 
   3.9131128984003553`*^9}, {3.913112993486577*^9, 3.913112995564706*^9}, {
   3.913113112558545*^9, 3.91311311273038*^9}, {3.9131133408611403`*^9, 
   3.913113352861147*^9}, {3.9131139249537106`*^9, 3.9131139251724005`*^9}, {
   3.913117345992011*^9, 3.913117351354551*^9}, {3.91312818418291*^9, 
   3.913128185883772*^9}, 3.9131360690868864`*^9, {3.913136860967101*^9, 
   3.9131368618277025`*^9}, {3.9131379359343843`*^9, 3.913137959610538*^9}, 
   3.9131391985635004`*^9, 3.913141749018691*^9, {3.913144731765959*^9, 
   3.9131447328284664`*^9}, 3.9132946999111614`*^9, {3.913300919983494*^9, 
   3.913300965515777*^9}, {3.9133010931886806`*^9, 3.9133010933502617`*^9}, {
   3.9133011299942446`*^9, 3.913301130462901*^9}, {3.913301625159283*^9, 
   3.9133016768704033`*^9}, {3.9133017454461203`*^9, 
   3.9133018142493496`*^9}, {3.9133053320181575`*^9, 
   3.9133053526255403`*^9}, {3.913309919243524*^9, 3.9133099912702723`*^9}, {
   3.913633475787121*^9, 3.9136334787201195`*^9}, {3.913637650901388*^9, 
   3.9136376975168395`*^9}, {3.91776900337056*^9, 3.917769004325926*^9}, {
   3.917769104640184*^9, 3.9177691247545443`*^9}, {3.9177699323617873`*^9, 
   3.9177699330772734`*^9}, {3.917770845692196*^9, 3.91777086262391*^9}, {
   3.9177709873504515`*^9, 3.9177709929108105`*^9}, {3.9191531150450907`*^9, 
   3.9191531227878933`*^9}, {3.9191532588017187`*^9, 
   3.9191532843337126`*^9}, {3.9191533197277036`*^9, 
   3.9191533462055025`*^9}, {3.9192406776752253`*^9, 3.919240678135*^9}, {
   3.9197765114767656`*^9, 3.919776511759226*^9}, {3.919837583104573*^9, 
   3.919837583338894*^9}, {3.9249559497751856`*^9, 
   3.9249559652475386`*^9}},ExpressionUUID->"4608ef18-8005-44ef-9b8b-\
f4d5a08d34b9"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"7a1cc7de-39ea-43b0-ae68-2277f69a32ce"],

Cell[BoxData[{
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"aLLCOMBeuclideanListOfClutersCombinationsResult68", " ", "=", " ", 
    RowBox[{"clustersCombinationsMoreThanTwo", "[", 
     RowBox[{
     "methodNBCdataclustTotal", ",", "methodNBCdatabasinscentersTotal", ",", 
      "methodNBCdatabasinssigmasTotal", ",", "methodNBCdataweightspercTotal", 
      ",", "parSinputs", ",", "parNinputs", ",", "parsLimits", ",", "1", ",", 
      
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
       "}"}], ",", "samplingsToRun", ",", "uniformSampling", ",", "False", 
      ",", "0.68", ",", "pertubationAmplitude", ",", "postotal", ",", 
      "combinationsToTest", ",", " ", "selectedNoiseFactor", ",", 
      "selectedTimeForSimulation"}], "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  "aLLCOMBeuclideanListOfClutersCombinationsResult68", "]"}]}], "Input",
 CellChangeTimes->{{3.913300953959995*^9, 3.9133009690359526`*^9}, {
   3.9133011134938784`*^9, 3.913301128146246*^9}, {3.9177708559256434`*^9, 
   3.917770866359124*^9}, 3.917791511785613*^9, {3.9191764627191863`*^9, 
   3.9191764765379496`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"67c6fe28-1412-49c3-a37e-c1bf3203c1e4"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"1d96dca8-6e7c-4207-968f-fe04b1717fc2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Dataset:", "Chapter",
 CellChangeTimes->{{3.912945128176713*^9, 3.9129452039817247`*^9}, {
  3.913011506085516*^9, 3.9130115134477396`*^9}, {3.9130124819873023`*^9, 
  3.913012483259848*^9}, {3.913021168247196*^9, 3.913021176825981*^9}, {
  3.9130251341480255`*^9, 3.9130251345808024`*^9}, {3.913026227461511*^9, 
  3.913026227672358*^9}, {3.9130305280694604`*^9, 3.9130305341273885`*^9}, {
  3.913037947160032*^9, 3.913037947495349*^9}, {3.9131115914356017`*^9, 
  3.9131116203994527`*^9}, {3.9249558004691615`*^9, 
  3.9249558026469407`*^9}},ExpressionUUID->"45f1825d-41a5-43f1-b123-\
5efb24874b7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"aLLCOMBdataSetCombinationsEuclidean95", "=", 
    RowBox[{"Dataset", "[", 
     RowBox[{"generateCombinationsDataset", "[", 
      RowBox[{"aLLCOMBeuclideanListOfClutersCombinationsResult95", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aLLCOMBdataSetCombinationsEuclidean68", "=", 
   RowBox[{"Dataset", "[", 
    RowBox[{"generateCombinationsDataset", "[", 
     RowBox[{"aLLCOMBeuclideanListOfClutersCombinationsResult68", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.912945207447652*^9, 3.912945208201603*^9}, {
   3.913007076086132*^9, 3.9130070790608883`*^9}, {3.913007151508969*^9, 
   3.913007152283636*^9}, 3.9130072725740643`*^9, {3.9130115330340595`*^9, 
   3.9130115765700893`*^9}, {3.913011666181028*^9, 3.913011762461102*^9}, {
   3.9130121572622375`*^9, 3.913012177700759*^9}, {3.9130122145215664`*^9, 
   3.913012218208539*^9}, {3.9130196433538256`*^9, 3.913019676240344*^9}, {
   3.913021050348611*^9, 3.913021053419903*^9}, {3.913111167560975*^9, 
   3.913111168014092*^9}, 3.913132920967244*^9, 3.9131386034030514`*^9, {
   3.913301844280699*^9, 3.913301897270574*^9}, {3.913302804631472*^9, 
   3.9133028052080016`*^9}, {3.913302933312106*^9, 3.913302933708305*^9}, {
   3.913309995148217*^9, 3.913310006681472*^9}, {3.9177691575702453`*^9, 
   3.9177691593122125`*^9}, 3.9177692290824666`*^9, 3.917789893146989*^9, {
   3.9178111957082543`*^9, 3.9178112006367335`*^9}, 3.9178112406627483`*^9, 
   3.9196624828406553`*^9, 3.9198349813269587`*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"4e8e8fc6-9966-461c-be29-2614b5ea51a6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Export Dataset:", "Chapter",
 CellChangeTimes->{{3.913026220068965*^9, 3.913026225609311*^9}, {
  3.91302632181822*^9, 3.913026323882101*^9}, {3.913030536410658*^9, 
  3.913030537752742*^9}, {3.9131116044851847`*^9, 3.913111619086955*^9}, {
  3.9249558045884295`*^9, 
  3.924955805161894*^9}},ExpressionUUID->"9593784d-8533-4f57-bc3e-\
3f4e38d6c0f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
    "\"\<aLLCOMBdataSetCombinationsEuclidean95_nSampling_\>\"", "<>", 
     RowBox[{"ToString", "[", "samplingsToRun", "]"}], "<>", 
     "\"\<.xlsx\>\""}], ",", " ", "aLLCOMBdataSetCombinationsEuclidean95"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<aLLCOMBdataSetCombinationsEuclidean68_nSampling_\>\"", "<>", 
    RowBox[{"ToString", "[", "samplingsToRun", "]"}], "<>", "\"\<.xlsx\>\""}],
    ",", " ", "aLLCOMBdataSetCombinationsEuclidean68"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9130259022239933`*^9, 3.913025962293153*^9}, 
   3.913026212518359*^9, {3.913113073585907*^9, 3.913113077452694*^9}, {
   3.913115220137586*^9, 3.9131152257531223`*^9}, {3.913299899286727*^9, 
   3.9132999054474688`*^9}, {3.9133019097860427`*^9, 
   3.9133019320276175`*^9}, {3.9133023554608316`*^9, 
   3.9133023734362445`*^9}, {3.9133045925774903`*^9, 
   3.9133046032127953`*^9}, {3.9133100206076684`*^9, 3.913310031680015*^9}, {
   3.9134466541320367`*^9, 3.9134466619837055`*^9}, {3.9135579026405735`*^9, 
   3.913557907696856*^9}, {3.913628349179145*^9, 3.913628367706627*^9}, {
   3.917769166326332*^9, 3.917769167813549*^9}, 3.9177692234341793`*^9, 
   3.9177899034671803`*^9, {3.917811249277705*^9, 3.9178112828325434`*^9}, {
   3.9196624979890313`*^9, 3.9196625090474186`*^9}, 3.919834990208682*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"da4ae013-b9e5-4b39-a02f-18c45901ef6c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Import Datasets :", "Chapter",
 CellChangeTimes->{{3.9135514207791433`*^9, 3.9135514364441357`*^9}, {
   3.913555374718976*^9, 3.913555377308787*^9}, 3.9135590610793037`*^9, {
   3.924955806256939*^9, 
   3.92495580688428*^9}},ExpressionUUID->"cbc4e5f4-ba20-40a7-8af5-\
417e85f65128"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aLLCOMBdataSetCombinationsEuclidean95Imported", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"\"\<aLLCOMBdataSetCombinationsEuclidean95_nSampling_\>\"", "<>", 
      RowBox[{"ToString", "[", "samplingsToRun", "]"}], "<>", 
      "\"\<.xlsx\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Dataset\>\"", ",", "1"}], "}"}], ",", 
     RowBox[{"\"\<HeaderLines\>\"", "->", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aLLCOMBdataSetCombinationsEuclidean95Imported", " ", "=", " ", 
    RowBox[{"aLLCOMBdataSetCombinationsEuclidean95Imported", "[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Combination\>\"", "->", "ToExpression"}], ",", 
        RowBox[{"\"\<ParIndex\>\"", "->", "Round"}], ",", " ", 
        RowBox[{"\"\<ClusterFilled\>\"", "->", "ToExpression"}]}], "}"}]}], 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aLLCOMBdataSetCombinationsEuclidean68Imported", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"\"\<aLLCOMBdataSetCombinationsEuclidean68_nSampling_\>\"", "<>", 
      RowBox[{"ToString", "[", "samplingsToRun", "]"}], "<>", 
      "\"\<.xlsx\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Dataset\>\"", ",", "1"}], "}"}], ",", 
     RowBox[{"\"\<HeaderLines\>\"", "->", "1"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"aLLCOMBdataSetCombinationsEuclidean68Imported", " ", "=", " ", 
   RowBox[{"aLLCOMBdataSetCombinationsEuclidean68Imported", "[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Combination\>\"", "->", "ToExpression"}], ",", 
       RowBox[{"\"\<ParIndex\>\"", "->", "Round"}], ",", " ", 
       RowBox[{"\"\<ClusterFilled\>\"", "->", "ToExpression"}]}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9135514378535957`*^9, 3.9135514388132505`*^9}, {
   3.9135515481565895`*^9, 3.913551567718912*^9}, 3.9135516107434654`*^9, 
   3.913551665739202*^9, {3.913552163646327*^9, 3.9135521730613647`*^9}, {
   3.9135529566842794`*^9, 3.9135529592359357`*^9}, {3.913554578038339*^9, 
   3.913554599097438*^9}, 3.9135546417006826`*^9, {3.913554717805504*^9, 
   3.9135547811299696`*^9}, {3.913557928287691*^9, 3.913558023732362*^9}, {
   3.9135581026288376`*^9, 3.9135581052913795`*^9}, 3.9135582125802326`*^9, {
   3.913628450634841*^9, 3.9136284914073296`*^9}, {3.913637507350194*^9, 
   3.913637528824236*^9}, {3.917769185422284*^9, 3.917769187822073*^9}, 
   3.91778993545436*^9, {3.9178112928783045`*^9, 3.917811306969483*^9}, 
   3.919662526489689*^9, 3.919834998113717*^9},
 CellLabel->"In[97]:=",ExpressionUUID->"59919df2-7179-4fdf-a7c0-3b3f975d3834"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"c6755539-ff36-4fa3-9055-36b66626ba5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "aLLCOMBdataSetCombinationsEuclidean95", "=", " ", 
    "aLLCOMBdataSetCombinationsEuclidean95Imported"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
  "aLLCOMBdataSetCombinationsEuclidean68", "=", " ", 
   "aLLCOMBdataSetCombinationsEuclidean68Imported"}], ";"}]}], "Input",
 CellChangeTimes->{{3.913628496947154*^9, 3.913628557384691*^9}, {
   3.917769189582035*^9, 3.9177692182205353`*^9}, 3.917789944961376*^9, {
   3.917811311884452*^9, 3.9178113240073743`*^9}, 3.9196625699907207`*^9, 
   3.9198350119480257`*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"6692b9e8-04ed-42b4-91b7-7792350be567"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clusters frequency:", "Chapter",
 CellChangeTimes->{{3.9130262432889605`*^9, 3.9130262789167676`*^9}, {
  3.9130267867479887`*^9, 3.9130267891787715`*^9}, {3.913027318600605*^9, 
  3.9130273511499825`*^9}, {3.9130302518501368`*^9, 3.913030252390017*^9}, {
  3.913030540612295*^9, 3.9130305654765177`*^9}, {3.9131115280079722`*^9, 
  3.9131115402164116`*^9}, {3.913111608637454*^9, 3.9131116159717655`*^9}, {
  3.9133058021358013`*^9, 3.913305812282806*^9}, {3.9249558122537513`*^9, 
  3.9249558136568227`*^9}},ExpressionUUID->"89099264-fd37-45dc-8a49-\
6085ee08e9fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"aLLcombinationsStatisticsEuclidean95", "=", " ", 
    RowBox[{"returnClustersCombinationsStatistics", "[", 
     RowBox[{"aLLCOMBdataSetCombinationsEuclidean95", ",", " ", "False"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aLLcombinationsStatisticsEuclidean68", " ", "=", " ", 
   RowBox[{"returnClustersCombinationsStatistics", "[", 
    RowBox[{"aLLCOMBdataSetCombinationsEuclidean68", ",", " ", "False"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9130211622599506`*^9, 3.913021162278117*^9}, {
   3.913021201900738*^9, 3.9130212318734384`*^9}, {3.9130214191857967`*^9, 
   3.913021536870433*^9}, {3.9130217214504623`*^9, 3.913021762059764*^9}, {
   3.913021833701209*^9, 3.9130218690949497`*^9}, {3.9130219550638113`*^9, 
   3.9130219577987213`*^9}, 3.9130221377339687`*^9, {3.91302217215467*^9, 
   3.913022172433539*^9}, {3.9130223066775303`*^9, 3.9130223330011225`*^9}, {
   3.913022367922946*^9, 3.9130223792902255`*^9}, {3.9130224181209197`*^9, 
   3.913022448689354*^9}, {3.913022544175537*^9, 3.91302257434938*^9}, {
   3.913022623177806*^9, 3.9130226498258853`*^9}, {3.913022752129284*^9, 
   3.913022810995989*^9}, {3.913022915707344*^9, 3.913022939081813*^9}, {
   3.9130230031873465`*^9, 3.9130230263340664`*^9}, {3.913023064297579*^9, 
   3.913023132698499*^9}, {3.9130245527030215`*^9, 3.9130245573134813`*^9}, {
   3.9130247794641933`*^9, 3.9130247972113543`*^9}, {3.913024841465122*^9, 
   3.913024890037412*^9}, {3.913025049633424*^9, 3.9130250665638423`*^9}, 
   3.913026262273732*^9, {3.9131112183306503`*^9, 3.913111219127531*^9}, {
   3.913111252902014*^9, 3.9131112557204075`*^9}, {3.9133024604901485`*^9, 
   3.913302486463955*^9}, {3.9133025205154424`*^9, 3.913302666788213*^9}, {
   3.913302770522726*^9, 3.913302797833209*^9}, {3.913310040275882*^9, 
   3.913310044565173*^9}, {3.91344621612429*^9, 3.913446266306902*^9}, {
   3.9134463686552973`*^9, 3.913446369046005*^9}, {3.913446631810856*^9, 
   3.913446638814938*^9}, {3.9134664143028536`*^9, 3.913466437294261*^9}, {
   3.9134664703439856`*^9, 3.9134664818765893`*^9}, {3.9177692422696533`*^9, 
   3.917769244874569*^9}, {3.917789960795057*^9, 3.917789992972703*^9}, {
   3.9178113334055014`*^9, 3.9178113452623*^9}, 3.9196625832187138`*^9, 
   3.9198350256638455`*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"b8d36324-1af0-4e1c-a1d7-495eaa35f74b"]
}, Closed]],

Cell[CellGroupData[{

Cell["BarChart:", "Chapter",
 CellChangeTimes->{{3.913445291537715*^9, 3.913445298824132*^9}, 
   3.9134464801016912`*^9},ExpressionUUID->"c7b2d7d0-ad51-4160-9258-\
28fcea68850a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CreateBarChartsGrid", "[", 
  RowBox[{"aLLcombinationsStatisticsEuclidean95", "[", 
   RowBox[{"[", "index", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CreateBarChartsGrid", "[", "#", "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"combinationsStatisticsEuclidean95One", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"combinationsStatisticsEuclidean68One", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"combinationsStatisticsManhattan95One", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"combinationsStatisticsManhattan68One", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "}"}], ",", 
     RowBox[{"Frame", "->", "False"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9134440778620906`*^9, 3.9134441659585485`*^9}, {
   3.913444510752492*^9, 3.913444511205617*^9}, {3.9134445769439983`*^9, 
   3.9134445845499754`*^9}, {3.91344479679699*^9, 3.9134448017477365`*^9}, {
   3.9134448357867413`*^9, 3.91344495082681*^9}, {3.9134450386338015`*^9, 
   3.913445041900323*^9}, {3.9134464814298735`*^9, 3.9134464964330254`*^9}, 
   3.91344658785428*^9, {3.913472143603236*^9, 3.9134721510170116`*^9}, {
   3.9134721948516493`*^9, 3.913472195390217*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"d1a182e3-959a-4cfd-bed7-7d1cc75d7230"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CreateBarChartsGrid", "[", 
  RowBox[{
   RowBox[{"aLLcombinationsStatisticsEuclidean95", "[", 
    RowBox[{"[", "index", "]"}], "]"}], ",", "True"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9134721680014744`*^9, 3.9134721709514103`*^9}, {
  3.9134722072274084`*^9, 3.913472207820735*^9}, {3.9134733894265785`*^9, 
  3.913473392400719*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"c2547657-2028-4a30-9ef1-1a88c64017e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Grid of paried barcharts:", "Chapter",
 CellChangeTimes->{{3.9134452550079117`*^9, 3.9134453015158143`*^9}, {
  3.924956041396064*^9, 
  3.924956048733224*^9}},ExpressionUUID->"f5d388a5-6034-42c0-88ea-\
302df455d5af"],

Cell[CellGroupData[{

Cell["Euclidean for parameters:", "Section",
 CellChangeTimes->{{3.913446864624988*^9, 3.91344686839231*^9}, {
   3.913548354787798*^9, 3.91354835657521*^9}, 
   3.9135492370892467`*^9},ExpressionUUID->"63526fe6-79e4-4d1c-aa4e-\
98b3ab92eb7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refPairedBarChartData1", " ", "=", " ", 
   RowBox[{"KeySort", "[", 
    RowBox[{"aLLcombinationsStatisticsEuclidean68", "[", 
     RowBox[{"[", "index", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"editedPairedBarChartData1", " ", "=", " ", 
   RowBox[{"aLLcombinationsStatisticsEuclidean95", "[", 
    RowBox[{"[", "index", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"editedPairedBarChartData1", " ", "=", " ", 
    RowBox[{"KeySort", "[", 
     RowBox[{"KeyTake", "[", 
      RowBox[{"editedPairedBarChartData1", ",", 
       RowBox[{"Keys", "[", "refPairedBarChartData1", "]"}]}], "]"}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Keys", "[", "editedPairedBarChartData1", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"Keys", "[", "refPairedBarChartData1", "]"}]}], "Input",
 CellChangeTimes->{{3.918476778806526*^9, 3.9184768639866037`*^9}, {
  3.9184771174766836`*^9, 3.9184771838778505`*^9}, {3.9184773880612535`*^9, 
  3.9184774040490913`*^9}, {3.9184774612104464`*^9, 3.918477513240808*^9}, {
  3.9184777698176346`*^9, 3.9184777854298067`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"3ec0b29c-cb26-4794-8726-3fb8f51ed81c"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"d5c10137-ae46-4019-afc2-87b17918c547"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfPairedBarChart", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"7", ",", "9", ",", "11", ",", "12", ",", "13"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"export1", " ", "=", " ", 
  RowBox[{"CreatePairedBarChartsGrid", "[", 
   RowBox[{
    RowBox[{"editedPairedBarChartData1", "[", 
     RowBox[{"[", "listOfPairedBarChart", "]"}], "]"}], ",", 
    RowBox[{"refPairedBarChartData1", "[", 
     RowBox[{"[", "listOfPairedBarChart", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<95%\>\"", ",", " ", "\"\<68%\>\""}], "}"}], ",", "False", 
    ",", "5"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.913544616614406*^9, 3.9135446353081236`*^9}, 
   3.9135446889298515`*^9, {3.913545178350252*^9, 3.9135452843959475`*^9}, {
   3.9135453996069994`*^9, 3.9135454607089586`*^9}, {3.9135460275068536`*^9, 
   3.913546030453502*^9}, {3.91354610248769*^9, 3.9135461088215494`*^9}, {
   3.9184772070875797`*^9, 3.9184772556436324`*^9}, {3.918477294323326*^9, 
   3.9184773111018343`*^9}, {3.9184775352019024`*^9, 3.918477558819763*^9}, {
   3.9184778000072246`*^9, 3.918477810069249*^9}, {3.9184795276737986`*^9, 
   3.9184795352690916`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"d31c1315-c376-4e51-a4e9-8213be638fce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CreatePairedBarChartsGrid", "[", 
  RowBox[{
   RowBox[{"aLLcombinationsStatisticsEuclidean95", "[", 
    RowBox[{"[", "index", "]"}], "]"}], ",", 
   RowBox[{"aLLcombinationsStatisticsEuclidean68", "[", 
    RowBox[{"[", "index", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<Euclidean 95%\>\"", ",", " ", "\"\<Euclidean 68%\>\""}], 
    "}"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9134441339525256`*^9, 3.913444135311921*^9}, {
   3.913444970158107*^9, 3.9134450361803813`*^9}, {3.9134451330033355`*^9, 
   3.9134451597192907`*^9}, {3.913446840148013*^9, 3.91344685262772*^9}, 
   3.9134468839469137`*^9, {3.9134719452397556`*^9, 3.9134719647108545`*^9}, 
   3.913480113573537*^9, {3.9136152295649896`*^9, 3.9136152300144444`*^9}, {
   3.9178122443527226`*^9, 3.9178122685216455`*^9}, {3.917812465633696*^9, 
   3.9178124661087313`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"fe1ea6df-d321-40c9-9334-a8aa3e484e22"]
}, Closed]],

Cell[CellGroupData[{

Cell["Euclidean for combinations:", "Section",
 CellChangeTimes->{{3.91354832061732*^9, 
  3.9135483407595234`*^9}},ExpressionUUID->"41ade62c-89b1-46a2-8508-\
0a2c073994c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refPairedBarChartData2", " ", "=", " ", 
   RowBox[{"KeySort", "[", 
    RowBox[{"aLLcombinationsStatisticsEuclidean68", "[", 
     RowBox[{"[", "index", "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"editedPairedBarChartData2", " ", "=", " ", 
   RowBox[{"aLLcombinationsStatisticsEuclidean95", "[", 
    RowBox[{"[", "index", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"editedPairedBarChartData2", " ", "=", " ", 
    RowBox[{"KeySort", "[", 
     RowBox[{"KeyTake", "[", 
      RowBox[{"editedPairedBarChartData2", ",", 
       RowBox[{"Keys", "[", "refPairedBarChartData2", "]"}]}], "]"}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Keys", "[", "editedPairedBarChartData2", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"Keys", "[", "refPairedBarChartData2", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9184777521704693`*^9, 3.918477760853181*^9}, {
  3.9184778256622486`*^9, 3.9184778355473375`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"885a869c-5423-4604-9430-bdc5da44d531"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"2c273f17-e74c-4a6c-a112-6288a329a15f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfPairedBarChart2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"7", ",", "9", ",", "11", ",", "12", ",", "13"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"export2", " ", "=", " ", 
  RowBox[{"CreatePairedBarChartsGrid", "[", 
   RowBox[{
    RowBox[{"editedPairedBarChartData2", "[", 
     RowBox[{"[", "listOfPairedBarChart2", "]"}], "]"}], ",", 
    RowBox[{"refPairedBarChartData2", "[", 
     RowBox[{"[", "listOfPairedBarChart2", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<95%\>\"", ",", " ", "\"\<68%\>\""}], "}"}], ",", "True", 
    ",", "5"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.913548508766282*^9, 3.913548542461239*^9}, {
  3.9135485896572638`*^9, 3.913548590264924*^9}, {3.91847788777419*^9, 
  3.9184779197835197`*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"841fe5d2-47d4-4855-a8a7-894333ac9106"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CreatePairedBarChartsGrid", "[", 
  RowBox[{
   RowBox[{"aLLcombinationsStatisticsEuclidean95", "[", 
    RowBox[{"[", "index", "]"}], "]"}], ",", 
   RowBox[{"aLLcombinationsStatisticsEuclidean68", "[", 
    RowBox[{"[", "index", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<Euclidean 95%\>\"", ",", " ", "\"\<Euclidean 68%\>\""}], 
    "}"}], ",", "True"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9134720106789293`*^9, 3.9134720146721277`*^9}, {
   3.91347280974119*^9, 3.9134728629718957`*^9}, {3.9134740319917355`*^9, 
   3.9134740330270452`*^9}, 3.91347782599238*^9, {3.913477856636696*^9, 
   3.9134778886247044`*^9}, {3.9134779415958652`*^9, 3.913477944300678*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"b9c62656-00fe-4101-a5a6-19309f421611"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Final totals bar chart:", "Chapter",
 CellChangeTimes->{{3.9136152472954164`*^9, 
  3.913615256427146*^9}},ExpressionUUID->"91ef3560-e175-4170-a688-\
3956948aaa86"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eucl95", "=", 
   RowBox[{"aLLcombinationsStatisticsEuclidean95", "[", 
    RowBox[{"[", "index", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eucl68", "=", 
    RowBox[{"aLLcombinationsStatisticsEuclidean68", "[", 
     RowBox[{"[", "index", "]"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"joinedData", "=", 
    RowBox[{"{", 
     RowBox[{"eucl95", ",", "eucl68"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"stringList", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<95%\>\"", ",", "\"\<68%\>\""}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"plotFinalBarCharts", "[", 
  RowBox[{"joinedData", ",", "stringList", ",", "True"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.913568610421042*^9, 3.9135686164193583`*^9}, {
   3.9135689414023447`*^9, 3.9135689489953213`*^9}, {3.913569253062726*^9, 
   3.9135693190702276`*^9}, {3.913569386130526*^9, 3.9135694267035255`*^9}, {
   3.9135695058219824`*^9, 3.9135695719689903`*^9}, {3.9135696320631003`*^9, 
   3.9135696326575203`*^9}, {3.9135697572731857`*^9, 
   3.9135698688490458`*^9}, {3.9135700050944614`*^9, 3.913570006052429*^9}, {
   3.9135700689952064`*^9, 3.913570080315501*^9}, {3.9135701724592185`*^9, 
   3.913570217739686*^9}, {3.9135702947575006`*^9, 3.9135703092730274`*^9}, {
   3.9135703402027884`*^9, 3.9135703854000216`*^9}, {3.9135704883912153`*^9, 
   3.9135706509652195`*^9}, 3.9135706874510975`*^9, {3.91357073155933*^9, 
   3.9135708364516354`*^9}, {3.9135709419423428`*^9, 
   3.9135710935383425`*^9}, {3.913571136117234*^9, 3.9135711528970995`*^9}, {
   3.913572046472575*^9, 3.913572172563069*^9}, {3.9135722090310636`*^9, 
   3.913572243110546*^9}, {3.9135723434143467`*^9, 3.913572408720065*^9}, {
   3.9135724390022154`*^9, 3.913572513802946*^9}, {3.9135726497938356`*^9, 
   3.9135728027714205`*^9}, {3.913572840727084*^9, 3.9135728518843904`*^9}, {
   3.9135728890887237`*^9, 3.9135728946647635`*^9}, {3.913572965245923*^9, 
   3.913572993360792*^9}, {3.9135730744897895`*^9, 3.9135731318777313`*^9}, {
   3.9135731765586143`*^9, 3.9135732105306635`*^9}, {3.9135732764245667`*^9, 
   3.913573322603728*^9}, 3.913573467692922*^9, {3.9135735020968175`*^9, 
   3.913573521022752*^9}, {3.9135736298509808`*^9, 3.913573787512083*^9}, {
   3.9135738604496512`*^9, 3.9135739268984537`*^9}, {3.913574307455318*^9, 
   3.9135743084390497`*^9}, 3.91361485899165*^9, {3.9136149252490554`*^9, 
   3.9136150328558226`*^9}, {3.913615080398836*^9, 3.913615138831606*^9}, {
   3.913615212035259*^9, 3.9136152324575353`*^9}, {3.917769381862419*^9, 
   3.9177693912533503`*^9}, {3.9181446953380165`*^9, 3.918144699368535*^9}, {
   3.9184814287591605`*^9, 3.9184814292194576`*^9}, {3.9191526271120453`*^9, 
   3.9191526275620346`*^9}, {3.9196626059967613`*^9, 
   3.9196626192069845`*^9}, {3.9198350402285395`*^9, 3.919835048833623*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"08f0eed2-89d8-4592-bb3f-a1282984ac61"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Part 2.1 - Testing sensitivity to initial conditions:", "Title",
 CellChangeTimes->{{3.9128757659499702`*^9, 3.912875812715234*^9}, {
   3.9129310179554996`*^9, 3.9129310595252233`*^9}, {3.912931108058328*^9, 
   3.9129311088395815`*^9}, {3.9129314567518415`*^9, 
   3.9129314703461585`*^9}, {3.912932952236614*^9, 3.912932954571258*^9}, {
   3.912933386216301*^9, 3.9129333883613105`*^9}, {3.913027500894021*^9, 
   3.9130275308430147`*^9}, {3.9130305239230003`*^9, 3.913030531898495*^9}, 
   3.9131092300878453`*^9, {3.9131092704079204`*^9, 3.91310928902509*^9}, {
   3.9131115838722258`*^9, 3.913111587081572*^9}, {3.913111669532296*^9, 
   3.913111675777321*^9}, {3.9131119996349993`*^9, 3.913112001381317*^9}, 
   3.9131121422617965`*^9, {3.9133098916022725`*^9, 3.913309905906011*^9}, {
   3.913311405527177*^9, 3.9133114184864454`*^9}, {3.913345674177055*^9, 
   3.9133456839079065`*^9}, {3.9133716346018844`*^9, 
   3.9133716404653845`*^9}, {3.9135602355171328`*^9, 
   3.9135602359194417`*^9}, {3.913621805625018*^9, 3.9136218082343516`*^9}, {
   3.913645105252553*^9, 3.9136451198141823`*^9}, {3.913645279628931*^9, 
   3.9136453026651583`*^9}, {3.9136458962355785`*^9, 3.913645909806609*^9}, {
   3.9136460900846443`*^9, 3.9136461272436132`*^9}, {3.9136462375673857`*^9, 
   3.9136462378581743`*^9}, {3.9182074873166018`*^9, 3.918207495860358*^9}, {
   3.918208108280859*^9, 3.9182081088694754`*^9}, {3.9249480811902776`*^9, 
   3.924948083680539*^9}, {3.924949749139724*^9, 3.9249497972800083`*^9}, {
   3.9249556713462396`*^9, 
   3.924955703496906*^9}},ExpressionUUID->"4a49397b-dfaa-4fab-a799-\
50485f45264a"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"8c924cbb-7295-481c-a98d-73ed066a6f6c"],

Cell[CellGroupData[{

Cell["Run:", "Chapter",
 CellChangeTimes->{{3.913478900066908*^9, 3.913478927438167*^9}, {
  3.913645420481822*^9, 3.9136454213321395`*^9}, {3.924955821289812*^9, 
  3.924955821368812*^9}},ExpressionUUID->"e34d1864-c803-4fa2-83b6-\
09ec1c25c247"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"0a24b4b5-0334-47c3-aa8a-0e817ef5fdb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", " ", "load"}]}]}]}]}]}]}]}], " ", 
     RowBox[{
      RowBox[{
       RowBox[{"data", " ", "--"}], "--"}], "--"}]}], "-", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "-"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"loadAllData", "[", 
     RowBox[{"EuclideanDistance", ",", " ", "postotal"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"loadAllData", "[", 
      RowBox[{"ManhattanDistance", ",", "postotal"}], "]"}], ";"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"-", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.913645410310119*^9, 3.9136454109736533`*^9}, 
   3.9136459700125513`*^9, {3.917769889389367*^9, 3.91776989338654*^9}, 
   3.924956075549162*^9},ExpressionUUID->"475cc5df-4c8c-4221-bfe5-\
b06fc8ac7b11"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"16c0225e-9d22-4588-bd7c-3cf033667d0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Par", " ", "limits"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"parSinputs", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "4", ",", " ", "0.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parNinputs", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", " ", "0.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parsLimits", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "100"}], ",", " ", "10"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selectedNoiseFactor", " ", "=", " ", "0.001"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"selectedTimeForSimulation", " ", "=", " ", "200"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"samplingsToRun", " ", "=", " ", "5"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uniformSampling", " ", "=", " ", "5"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pertubationAmplitude", " ", "=", " ", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"combinationsToTest", "=", "1"}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{"all", " ", "combinations", " ", "mode"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{
     "uniformALLCOMBeuclideanListOfClutersCombinationsResult95", " ", "=", 
      " ", 
      RowBox[{"clustersCombinationsMoreThanTwo", "[", 
       RowBox[{
       "methodNBCdataclustTotal", ",", "methodNBCdatabasinscentersTotal", ",",
         "methodNBCdatabasinssigmasTotal", ",", 
        "methodNBCdataweightspercTotal", ",", "parSinputs", ",", "parNinputs",
         ",", "parsLimits", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
         "}"}], ",", "samplingsToRun", ",", "uniformSampling", ",", "False", 
        ",", "0.95", ",", "pertubationAmplitude", ",", "postotal", ",", 
        "combinationsToTest", ",", " ", "selectedNoiseFactor", ",", 
        "selectedTimeForSimulation"}], "]"}]}], ";"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Dimensions", "[", "aLLCOMBeuclideanListOfClutersCombinationsResult95", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9128829574151096`*^9, 3.9128829579932003`*^9}, {
   3.9128830267376423`*^9, 3.912883036695286*^9}, {3.9129283621019087`*^9, 
   3.91292837233241*^9}, {3.912933609531368*^9, 3.912933612751748*^9}, 
   3.912940803254589*^9, 3.9131121535039225`*^9, {3.9131122819634867`*^9, 
   3.9131122821822443`*^9}, 3.9131127125753*^9, {3.913112746720853*^9, 
   3.9131127533799973`*^9}, {3.9131128971503863`*^9, 
   3.9131128984003553`*^9}, {3.913112993486577*^9, 3.913112995564706*^9}, {
   3.913113112558545*^9, 3.91311311273038*^9}, {3.9131133408611403`*^9, 
   3.913113352861147*^9}, {3.9131139249537106`*^9, 3.9131139251724005`*^9}, {
   3.913117345992011*^9, 3.913117351354551*^9}, {3.91312818418291*^9, 
   3.913128185883772*^9}, 3.9131360690868864`*^9, {3.913136860967101*^9, 
   3.9131368618277025`*^9}, {3.9131379359343843`*^9, 3.913137959610538*^9}, 
   3.9131391985635004`*^9, 3.913141749018691*^9, {3.913144731765959*^9, 
   3.9131447328284664`*^9}, 3.9132946999111614`*^9, {3.913300919983494*^9, 
   3.913300965515777*^9}, {3.9133010931886806`*^9, 3.9133010933502617`*^9}, {
   3.9133011299942446`*^9, 3.913301130462901*^9}, {3.913301625159283*^9, 
   3.9133016768704033`*^9}, {3.9133017454461203`*^9, 
   3.9133018142493496`*^9}, {3.9133053320181575`*^9, 
   3.9133053526255403`*^9}, {3.913309919243524*^9, 3.9133099912702723`*^9}, {
   3.913633475787121*^9, 3.9136334787201195`*^9}, {3.913637650901388*^9, 
   3.9136376975168395`*^9}, {3.913645747931135*^9, 3.9136457802314267`*^9}, {
   3.913645815302504*^9, 3.913645816659811*^9}, {3.9136460710472517`*^9, 
   3.913646086230914*^9}, {3.9136462440688705`*^9, 3.9136462615210485`*^9}, {
   3.913646717253581*^9, 3.9136467578071632`*^9}, {3.91364682643826*^9, 
   3.913646846172398*^9}, {3.913693620046726*^9, 3.9136936252603364`*^9}, 
   3.9182083477132196`*^9, 3.9182083961005907`*^9, 3.920624146339168*^9, {
   3.9249560902184253`*^9, 
   3.924956099848258*^9}},ExpressionUUID->"01ff6cfd-05ba-4872-b97b-\
30ff5d6ef895"],

Cell[" ", "Text",
 Editable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellSize->{
  Inherited, 3},ExpressionUUID->"8afbaca8-fbb5-4471-b09a-aeef69e14970"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Dataset:", "Chapter",
 CellChangeTimes->{{3.912945128176713*^9, 3.9129452039817247`*^9}, {
  3.913011506085516*^9, 3.9130115134477396`*^9}, {3.9130124819873023`*^9, 
  3.913012483259848*^9}, {3.913021168247196*^9, 3.913021176825981*^9}, {
  3.9130251341480255`*^9, 3.9130251345808024`*^9}, {3.913026227461511*^9, 
  3.913026227672358*^9}, {3.9130305280694604`*^9, 3.9130305341273885`*^9}, {
  3.913037947160032*^9, 3.913037947495349*^9}, {3.9131115914356017`*^9, 
  3.9131116203994527`*^9}, {3.9249558236131525`*^9, 
  3.924955825577636*^9}},ExpressionUUID->"d7913a20-a875-4475-adac-\
6692bfdfdbad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uniformALLCOMBdataSetCombinationsEuclidean95", "=", 
   RowBox[{"Dataset", "[", 
    RowBox[{"generateCombinationsDataset", "[", 
     RowBox[{"aLLCOMBeuclideanListOfClutersCombinationsResult95", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.912945207447652*^9, 3.912945208201603*^9}, {
   3.913007076086132*^9, 3.9130070790608883`*^9}, {3.913007151508969*^9, 
   3.913007152283636*^9}, 3.9130072725740643`*^9, {3.9130115330340595`*^9, 
   3.9130115765700893`*^9}, {3.913011666181028*^9, 3.913011762461102*^9}, {
   3.9130121572622375`*^9, 3.913012177700759*^9}, {3.9130122145215664`*^9, 
   3.913012218208539*^9}, {3.9130196433538256`*^9, 3.913019676240344*^9}, {
   3.913021050348611*^9, 3.913021053419903*^9}, {3.913111167560975*^9, 
   3.913111168014092*^9}, 3.913132920967244*^9, 3.9131386034030514`*^9, {
   3.913301844280699*^9, 3.913301897270574*^9}, {3.913302804631472*^9, 
   3.9133028052080016`*^9}, {3.913302933312106*^9, 3.913302933708305*^9}, {
   3.913309995148217*^9, 3.913310006681472*^9}, {3.913646907889025*^9, 
   3.9136469087385893`*^9}, {3.9136936662323437`*^9, 3.9136936665297403`*^9}},
 
 CellLabel->
  "In[174]:=",ExpressionUUID->"40be2a4f-3ed6-48f2-8233-ee29ad27d89a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Export Dataset:", "Chapter",
 CellChangeTimes->{{3.913026220068965*^9, 3.913026225609311*^9}, {
  3.91302632181822*^9, 3.913026323882101*^9}, {3.913030536410658*^9, 
  3.913030537752742*^9}, {3.9131116044851847`*^9, 3.913111619086955*^9}, {
  3.9249558294204693`*^9, 
  3.924955829916279*^9}},ExpressionUUID->"7a3988d9-f017-4b29-9055-\
41a806f582e3"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<uniform_aLLCOMBdataSetCombinationsEuclidean95_nSampling_\>\"", "<>", 
    RowBox[{"ToString", "[", "samplingsToRun", "]"}], "<>", "\"\<.xlsx\>\""}],
    ",", " ", "uniformALLCOMBdataSetCombinationsEuclidean95"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9130259022239933`*^9, 3.913025962293153*^9}, 
   3.913026212518359*^9, {3.913113073585907*^9, 3.913113077452694*^9}, {
   3.913115220137586*^9, 3.9131152257531223`*^9}, {3.913299899286727*^9, 
   3.9132999054474688`*^9}, {3.9133019097860427`*^9, 
   3.9133019320276175`*^9}, {3.9133023554608316`*^9, 
   3.9133023734362445`*^9}, {3.9133045925774903`*^9, 
   3.9133046032127953`*^9}, {3.9133100206076684`*^9, 3.913310031680015*^9}, {
   3.9134466541320367`*^9, 3.9134466619837055`*^9}, {3.9135579026405735`*^9, 
   3.913557907696856*^9}, {3.913628349179145*^9, 3.913628367706627*^9}, {
   3.9136469147536364`*^9, 3.9136469156503134`*^9}, {3.913693122769617*^9, 
   3.913693125649351*^9}, 3.913693688884534*^9},
 CellLabel->
  "In[175]:=",ExpressionUUID->"3017da6e-a741-42b3-acd1-406043c6e6f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Import Datasets :", "Chapter",
 CellChangeTimes->{{3.9135514207791433`*^9, 3.9135514364441357`*^9}, {
   3.913555374718976*^9, 3.913555377308787*^9}, 3.9135590610793037`*^9, {
   3.924955831105461*^9, 
   3.9249558316528125`*^9}},ExpressionUUID->"fbf02226-43a8-4685-8a42-\
5fde9e95a5d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uniformALLCOMBdataSetCombinationsEuclidean95Imported", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{
     "\"\<uniform_aLLCOMBdataSetCombinationsEuclidean95_nSampling_\>\"", "<>", 
      RowBox[{"ToString", "[", "samplingsToRun", "]"}], "<>", 
      "\"\<.xlsx\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Dataset\>\"", ",", "1"}], "}"}], ",", 
     RowBox[{"\"\<HeaderLines\>\"", "->", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "uniformALLCOMBdataSetCombinationsEuclidean95Imported", " ", "=", " ", 
   RowBox[{"uniformALLCOMBdataSetCombinationsEuclidean95Imported", "[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Combination\>\"", "->", "ToExpression"}], ",", 
       RowBox[{"\"\<ParIndex\>\"", "->", "Round"}], ",", " ", 
       RowBox[{"\"\<ClusterFilled\>\"", "->", "ToExpression"}]}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9135514378535957`*^9, 3.9135514388132505`*^9}, {
   3.9135515481565895`*^9, 3.913551567718912*^9}, 3.9135516107434654`*^9, 
   3.913551665739202*^9, {3.913552163646327*^9, 3.9135521730613647`*^9}, {
   3.9135529566842794`*^9, 3.9135529592359357`*^9}, {3.913554578038339*^9, 
   3.913554599097438*^9}, 3.9135546417006826`*^9, {3.913554717805504*^9, 
   3.9135547811299696`*^9}, {3.913557928287691*^9, 3.913558023732362*^9}, {
   3.9135581026288376`*^9, 3.9135581052913795`*^9}, 3.9135582125802326`*^9, {
   3.913628450634841*^9, 3.9136284914073296`*^9}, {3.913637507350194*^9, 
   3.913637528824236*^9}, {3.9136469248993797`*^9, 3.9136469272648835`*^9}, {
   3.913693116480094*^9, 3.9136931187814665`*^9}, {3.9136937549890223`*^9, 
   3.913693767462595*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"a947e0f5-17b9-49a4-b835-bdc16c925cb6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
   "uniformALLCOMBdataSetCombinationsEuclidean95", "=", " ", 
    "uniformALLCOMBdataSetCombinationsEuclidean95Imported"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.913628496947154*^9, 3.913628557384691*^9}, {
  3.9136469300423517`*^9, 3.9136469307989235`*^9}, {3.913693779093973*^9, 
  3.9136937840514574`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"7a8fd361-6283-4e44-a770-77d2f19e3b28"]
}, Closed]],

Cell[CellGroupData[{

Cell["Clusters frequency:", "Chapter",
 CellChangeTimes->{{3.9130262432889605`*^9, 3.9130262789167676`*^9}, {
  3.9130267867479887`*^9, 3.9130267891787715`*^9}, {3.913027318600605*^9, 
  3.9130273511499825`*^9}, {3.9130302518501368`*^9, 3.913030252390017*^9}, {
  3.913030540612295*^9, 3.9130305654765177`*^9}, {3.9131115280079722`*^9, 
  3.9131115402164116`*^9}, {3.913111608637454*^9, 3.9131116159717655`*^9}, {
  3.9133058021358013`*^9, 3.913305812282806*^9}, {3.924955836226181*^9, 
  3.924955838849693*^9}},ExpressionUUID->"037978fd-6999-4c84-b606-\
0269542e858c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uniformALLcombinationsStatisticsEuclidean95", "=", " ", 
   RowBox[{"returnClustersCombinationsStatistics", "[", 
    RowBox[{
    "uniformALLCOMBdataSetCombinationsEuclidean95", ",", " ", "False"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9130211622599506`*^9, 3.913021162278117*^9}, {
   3.913021201900738*^9, 3.9130212318734384`*^9}, {3.9130214191857967`*^9, 
   3.913021536870433*^9}, {3.9130217214504623`*^9, 3.913021762059764*^9}, {
   3.913021833701209*^9, 3.9130218690949497`*^9}, {3.9130219550638113`*^9, 
   3.9130219577987213`*^9}, 3.9130221377339687`*^9, {3.91302217215467*^9, 
   3.913022172433539*^9}, {3.9130223066775303`*^9, 3.9130223330011225`*^9}, {
   3.913022367922946*^9, 3.9130223792902255`*^9}, {3.9130224181209197`*^9, 
   3.913022448689354*^9}, {3.913022544175537*^9, 3.91302257434938*^9}, {
   3.913022623177806*^9, 3.9130226498258853`*^9}, {3.913022752129284*^9, 
   3.913022810995989*^9}, {3.913022915707344*^9, 3.913022939081813*^9}, {
   3.9130230031873465`*^9, 3.9130230263340664`*^9}, {3.913023064297579*^9, 
   3.913023132698499*^9}, {3.9130245527030215`*^9, 3.9130245573134813`*^9}, {
   3.9130247794641933`*^9, 3.9130247972113543`*^9}, {3.913024841465122*^9, 
   3.913024890037412*^9}, {3.913025049633424*^9, 3.9130250665638423`*^9}, 
   3.913026262273732*^9, {3.9131112183306503`*^9, 3.913111219127531*^9}, {
   3.913111252902014*^9, 3.9131112557204075`*^9}, {3.9133024604901485`*^9, 
   3.913302486463955*^9}, {3.9133025205154424`*^9, 3.913302666788213*^9}, {
   3.913302770522726*^9, 3.913302797833209*^9}, {3.913310040275882*^9, 
   3.913310044565173*^9}, {3.91344621612429*^9, 3.913446266306902*^9}, {
   3.9134463686552973`*^9, 3.913446369046005*^9}, {3.913446631810856*^9, 
   3.913446638814938*^9}, {3.9134664143028536`*^9, 3.913466437294261*^9}, {
   3.9134664703439856`*^9, 3.9134664818765893`*^9}, {3.913646945946802*^9, 
   3.9136469467320523`*^9}, {3.913693795412568*^9, 3.913693815691818*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"292c6006-5b9e-4562-b84e-8103b66e6939"]
}, Closed]],

Cell[CellGroupData[{

Cell["BarChart:", "Chapter",
 CellChangeTimes->{{3.913445291537715*^9, 3.913445298824132*^9}, 
   3.9134464801016912`*^9},ExpressionUUID->"eb0d1708-6c51-488c-869d-\
e302222ea081"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CreateBarChartsGrid", "[", 
  RowBox[{"uniformALLcombinationsStatisticsEuclidean95", "[", 
   RowBox[{"[", "index", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"CreateBarChartsGrid", "[", "#", "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"combinationsStatisticsEuclidean95One", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"combinationsStatisticsEuclidean68One", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"combinationsStatisticsManhattan95One", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"combinationsStatisticsManhattan68One", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], "}"}], ",", 
     RowBox[{"Frame", "->", "False"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9134440778620906`*^9, 3.9134441659585485`*^9}, {
   3.913444510752492*^9, 3.913444511205617*^9}, {3.9134445769439983`*^9, 
   3.9134445845499754`*^9}, {3.91344479679699*^9, 3.9134448017477365`*^9}, {
   3.9134448357867413`*^9, 3.91344495082681*^9}, {3.9134450386338015`*^9, 
   3.913445041900323*^9}, {3.9134464814298735`*^9, 3.9134464964330254`*^9}, 
   3.91344658785428*^9, {3.913472143603236*^9, 3.9134721510170116`*^9}, {
   3.9134721948516493`*^9, 3.913472195390217*^9}, {3.9136938307484393`*^9, 
   3.9136938311487465`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"03f19638-854b-4086-960f-25a662caac36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CreateBarChartsGrid", "[", 
  RowBox[{
   RowBox[{"uniformALLcombinationsStatisticsEuclidean95", "[", 
    RowBox[{"[", "index", "]"}], "]"}], ",", "True"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9134721680014744`*^9, 3.9134721709514103`*^9}, {
  3.9134722072274084`*^9, 3.913472207820735*^9}, {3.9134733894265785`*^9, 
  3.913473392400719*^9}, {3.91369384195209*^9, 3.9136938422424393`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"ee602ee9-8359-43d0-957d-47e93fdae559"]
}, Closed]],

Cell[CellGroupData[{

Cell["Final totals bar chart:", "Chapter",
 CellChangeTimes->{{3.9136152472954164`*^9, 
  3.913615256427146*^9}},ExpressionUUID->"038732e7-6d17-483f-b78a-\
be5af47f8deb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"index", "=", "3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eucl95", "=", 
   RowBox[{"uniformALLcombinationsStatisticsEuclidean95", "[", 
    RowBox[{"[", "index", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"joinedData", "=", 
    RowBox[{"{", "eucl95", "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stringList", "=", 
    RowBox[{"{", "\"\<Euclidean 95%\>\"", "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"plotFinalBarCharts", "[", 
  RowBox[{"joinedData", ",", "stringList", ",", "True"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.913568610421042*^9, 3.9135686164193583`*^9}, {
   3.9135689414023447`*^9, 3.9135689489953213`*^9}, {3.913569253062726*^9, 
   3.9135693190702276`*^9}, {3.913569386130526*^9, 3.9135694267035255`*^9}, {
   3.9135695058219824`*^9, 3.9135695719689903`*^9}, {3.9135696320631003`*^9, 
   3.9135696326575203`*^9}, {3.9135697572731857`*^9, 
   3.9135698688490458`*^9}, {3.9135700050944614`*^9, 3.913570006052429*^9}, {
   3.9135700689952064`*^9, 3.913570080315501*^9}, {3.9135701724592185`*^9, 
   3.913570217739686*^9}, {3.9135702947575006`*^9, 3.9135703092730274`*^9}, {
   3.9135703402027884`*^9, 3.9135703854000216`*^9}, {3.9135704883912153`*^9, 
   3.9135706509652195`*^9}, 3.9135706874510975`*^9, {3.91357073155933*^9, 
   3.9135708364516354`*^9}, {3.9135709419423428`*^9, 
   3.9135710935383425`*^9}, {3.913571136117234*^9, 3.9135711528970995`*^9}, {
   3.913572046472575*^9, 3.913572172563069*^9}, {3.9135722090310636`*^9, 
   3.913572243110546*^9}, {3.9135723434143467`*^9, 3.913572408720065*^9}, {
   3.9135724390022154`*^9, 3.913572513802946*^9}, {3.9135726497938356`*^9, 
   3.9135728027714205`*^9}, {3.913572840727084*^9, 3.9135728518843904`*^9}, {
   3.9135728890887237`*^9, 3.9135728946647635`*^9}, {3.913572965245923*^9, 
   3.913572993360792*^9}, {3.9135730744897895`*^9, 3.9135731318777313`*^9}, {
   3.9135731765586143`*^9, 3.9135732105306635`*^9}, {3.9135732764245667`*^9, 
   3.913573322603728*^9}, 3.913573467692922*^9, {3.9135735020968175`*^9, 
   3.913573521022752*^9}, {3.9135736298509808`*^9, 3.913573787512083*^9}, {
   3.9135738604496512`*^9, 3.9135739268984537`*^9}, {3.913574307455318*^9, 
   3.9135743084390497`*^9}, 3.91361485899165*^9, {3.9136149252490554`*^9, 
   3.9136150328558226`*^9}, {3.913615080398836*^9, 3.913615138831606*^9}, {
   3.913615212035259*^9, 3.9136152324575353`*^9}, {3.9136469831884265`*^9, 
   3.9136469908152437`*^9}, {3.913693872827803*^9, 3.913693895059313*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"de5646e0-e126-4d06-bf36-70a9037e09ae"]
}, Closed]]
}, Closed]]
},
Evaluator->"Aux_1",
WindowSize->{1440., 747.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
DockedCells->{},
PrintingCopies->1,
PrintingPageRange->{1, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Landscape",
"PaperSize"->{841.92, 595.3199999999999},
"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->0},
TaggingRules-><|"TryRealOnly" -> False|>,
CellContext->Notebook,
Magnification:>0.75 Inherited,
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (August 22, 2022)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "13.1 for Microsoft Windows (64-bit) (August 22, 2022)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"2603ed5e-3c05-40ad-b480-657ed9ad7543"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 347, 6, 50, "Input",ExpressionUUID->"741d47af-faba-4e4e-9f26-f811c9fc034a"],
Cell[CellGroupData[{
Cell[930, 30, 259, 4, 74, "Title",ExpressionUUID->"2e9c9d70-cd70-40ae-862b-09a1324357b8"],
Cell[1192, 36, 396, 7, 50, "Input",ExpressionUUID->"6e91dcb6-2790-4f6b-b909-bd1cb18d439b"],
Cell[1591, 45, 2165, 49, 64, "Input",ExpressionUUID->"842cbce7-ad79-4213-9219-e830536f9f53"]
}, Closed]],
Cell[CellGroupData[{
Cell[3793, 99, 431, 8, 55, "Title",ExpressionUUID->"9c9f84d0-2aa9-45c3-9f59-35b5194676c9"],
Cell[4227, 109, 3380, 82, 237, "Input",ExpressionUUID->"b94f167d-aab5-4325-afa0-1ea47acc7489"]
}, Closed]],
Cell[CellGroupData[{
Cell[7644, 196, 838, 12, 55, "Title",ExpressionUUID->"5fd7da52-6e4e-4541-9f7f-e6f5f6235619"],
Cell[CellGroupData[{
Cell[8507, 212, 315, 6, 51, "Chapter",ExpressionUUID->"232fe3fe-9ce3-405c-845e-ca809a4b34a3"],
Cell[8825, 220, 10548, 239, 452, "Input",ExpressionUUID->"86f91b6d-bdd4-4987-9180-f3107a990681"]
}, Closed]],
Cell[CellGroupData[{
Cell[19410, 464, 223, 4, 44, "Chapter",ExpressionUUID->"f1a6225e-dd51-4d85-8a31-f2f3ea0233b9"],
Cell[19636, 470, 24099, 589, 1413, "Input",ExpressionUUID->"bafd36b5-4ba8-4d26-8d18-3225da2388b5"]
}, Closed]],
Cell[CellGroupData[{
Cell[43772, 1064, 294, 4, 44, "Chapter",ExpressionUUID->"3981df79-b8a0-4a5d-bef7-89c4f56cdf65"],
Cell[44069, 1070, 14333, 323, 639, "Input",ExpressionUUID->"bce298ad-04da-4ed1-b0ac-1123819b9f29"]
}, Closed]],
Cell[CellGroupData[{
Cell[58439, 1398, 309, 7, 44, "Chapter",ExpressionUUID->"b03912fc-88db-4ec3-a4b5-0244aa2ee19a"],
Cell[58751, 1407, 23090, 502, 1196, "Input",ExpressionUUID->"6d284da6-0d3c-4fb6-8bc3-eba903ec1a24"]
}, Closed]],
Cell[CellGroupData[{
Cell[81878, 1914, 332, 5, 44, "Chapter",ExpressionUUID->"0b0fef12-336f-44f2-9a6d-c73f0ad488ac"],
Cell[82213, 1921, 4697, 107, 294, "Input",ExpressionUUID->"3ec0a3a1-f5c2-4f21-9cda-f0897ca2c43d"]
}, Closed]],
Cell[CellGroupData[{
Cell[86947, 2033, 317, 5, 44, "Chapter",ExpressionUUID->"f106c97f-a3be-4127-90de-4ae6e11e4301"],
Cell[87267, 2040, 16388, 385, 855, "Input",ExpressionUUID->"50007df6-40c0-45e1-b7b4-a0eb4822d9af"]
}, Closed]],
Cell[CellGroupData[{
Cell[103692, 2430, 242, 5, 44, "Chapter",ExpressionUUID->"ab60a066-36b1-42e4-91d1-4311dcb254a1"],
Cell[103937, 2437, 4451, 96, 322, "Input",ExpressionUUID->"461517f9-14bd-4d6f-a01e-9912cfe0e328"]
}, Closed]],
Cell[CellGroupData[{
Cell[108425, 2538, 452, 6, 44, "Chapter",ExpressionUUID->"e1711504-8305-4760-8513-929ab11da781"],
Cell[108880, 2546, 24754, 591, 1297, "Input",ExpressionUUID->"a18e9766-4dff-40d6-a8bb-5019da88809b"]
}, Closed]],
Cell[CellGroupData[{
Cell[133671, 3142, 354, 7, 44, "Chapter",ExpressionUUID->"2fd5e788-a3d7-4c1b-ad32-a7eb65471e90"],
Cell[134028, 3151, 21057, 488, 1180, "Input",ExpressionUUID->"ab2f9eb6-12af-423d-9506-44f51af72de0"]
}, Closed]],
Cell[CellGroupData[{
Cell[155122, 3644, 377, 7, 44, "Chapter",ExpressionUUID->"5c322aad-f009-4a66-9b98-4d4f1dc07286"],
Cell[155502, 3653, 13904, 327, 868, "Input",ExpressionUUID->"cb33c4b4-8ed4-4025-95b5-ad476313555c"]
}, Closed]],
Cell[CellGroupData[{
Cell[169443, 3985, 248, 5, 44, "Chapter",ExpressionUUID->"f0d2630d-5f10-4645-a1aa-60d07465a467"],
Cell[169694, 3992, 10059, 223, 638, "Input",ExpressionUUID->"5c64f331-1e48-4490-ba14-0933f82f5b25"]
}, Closed]],
Cell[CellGroupData[{
Cell[179790, 4220, 371, 6, 44, "Chapter",ExpressionUUID->"61e77d93-beab-4951-a373-2ff8314dd0eb"],
Cell[180164, 4228, 18666, 388, 1125, "Input",ExpressionUUID->"06a17e42-529d-41fb-83aa-9bfb473a13c9"]
}, Closed]],
Cell[CellGroupData[{
Cell[198867, 4621, 356, 5, 44, "Chapter",ExpressionUUID->"2fe57cbd-1cb2-4067-9adb-6b3e2dedd19b"],
Cell[199226, 4628, 21847, 471, 1102, "Input",ExpressionUUID->"6ad07f1b-2e5e-4011-ba04-e2eb20603c37"]
}, Closed]],
Cell[CellGroupData[{
Cell[221110, 5104, 329, 5, 44, "Chapter",ExpressionUUID->"17cc5ecc-5e5f-45fa-a29b-4be5a726d4ba"],
Cell[221442, 5111, 25980, 601, 1256, "Input",ExpressionUUID->"c2eec048-8b6f-4def-b123-8b2c6dd2a954"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[247471, 5718, 733, 11, 55, "Title",ExpressionUUID->"4f2d8d24-b3fc-4cf6-8db5-a6ec296c26cd"],
Cell[248207, 5731, 2169, 54, 136, "Input",ExpressionUUID->"2200efca-a545-468b-ac35-191f77351649"],
Cell[CellGroupData[{
Cell[250401, 5789, 387, 7, 51, "Chapter",ExpressionUUID->"cb12f38c-ebf2-4f77-a863-3eecf58037b8"],
Cell[250791, 5798, 5218, 121, 527, "Input",ExpressionUUID->"4538c991-eddc-41e7-b1aa-0b27e5bb2e45"]
}, Closed]],
Cell[CellGroupData[{
Cell[256046, 5924, 505, 7, 44, "Chapter",ExpressionUUID->"6c52182c-e4c2-460f-a80a-108252b47417"],
Cell[256554, 5933, 275, 8, 4, "Text",ExpressionUUID->"65c55a39-9fc6-4b85-ac24-2d487a13a81d"],
Cell[256832, 5943, 2305, 52, 79, "Input",ExpressionUUID->"be0d2e2b-fbe5-428d-8c83-579afae6058f"]
}, Closed]],
Cell[CellGroupData[{
Cell[259174, 6000, 420, 6, 44, "Chapter",ExpressionUUID->"09cfeeff-3062-4b16-bf93-6b22fa922616"],
Cell[259597, 6008, 3651, 76, 179, "Input",ExpressionUUID->"1b8c263a-49dd-428e-8355-c0d4ee757cd8"],
Cell[263251, 6086, 275, 8, 4, "Text",ExpressionUUID->"41a829b6-cdcb-4bc6-a84c-ac93a4b7ceea"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[263575, 6100, 2177, 32, 55, "Title",ExpressionUUID->"9bbc45dc-4e97-4c19-a08a-d85976e2f2d5"],
Cell[265755, 6134, 275, 8, 4, "Text",ExpressionUUID->"35eefde8-bd9d-4cfb-8a03-3b1d18b0b1b6"],
Cell[CellGroupData[{
Cell[266055, 6146, 202, 4, 51, "Chapter",ExpressionUUID->"bfbfaee8-a322-4898-addd-c3c5cfe2a111"],
Cell[266260, 6152, 275, 8, 4, "Text",ExpressionUUID->"1e74293c-8ee8-46d3-84eb-bc561a498c59"],
Cell[266538, 6162, 1972, 62, 64, "Input",ExpressionUUID->"ce1fcd7f-4181-4045-a00c-2026355c5000"],
Cell[268513, 6226, 275, 8, 4, "Text",ExpressionUUID->"d9ca6f67-26f1-4c51-ace3-9e1615f519c8"],
Cell[268791, 6236, 4545, 92, 250, "Input",ExpressionUUID->"4608ef18-8005-44ef-9b8b-f4d5a08d34b9"],
Cell[273339, 6330, 275, 8, 4, "Text",ExpressionUUID->"7a1cc7de-39ea-43b0-ae68-2277f69a32ce"],
Cell[273617, 6340, 1289, 24, 64, "Input",ExpressionUUID->"67c6fe28-1412-49c3-a37e-c1bf3203c1e4"],
Cell[274909, 6366, 275, 8, 4, "Text",ExpressionUUID->"1d96dca8-6e7c-4207-968f-fe04b1717fc2"]
}, Closed]],
Cell[CellGroupData[{
Cell[275221, 6379, 616, 9, 44, "Chapter",ExpressionUUID->"45f1825d-41a5-43f1-b123-5efb24874b7f"],
Cell[275840, 6390, 1744, 29, 50, "Input",ExpressionUUID->"4e8e8fc6-9966-461c-be29-2614b5ea51a6"]
}, Closed]],
Cell[CellGroupData[{
Cell[277621, 6424, 356, 6, 44, "Chapter",ExpressionUUID->"9593784d-8533-4f57-bc3e-3f4e38d6c0f0"],
Cell[277980, 6432, 1524, 26, 51, "Input",ExpressionUUID->"da4ae013-b9e5-4b39-a02f-18c45901ef6c"]
}, Closed]],
Cell[CellGroupData[{
Cell[279541, 6463, 290, 5, 44, "Chapter",ExpressionUUID->"cbc4e5f4-ba20-40a7-8af5-417e85f65128"],
Cell[279834, 6470, 2723, 54, 80, "Input",ExpressionUUID->"59919df2-7179-4fdf-a7c0-3b3f975d3834"],
Cell[282560, 6526, 275, 8, 4, "Text",ExpressionUUID->"c6755539-ff36-4fa3-9055-36b66626ba5a"],
Cell[282838, 6536, 669, 15, 50, "Input",ExpressionUUID->"6692b9e8-04ed-42b4-91b7-7792350be567"]
}, Closed]],
Cell[CellGroupData[{
Cell[283544, 6556, 573, 8, 44, "Chapter",ExpressionUUID->"89099264-fd37-45dc-8a49-6085ee08e9fb"],
Cell[284120, 6566, 2446, 37, 50, "Input",ExpressionUUID->"b8d36324-1af0-4e1c-a1d7-495eaa35f74b"]
}, Closed]],
Cell[CellGroupData[{
Cell[286603, 6608, 179, 3, 44, "Chapter",ExpressionUUID->"c7b2d7d0-ad51-4160-9258-28fcea68850a"],
Cell[286785, 6613, 1632, 34, 50, "Input",ExpressionUUID->"d1a182e3-959a-4cfd-bed7-7d1cc75d7230"],
Cell[288420, 6649, 546, 12, 50, "Input",ExpressionUUID->"c2547657-2028-4a30-9ef1-1a88c64017e9"]
}, Closed]],
Cell[CellGroupData[{
Cell[289003, 6666, 223, 4, 44, "Chapter",ExpressionUUID->"f5d388a5-6034-42c0-88ea-302df455d5af"],
Cell[CellGroupData[{
Cell[289251, 6674, 243, 4, 50, "Section",ExpressionUUID->"63526fe6-79e4-4d1c-aa4e-98b3ab92eb7f"],
Cell[289497, 6680, 1360, 29, 107, "Input",ExpressionUUID->"3ec0b29c-cb26-4794-8726-3fb8f51ed81c"],
Cell[290860, 6711, 275, 8, 4, "Text",ExpressionUUID->"d5c10137-ae46-4019-afc2-87b17918c547"],
Cell[291138, 6721, 1366, 26, 64, "Input",ExpressionUUID->"d31c1315-c376-4e51-a4e9-8213be638fce"],
Cell[292507, 6749, 1055, 20, 50, "Input",ExpressionUUID->"fe1ea6df-d321-40c9-9334-a8aa3e484e22"]
}, Closed]],
Cell[CellGroupData[{
Cell[293599, 6774, 173, 3, 40, "Section",ExpressionUUID->"41ade62c-89b1-46a2-8508-0a2c073994c7"],
Cell[293775, 6779, 1232, 28, 122, "Input",ExpressionUUID->"885a869c-5423-4604-9430-bdc5da44d531"],
Cell[295010, 6809, 275, 8, 4, "Text",ExpressionUUID->"2c273f17-e74c-4a6c-a112-6288a329a15f"],
Cell[295288, 6819, 982, 22, 64, "Input",ExpressionUUID->"841fe5d2-47d4-4855-a8a7-894333ac9106"],
Cell[296273, 6843, 885, 17, 50, "Input",ExpressionUUID->"b9c62656-00fe-4101-a5a6-19309f421611"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[297207, 6866, 170, 3, 44, "Chapter",ExpressionUUID->"91ef3560-e175-4170-a688-3956948aaa86"],
Cell[297380, 6871, 3106, 57, 150, "Input",ExpressionUUID->"08f0eed2-89d8-4592-bb3f-a1282984ac61"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[300535, 6934, 1630, 23, 55, "Title",ExpressionUUID->"4a49397b-dfaa-4fab-a799-50485f45264a"],
Cell[302168, 6959, 275, 8, 4, "Text",ExpressionUUID->"8c924cbb-7295-481c-a98d-73ed066a6f6c"],
Cell[CellGroupData[{
Cell[302468, 6971, 246, 4, 51, "Chapter",ExpressionUUID->"e34d1864-c803-4fa2-83b6-09ec1c25c247"],
Cell[302717, 6977, 275, 8, 4, "Text",ExpressionUUID->"0a24b4b5-0334-47c3-aa8a-0e817ef5fdb9"],
Cell[302995, 6987, 1891, 61, 64, "Input",ExpressionUUID->"475cc5df-4c8c-4221-bfe5-b06fc8ac7b11"],
Cell[304889, 7050, 275, 8, 4, "Text",ExpressionUUID->"16c0225e-9d22-4588-bd7c-3cf033667d0d"],
Cell[305167, 7060, 4425, 91, 250, "Input",ExpressionUUID->"01ff6cfd-05ba-4872-b97b-30ff5d6ef895"],
Cell[309595, 7153, 275, 8, 4, "Text",ExpressionUUID->"8afbaca8-fbb5-4471-b09a-aeef69e14970"]
}, Closed]],
Cell[CellGroupData[{
Cell[309907, 7166, 614, 9, 44, "Chapter",ExpressionUUID->"d7913a20-a875-4475-adac-6692bfdfdbad"],
Cell[310524, 7177, 1282, 21, 21, "Input",ExpressionUUID->"40be2a4f-3ed6-48f2-8233-ee29ad27d89a"]
}, Closed]],
Cell[CellGroupData[{
Cell[311843, 7203, 356, 6, 44, "Chapter",ExpressionUUID->"7a3988d9-f017-4b29-9055-41a806f582e3"],
Cell[312202, 7211, 1117, 20, 22, "Input",ExpressionUUID->"3017da6e-a741-42b3-acd1-406043c6e6f9"]
}, Closed]],
Cell[CellGroupData[{
Cell[313356, 7236, 293, 5, 44, "Chapter",ExpressionUUID->"fbf02226-43a8-4685-8a42-5fde9e95a5d2"],
Cell[313652, 7243, 1823, 36, 37, "Input",ExpressionUUID->"a947e0f5-17b9-49a4-b835-bdc16c925cb6"],
Cell[315478, 7281, 518, 12, 64, "Input",ExpressionUUID->"7a8fd361-6283-4e44-a770-77d2f19e3b28"]
}, Closed]],
Cell[CellGroupData[{
Cell[316033, 7298, 569, 8, 44, "Chapter",ExpressionUUID->"037978fd-6999-4c84-b606-0269542e858c"],
Cell[316605, 7308, 2073, 31, 21, "Input",ExpressionUUID->"292c6006-5b9e-4562-b84e-8103b66e6939"]
}, Closed]],
Cell[CellGroupData[{
Cell[318715, 7344, 179, 3, 44, "Chapter",ExpressionUUID->"eb0d1708-6c51-488c-869d-e302222ea081"],
Cell[318897, 7349, 1693, 35, 50, "Input",ExpressionUUID->"03f19638-854b-4086-960f-25a662caac36"],
Cell[320593, 7386, 600, 12, 50, "Input",ExpressionUUID->"ee602ee9-8359-43d0-957d-47e93fdae559"]
}, Closed]],
Cell[CellGroupData[{
Cell[321230, 7403, 170, 3, 44, "Chapter",ExpressionUUID->"038732e7-6d17-483f-b78a-be5af47f8deb"],
Cell[321403, 7408, 2672, 46, 122, "Input",ExpressionUUID->"de5646e0-e126-4d06-bf36-70a9037e09ae"]
}, Closed]]
}, Closed]]
}
]
*)

